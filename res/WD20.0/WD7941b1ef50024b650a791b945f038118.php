<?php
//20.0.56.0 Architecture.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__FMK/Exception.php')) { define('__INC__FMK/Exception.php',true); include_once(WB_INCLUDE_PATH.'WDad4db5db8c5c5d46f4e2f107ea6466df.php'); } register_shutdown_function("Callback_FinExecution"); if (!defined('__INC__FMK/Contexte.php')) { define('__INC__FMK/Contexte.php',true); include_once(WB_INCLUDE_PATH.'WDb8ed6cc9e4e026a5ab69ef35262a90ab.php'); } if (!defined('__INC__FMK/PostGet.php')) { define('__INC__FMK/PostGet.php',true); include_once(WB_INCLUDE_PATH.'WDfe3218b8c0e7e274335f3617fe996545.php'); } if (!defined('__INC__FMK/Dessin/Couleur.php')) { define('__INC__FMK/Dessin/Couleur.php',true); include_once(WB_INCLUDE_PATH.'WD2521e084cbaf10ef8d5f4ede4dc6baa2.php'); } if (!defined('__INC__FMK/Chaine.php')) { define('__INC__FMK/Chaine.php',true); include_once(WB_INCLUDE_PATH.'WD55acb2e708e26f23cb8956cd93e98123.php'); } if (!defined('__INC__FMK/Dependance.php')) { define('__INC__FMK/Dependance.php',true); include_once(WB_INCLUDE_PATH.'WDb98029e1a3f05e7ed504ba0a18a9dea8.php'); } if (!defined('__INC__FMK/Langue.php')) { define('__INC__FMK/Langue.php',true); include_once(WB_INCLUDE_PATH.'WD4d84d6208fe7c636ffccdb9635ac4cf0.php'); } if (!defined('__INC__FMK/Langue/Alphabet.php')) { define('__INC__FMK/Langue/Alphabet.php',true); include_once(WB_INCLUDE_PATH.'WDcd0b26b72175a8bae40e1d32deffe704.php'); } if (!defined('__INC__FMK/Environnement.php')) { define('__INC__FMK/Environnement.php',true); include_once(WB_INCLUDE_PATH.'WD62c1fcbeb97cd284448bd7a6ec627839.php'); } if (!defined('__INC__FMK/Exception/Pile.php')) { define('__INC__FMK/Exception/Pile.php',true); include_once(WB_INCLUDE_PATH.'WDc8aea829013863fbce9e58dbd520d694.php'); } if (!defined('__INC__FMK/Dessin/Couleur.php')) { define('__INC__FMK/Dessin/Couleur.php',true); include_once(WB_INCLUDE_PATH.'WD2521e084cbaf10ef8d5f4ede4dc6baa2.php'); } if (!defined('__INC__TYPE/Modele.php')) { define('__INC__TYPE/Modele.php',true); include_once(WB_INCLUDE_PATH.'WD6ee9539c0ad66df976b95a68703645fb.php'); } define('ValeurRetourErreur' , RetourErreur_Entier,true); define("DEVISE_EURO",utf8_chr(128)); define("TYPE_IMAGE_STATIQUE" ,0); define("TYPE_IMAGE_DYNAMIQUE" ,1); define("TYPE_IMAGE_BDD_CHEMIN" ,2); define("TYPE_IMAGE_BDD_MEMO" ,3); define("TYPE_IMAGE_GENEREE" ,4); define("TYPE_CHAMP_LISTE" ,7); define("TYPE_CHAMP_COMBO" ,10002); define("TYPE_CHAMP_TABLE" ,9); define("TYPE_CHAMP_ZR" ,11); define("TYPE_CHAMP_ZRLINEAIRE" ,77); define("ETAT_CHAMP_ACTIF" ,0); define("ETAT_CHAMP_INACTIF" ,1); define("ETAT_CHAMP_GRISE" ,4); define("ETAT_CHAMP_AFF_SANS_SEL" ,5); define('CTE_INVISIBLE', 2); define('sSEPLIGNEMASKTITREJOURAGD', '|'); define("TO_TOTAL", 1); define("TO_COLONNE", 2); define("TO_VISIBLE", 3); define("TO_AFFICHEE", 4); define("TA_INIT", "Reset"); define("TA_DEBUT", "I"); define("TA_COURANTPREMIER", "*"); define("TA_COURANTBANDEAU", "P"); define("TA_REEXECUTEREQUETE", "Reexecute"); define("nLENABBREGE", 3, true); define("MASQUE_NUMERIQUE" ,"999 999 999 999,99"); define('szMASKNUM_TAILLEDISQUE','DiskSize'); define('ntypOPTIONMENU', 40001); define("MASQUE_TAILLE" ,"999999999999,99"); define("tailleO" ,1); define("tailleKo" ,2); define("tailleMo" ,3); define("tailleGo" ,4); define("tailleTo" ,5); define("_WW_SEPMILLIER_", " "); define("_WW_SEPDECIMAL_", ","); define("SepPageObjet",".",true); define("SepObjetTraitement",".",true); define('trCreation' ,16); define('trDessusTout' ,4096); define('trDesactive' ,2); define('trFenetre' ,8); define('trFichier' ,4); define('dwCouleurSysteme',0xFFFFFFFE); define('dwCouleurDefaut',0xFFFFFFFD); define('dwCouleurNoir',0); define('dwCouleurLienNavigateur',13369344); define('szMASKDATEHEURE_SYTEME',"UseSystemMask"); define('szMASKDATEHEURE_DUREEERELATIVE',"UseDateRelativeDurationMask"); define('Aucune' ,0); define('CodeClic' ,1); define('AffichePage' ,2); define('ActualisePage' ,3); define('VersAncre' ,4); define('VersURL' ,5); define('CodeClicTable' ,6); define('CodePrecTable' ,7); define('CodeSuivTable' ,8); define('CodeClicBouton' ,9); define('LancerLeSite' ,10); define('SemiDyn_PremierPage' ,11); define('SemiDyn_DernierePage' ,12); define('SemiDyn_PageSuivante' ,13); define('SemiDyn_PagePrecedente' ,14); define('UtiliserBouton' ,15); define('SubmitVersURL_Post' ,16); define('SubmitVersURL_Get' ,17); define("trtProcedure" , 10,true); define("trtInit" , 14,true); define("trtClic" , 18,true); define('TRT_SelectionJour',120); define('TRT_AffichageMois',118); define('TRT_ChangementMois',149); define('TRT_ChaqueAffichagePagePHP',151); define('TRT_1erAffichagePage',49); define('TRT_ClicBoutonCalendrier',124); define('TRT_affichageligne_Page',19); define('TRT_Filtre_Page',54); define('TRT_ouverture',0); define('TRT_clic_Page',16); define('TRT_initialisation_Page',12); define('TRT_finitialisation_Page',28); define('TRT_optionmenu_Page',26); define('trtOptionMenu',32); define('trtSelection',33); define('TRT_selection_Page',27); define('WLTRT_Modification',17); define('TRT_modification_Serveur',47); define('TRT_UploadFichier',127); define('TRT_DeplacementRdvAgenda',131); define('TRT_RedimRdvAgenda',132); define('TRT_SupprimeRdvAgenda',134); define('TRT_AjouteRdvAgenda',135); define('TRT_ModifTitreRdvAgenda',137); define('TRT_AffichagePeriodeAgenda',138); define('TRT_DeplacementRessourceRdvPlanning',139); define('TRT_GetValeur_Page',50); define('TRT_SetValeur_Page',51); define('trtAffichageLigne',21); define('TRT_Clic_Navigateur',30); define('TRT_onSubmit_Navigateur',46); define('TRT_Clic_Navigateur_Apres_AJAX',181); define('nFILTRE_LIGNESUIVANTE' ,0x00); define('nFILTRE_OK' ,0x01); define('nFILTRE_FIN' ,0x02); define('nFILTRE_ERREUR' ,0x04); define('VM_MONPROJET','MonProjet'); define('dwCODETranparent', 0xFF000000); define('dwCODETranparent55', -1); define('dwCODEAutomatique', 0xFF000001); define('dwCODESys3DClair', 0xF1000000); define('dwCODESys3DTresClair', 0xF1800000); define('dwCODESys3DBouton', 0xF2000000); define('dwCODESys3DFonce', 0xF3000000); define('dwCODESys3DTresFonce', 0xF3800000); define('dwCODESysTexte', 0xF4000000); define('dwCODESysFondFenetre', 0xF4800000); define('dwCODESysSelected', 0xF5000000); define('dwCODESysSelectedTex',0xF5800000); define('dwCODESysTexteFenetr',0xF6000000); define('dwCODESysScrollBar', 0xF6800000); define('dwCODESysMenuText', 0xF7000000); define('dwCODESysMenuFond', 0xF7000001); define('dwCODESysFondMDI', 0xF7800000); define('dwCODESysFondBulle', 0xF7900001); define('dwCODESysTexteBulle', 0xF7900002); define('dwCODEInvalid', 0xFBADC0DE); function Ffc5d2da8() { return new CCouleur(0x00,0x00,0x00); } function Fb7e98836() { return new CCouleur(0xFF,0x00,0x00); } function F0e0a758c() { return new CCouleur(0xFF, 0x00, 0xFF); } function Fa7c04636() { return new CCouleur(0xFF,0xFF,0xFF); } function Fa0589f67() { return new CCouleur(0xC0,0xC0,0xC0); } function F89c1612f() { return new CCouleur(dwCODETranparent); } function F1fcd4812() { return new CCouleur(dwCODESys3DClair); } function F200cb33e() { return new CCouleur(dwCODESys3DTresClair); } function Ff041a58e() { return new CCouleur(dwCODESys3DBouton); } function F61fb908b() { return new CCouleur(dwCODESys3DFonce); } function Feef9820b() { return new CCouleur(dwCODESys3DTresFonce); } class CCouleur { var $m_dwColor; function CCouleur() { $argc = func_num_args(); switch ($argc) { case 1: $this->m_dwColor = func_get_arg(0); break; case 3: $r=func_get_arg(0); $g=func_get_arg(1); $b=func_get_arg(2); $this->m_dwColor = F4f6e8051($r,$g,$b,0); break; default; $this->m_dwColor = dwCODEInvalid; } } function F4f04ad31() { return (($this->m_dwColor) ) & 0xFF; } function F8b780ec3() { return (($this->m_dwColor) >> 8) & 0xFF; } function F5825ff29() { return (($this->m_dwColor) >> 16) & 0xFF; } function F38db1168() { return Ffedcc57c($this->m_dwColor); } function Fd061cc94() { return ($this->m_dwColor != dwCODEInvalid); } function F01589132() { return (($this->m_dwColor & 0xFF000000) === 0); } function F7e0c31ba() { switch ($this->m_dwColor) { case dwCODESys3DTresClair: return F1fcd4812(); case dwCODESys3DClair: return Ff041a58e(); case dwCODESys3DBouton: return F61fb908b(); case dwCODESys3DFonce: return Feef9820b(); case dwCODESys3DTresFonce: return Ffc5d2da8(); case dwCODETranparent: return F89c1612f(); default: $coul = $this->m_dwColor; $bRouge = F0e611786( $coul ); $bVert = F5761a83e( $coul ); $bBleu = Fcf70f503( $coul ); $bRouge = (0xFF)&($bRouge > 0x40 ? $bRouge - 0x40 : 0); $bVert = (0xFF)&($bVert > 0x40 ? $bVert - 0x40 : 0); $bBleu = (0xFF)&($bBleu > 0x40 ? $bBleu - 0x40 : 0); return new CCouleur( F4f6e8051($bRouge, $bVert, $bBleu , 0) ); } } function Fa293f715() { switch ($this->m_dwColor) { case dwCODESys3DTresFonce: return F61fb908b(); case dwCODESys3DFonce: return Ff041a58e(); case dwCODESys3DBouton: return F1fcd4812(); case dwCODESys3DClair: return F200cb33e(); case dwCODESys3DTresClair: return Fa7c04636(); case dwCODETranparent: return F89c1612f(); default: $coul = $this->m_dwColor; $byRouge = F0e611786( $coul ); $byVert = F5761a83e( $coul ); $byBleu = Fcf70f503( $coul ); $byRouge = (0xFF)&($byRouge < 0xC0 ? $byRouge + 0x40 : 0xFF); $byVert = (0xFF)&($byVert < 0xC0 ? $byVert + 0x40 : 0xFF); $byBleu = (0xFF)&($byBleu < 0xC0 ? $byBleu + 0x40 : 0xFF); return new CCouleur( F4f6e8051($byRouge, $byVert, $byBleu , 0) ); } } } function Ffedcc57c( $dwColor) {return ($dwColor == dwCODETranparent);} define('COLORREF_TabCouleurSympa_0',0x69bfff); define('COLORREF_TabCouleurSympa_1',0xc79dff); define('COLORREF_TabCouleurSympa_2',0xf89dd7); define('COLORREF_TabCouleurSympa_3',0xffa3b2); define('COLORREF_TabCouleurSympa_4',0xe8af67); define('COLORREF_TabCouleurSympa_5',0xe6c365); define('COLORREF_TabCouleurSympa_6',0xcbd75e); define('COLORREF_TabCouleurSympa_7',0x71e388); define('COLORREF_TabCouleurSympa_8',0x33e4b0); define('COLORREF_TabCouleurSympa_9',0x2bebd8); define('COLORREF_TabCouleurSympa_10',0x40d4ff); define('nNBCOULEURSYMPA',11); define('nNbTourClair',2); define('nNbTourMax',nNBCOULEURSYMPA); define('dCoef', 4.5); define('dMAX_LIMI_DONNECOULEUR', 92.0); define('dMIN_LIMI_DONNECOULEUR', 10.0); function F909fab4a($pszString) { $retval=0; if ($pszString === '') { return 0; } $i=0; while (isset($pszString[$i])) { $nOrd = 0xFF & ord($pszString[$i]); if ($nOrd & 0x80 ) { $nOrd=bindec(strtr(substr(decbin($nOrd),1),'01','10')) + 1; $retval-=$nOrd; } else { $retval+= ord(strtoupper($pszString[$i])); } ++$i; } return $retval; } function F229c12d9($nIndiceC, $nSerie=0 ) { if ($nIndiceC < nNBCOULEURSYMPA) { return constant('COLORREF_TabCouleurSympa_' . $nIndiceC); } $nModulo = $nIndiceC % nNBCOULEURSYMPA; $nCouleur = constant('COLORREF_TabCouleurSympa_' . $nModulo); $T = $dLuminosite = $S = 0; F043b1c5e($nCouleur,$T,$dLuminosite,$S); $nNbTour = intval($nIndiceC/nNBCOULEURSYMPA); $nNbTour = $nNbTour % nNbTourMax; if ($nNbTour===0) return $nCouleur; if ($nNbTour <= nNbTourClair) { $dLuminosite = $dLuminosite + $nNbTour*dCoef; } else { $dLuminosite = $dLuminosite - ($nNbTour-nNbTourClair)*dCoef; } if ($dLuminosite>=dMAX_LIMI_DONNECOULEUR) $dLuminosite = dMAX_LIMI_DONNECOULEUR; if ($dLuminosite<dMIN_LIMI_DONNECOULEUR) $dLuminosite = dMIN_LIMI_DONNECOULEUR; return F5e769b88($T,$dLuminosite,$S); } function F6fa4e776($pszIdentifiant, $nSerie=0 ) { if ($pszIdentifiant == '') return F229c12d9(0, $nSerie); if (intval($pszIdentifiant) > 0) { return F229c12d9(intval($pszIdentifiant)-1, $nSerie); } $dwSum = (F909fab4a($pszIdentifiant)*743 + 89) % ((nNbTourClair+1)*nNBCOULEURSYMPA); return F229c12d9($dwSum, $nSerie); } define('CADRAGEH_WEB' ,53); define('CADRAGEV_WEB' ,54); define('COULEUR_WEB' ,10); define('COULEURFOND_WEB',11); define('CURSEURSOURIS_WEB',43); define('PROP_INVALID_MIN',-1); define('BULLE_WEB',39); define('VALEUR',1); define('CONTENU_WEB',63); define('BORNEMIN_WEB',64); define('BORNEMAX_WEB',65); define('BOUTONCALENDRIER_WEB',66); define('IMAGE_WEB',66); define('VERTICAL',74); define('RESSOURCE',75); define('GRANULARITERENDEZVOUS',76); define('HEUREOUVRABLEDEBUT',77); define('HEUREOUVRABLEFIN',78); define('MASQUETITREDATE',79); define('BORNEMAX',65); define('BORNEMIN',64); define('IMAGE',34); define('IMAGE_ETAT',82); define('TYPE', 2); $WB_bEnModeAJAX = false; $_gszSEPDEC = _WW_SEPDECIMAL_; $_gszSEPMIL = _WW_SEPMILLIER_; $_gszSEPDEVISE = null; $_gszGFI_ACTIVE = true; $_gszGFI_TAUX = 60; $_WB_VM_MANAGER_ = null; define('VM_NOM_PHP',0); define('VM_FIC_PHP',1); class FMK_MachineVirtuellePHP { var $m_sNom; var $m_tabNomChamps = array(); var $m_tabProcedures = array(); var $m_tabPCode = array(); var $m_tabAttributs = array(); var $m_tabNomVariables = array(); var $m_tabFils = array(); var $m_Parent = null; var $m_sNomProcExceptionGenerale = null; var $m_bGestionErreur = false; var $m_bGestionException = false; var $m_nTypeContexte = null; function FMK_MachineVirtuellePHP($sNomVM) { $this->m_sNom = $sNomVM; } function Fe7b58414() { return ($this->m_nTypeContexte == 2); } function Fee6cd3ea() { return ($this->m_nTypeContexte == 1); } function Fbd28557d() { if (isset($this->m_sNomProcExceptionGenerale)) return $this->m_sNomProcExceptionGenerale; if (!isset($this->m_Parent)) return null; return $this->m_Parent->Fbd28557d(); } function& F0df7a7a4() { return $this->m_Parent; } function Fdb41866b() { return isset($this->m_Parent); } function Fb35cfc09(&$clVMFils) { $sNom = $clVMFils->getNom(); $this->m_tabFils[ $sNom ] =& $clVMFils; $this->m_tabFils[ $sNom ]->m_Parent =& $this; } function F34270a9b($sNomVariableGlobaleWL, $sNomVariableGlobalePHP) { $this->m_tabNomVariables[$sNomVariableGlobaleWL] = $sNomVariableGlobalePHP; } function F54f593cd($sNomChampWL, $sNomChampPHP) { $this->m_tabNomChamps[$sNomChampWL] = $sNomChampPHP; } function F2a7eac79($sNomWL, $sNomPHP, $sFichier = null) { $this->m_tabProcedures[$sNomWL] = array(VM_NOM_PHP=>$sNomPHP,VM_FIC_PHP=>$sFichier); } function F73935150($sNomWL, $sNomPHP) { $this->m_tabAttributs[$sNomWL] = $sNomPHP; } function F6c094a53(&$clParent) { $this->m_Parent =& $clParent; } function F67af5b5c($sNomChamp) { if (utf8_strpos($sNomChamp,'.')!==false) { $tabArbre = utf8_explode('.',$sNomChamp); $nTaille=count($tabArbre,COUNT_NORMAL); $sCheminParent = utf8_implode('.',array_slice($tabArbre,0,$nTaille-1)); $clVM =& $this; $clVMMgr =& F08aafbb0(); $tabNomVMs = array_keys($clVMMgr->m_tabVMs); $size = count($tabNomVMs); for ($i=0; $i<$size; $i++) { if ( (($sNomTrouve = utf8_stristr($tabNomVMs[$i],$sCheminParent))!==false) && (utf8_strpos($tabNomVMs[$i],$sNomTrouve) === (utf8_strlen($tabNomVMs[$i]) - utf8_strlen($sNomTrouve)) ) ) { $clVM =& $clVMMgr->m_tabVMs[$tabNomVMs[$i]]; return $clVM->F67af5b5c($tabArbre[$nTaille-1]); } } $sNomPHPparent = $this->F67af5b5c($sCheminParent); if (isset($sNomPHPparent)) { $pclParent =& $GLOBALS[$sNomPHPparent]; if ($pclParent->F70cea20e()) { if ($pclParent->GetType() == TYPE_CHAMP_TABLE) { $pclColonne =& $pclParent->Fd94d3bbc($tabArbre[$nTaille-1]); if (isset($pclColonne)) return $pclColonne->m_sNomPHP; } elseif (Fba68c6f1($pclParent)) { if (array_key_exists($tabArbre[$nTaille-1],$pclParent->TabAttribut)) { $clAttribut =& $pclParent->TabAttribut[$tabArbre[$nTaille-1]]; if (isset($clAttribut)) return $clAttribut->m_sNomPHP; } foreach (array_keys($pclParent->TabRupture) as $nIndice ) { $tabRuptureI = $pclParent->TabRupture[$nIndice]; if (isset($tabRuptureI[RUPTURE_HAUT])) { $pclRupture =& $tabRuptureI[RUPTURE_HAUT]; if (utf8_strcasecmp($pclRupture->m_sNomWL,$tabArbre[$nTaille-1])===0) { return $pclRupture->m_sNomPHP; } } if (isset($tabRuptureI[RUPTURE_BAS])) { $pclRupture =& $tabRuptureI[RUPTURE_BAS]; if (utf8_strcasecmp($pclRupture->m_sNomWL,$tabArbre[$nTaille-1])===0) { return $pclRupture->m_sNomPHP; } } } } elseif($pclParent->GetType() == 16) { $sNomPHPChamp = $this->F67af5b5c($tabArbre[$nTaille-1]); if (isset($sNomPHPChamp)) { if (strcmp($GLOBALS[$sNomPHPChamp]->m_pclOngletDuChamp->m_sNomPHP,$sNomPHPparent)===0) return $sNomPHPChamp; } } else { $sNomPHPChamp = $this->F67af5b5c($tabArbre[$nTaille-1]); if (isset($sNomPHPChamp)) { return $sNomPHPChamp; } } } } return null; } if (isset($this->m_tabNomChamps[$sNomChamp])) return $this->m_tabNomChamps[$sNomChamp]; if (in_array($sNomChamp,$this->m_tabNomChamps)) return $sNomChamp; $sNomChampMinuscule = F03771b65(utf8_strtolower($sNomChamp)); $tabNomChamps = array_keys($this->m_tabNomChamps); $size = sizeof($tabNomChamps); for ($i=0; $i<$size; $i++) { if ($sNomChampMinuscule == F03771b65(utf8_strtolower($tabNomChamps[$i]))) { return $this->m_tabNomChamps[ $tabNomChamps[$i] ]; } } $sNomZR = $this->F7ac85ba8($sNomChamp); if (isset($sNomZR)){ $clZR =& $GLOBALS[$sNomZR]; if (Fba68c6f1($clZR)) $clAttribut =& $clZR->TabAttribut[$sNomChamp]; else $clAttribut =& $clZR->Fd94d3bbc($sNomChamp); return $clAttribut->m_sNomPHP; } if (!$GLOBALS['_VM_VERROU_RECURSIF_']) { if (isset($this->m_Parent)) return $this->m_Parent->F67af5b5c($sNomChamp); if ($this->getNom() == VM_MONPROJET) { $GLOBALS['_VM_VERROU_RECURSIF_'] = true; $clVMMgr =& F08aafbb0(); for ($i=0; $i < $clVMMgr->m_nTaillePile; $i++) { $sNomTrouve = $clVMMgr->m_tabVMs[ $clVMMgr->m_stackVMs[$i] ]->F67af5b5c($sNomChamp); if (isset($sNomTrouve)) { $GLOBALS['_VM_VERROU_RECURSIF_'] = false; return $sNomTrouve; } } $GLOBALS['_VM_VERROU_RECURSIF_'] = false; } } return null; } function F5919ed9f($sNomVarGlobale) { if (isset($this->m_tabNomVariables[$sNomVarGlobale])) return $this->m_tabNomVariables[$sNomVarGlobale]; $sNomVarMinuscule = F03771b65(utf8_strtolower($sNomVarGlobale)); foreach ($this->m_tabNomVariables as $sNomWL => $sNomPHP) { if (($sNomVarMinuscule == F03771b65(utf8_strtolower($sNomWL)))||($sNomVarMinuscule == F03771b65(utf8_strtolower($sNomPHP)))) { return $sNomPHP; } } if (!$GLOBALS['_VM_VERROU_RECURSIF_']) { if (isset($this->m_Parent)) return $this->m_Parent->F5919ed9f($sNomVarGlobale); if ($this->getNom() == VM_MONPROJET) { $GLOBALS['_VM_VERROU_RECURSIF_'] = true; $clVMMgr =& F08aafbb0(); for ($i=0; $i < $clVMMgr->m_nTaillePile; $i++) { if (!is_object($clVMMgr->m_tabVMs[ $clVMMgr->m_stackVMs[$i] ])) break; $sNomTrouve = $clVMMgr->m_tabVMs[ $clVMMgr->m_stackVMs[$i] ]->F5919ed9f($sNomVarGlobale); if (isset($sNomTrouve)) { $GLOBALS['_VM_VERROU_RECURSIF_'] = false; return $sNomTrouve; } } $GLOBALS['_VM_VERROU_RECURSIF_'] = false; } } return null; } function Ff06e3e53($sNomProc,$bRetournerDependance = false) { $nTypeRetour = $bRetournerDependance ? VM_FIC_PHP : VM_NOM_PHP; if (isset($this->m_tabProcedures[$sNomProc])) return $this->m_tabProcedures[$sNomProc][$nTypeRetour]; $sNomProcMinuscule = F03771b65(utf8_strtolower($sNomProc)); if (F61bc61eb($sNomProcMinuscule,F03771b65(utf8_strtolower($this->m_sNom)).'.')) { $sNomProc = utf8_substr($sNomProc,utf8_strlen($this->m_sNom)+1); return $this->Ff06e3e53($sNomProc,$bRetournerDependance); } foreach ($this->m_tabProcedures as $sNomWL => $tabNomPHP) { if ($sNomProcMinuscule == F03771b65(utf8_strtolower($sNomWL))) { return $tabNomPHP[$nTypeRetour]; } } if (utf8_strpos($sNomProc,SepObjetTraitement)!==false) { $clVMMgr =& F08aafbb0(); $tabArbre = utf8_explode('.',$sNomProc); $nTaille=count($tabArbre,COUNT_NORMAL); $sCheminParent = utf8_implode('.',array_slice($tabArbre,0,$nTaille-1)); $clVM =& $this; $tabNomVMs = array_keys($clVMMgr->m_tabVMs); $size = count($tabNomVMs); for ($i=0; $i<$size; $i++) { if ( (($sNomTrouve = utf8_stristr($tabNomVMs[$i],$sCheminParent))!==false) && (utf8_strpos($tabNomVMs[$i],$sNomTrouve) === (utf8_strlen($tabNomVMs[$i]) - utf8_strlen($sNomTrouve)) ) ) { $clVM =& $clVMMgr->m_tabVMs[$tabNomVMs[$i]]; return $clVM->Ff06e3e53($tabArbre[$nTaille-1]); } } } if (!$GLOBALS['_VM_VERROU_RECURSIF_']) { if (isset($this->m_Parent)) return $this->m_Parent->Ff06e3e53($sNomProc,$bRetournerDependance); if ($this->getNom() == VM_MONPROJET) { $GLOBALS['_VM_VERROU_RECURSIF_'] = true; $clVMMgr =& F08aafbb0(); for ($i=0; $i < $clVMMgr->m_nTaillePile; $i++) { if (!is_object($clVMMgr->m_tabVMs[ $clVMMgr->m_stackVMs[$i] ])) break; $sNomTrouve = $clVMMgr->m_tabVMs[ $clVMMgr->m_stackVMs[$i] ]->Ff06e3e53($sNomProc,$bRetournerDependance); if (isset($sNomTrouve)) { $GLOBALS['_VM_VERROU_RECURSIF_'] = false; return $sNomTrouve; } } if ($GLOBALS['_VM_VERROU_RECURSIF_']) { foreach($clVMMgr->m_tabVMs as $sNomVM => $__clVM) { if (($sNomVM !== VM_MONPROJET)&&(VM_MONPROJET==$__clVM->m_Parent->getNom())) { $sNomTrouve = $clVMMgr->m_tabVMs[$sNomVM]->Ff06e3e53($sNomProc,$bRetournerDependance); if (isset($sNomTrouve)) { $GLOBALS['_VM_VERROU_RECURSIF_'] = false; return $sNomTrouve; } } } } $GLOBALS['_VM_VERROU_RECURSIF_'] = false; } } return null; } function F7ac85ba8($sNomAtt) { if (isset($this->m_tabAttributs[$sNomAtt])) return $this->m_tabAttributs[$sNomAtt]; if (!$GLOBALS['_VM_VERROU_RECURSIF_']) { if (isset($this->m_Parent)) $this->m_Parent->F7ac85ba8($sNomAtt); if ($this->getNom() == VM_MONPROJET) { $GLOBALS['_VM_VERROU_RECURSIF_'] = true; $clVMMgr =& F08aafbb0(); for ($i=0; $i < $clVMMgr->m_nTaillePile; $i++) { $sNomTrouve = $clVMMgr->m_tabVMs[ $clVMMgr->m_stackVMs[$i] ]->F7ac85ba8($sNomAtt); if (isset($sNomTrouve)) { $GLOBALS['_VM_VERROU_RECURSIF_'] = false; return $sNomTrouve; } } $GLOBALS['_VM_VERROU_RECURSIF_'] = false; } } return null; } function getNom() { return $this->m_sNom; } function F4b4af49b($nCode,$nInfo) { switch ($nCode) { case VM_NOTIF_ERREUR: $this->m_bGestionErreur = true; break; case VM_NOTIF_EXCEPTION: $this->m_bGestionException = true; break; } } function F616ccf19() { return $this->m_bGestionErreur!==false; } function F8e8c7c1f() { return $this->m_bGestionException!==false; } function F6d0286a8($nCode=null) { switch ($nCode) { case null: case VM_NOTIF_ERREUR: $this->m_bGestionErreur = false; if (isset($nCode)) break; case VM_NOTIF_EXCEPTION: $this->m_bGestionException = false; if (isset($nCode)) break; default: } } } class FMK_VMManager { var $m_tabVMs = array(); var $m_stackVMs = array(); var $m_nTaillePile = 0; var $m_stackMoiMeme = array(); function FMK_VMManager($sNomVMDefaut) { if (defined('_SINGLETON_CVMMANAGER_')) die("ERREUR DE SINGLETON SUR CVMManager"); define('_SINGLETON_CVMMANAGER_',true); $GLOBALS['_VM_VERROU_RECURSIF_'] = false; $this->F6f72c396($sNomVMDefaut,0); $this->empileVM($sNomVMDefaut); } function F2ddada23() { $this->m_nTaillePile = 1; $this->m_stackVMs = array(VM_MONPROJET); $this->m_stackMoiMeme = array(null); } function F2c169256(&$clVM) { $sNom = $clVM->getNom(); $this->m_tabVMs[ $sNom ] =& $clVM; $nPos = utf8_strlen(utf8_strrchr($sNom,'.')); if ($nPos<1) { if ($sNom!=VM_MONPROJET) { $Parent =& $this->Fe26ffff2(getRef(VM_MONPROJET)); $this->m_tabVMs[ $sNom ]->F6c094a53($Parent); } } else { $sNomParent = utf8_substr($sNom,0,utf8_strlen($sNom) - $nPos); $Parent =& $this->Fe26ffff2($sNomParent); $this->m_tabVMs[ $sNom ]->F6c094a53($Parent); } } function F6f72c396($sNomVM,$nType) { $clVM = new FMK_MachineVirtuellePHP($sNomVM); $clVM->m_nTypeContexte = $nType; $this->F2c169256($clVM); } function empileVM($sNomVM, $pclChampMoimeme=null ) { if (!isset($sNomVM)) { $sNomVM = $this->obtenirVM(); } $this->m_stackVMs[$this->m_nTaillePile] = $sNomVM; $this->m_stackMoiMeme[$this->m_nTaillePile] = $pclChampMoimeme; return ++$this->m_nTaillePile; } function Ff094e78e() { --$this->m_nTaillePile; unset($this->m_stackVMs[$this->m_nTaillePile]); unset($this->m_stackMoiMeme[$this->m_nTaillePile]); } function lierVM($sNomVM , $sNomWL, $sNomPHP, $sFichier = null) { if (!isset($this->m_tabVMs[$sNomVM])) { global $MaPage; $this->F6f72c396($sNomVM,(isset($MaPage) && $MaPage->Nom==$sNomVM) ? 1 : 2); } $this->m_tabVMs[$sNomVM]->F2a7eac79($sNomWL,$sNomPHP,$sFichier); } function& Fe26ffff2($sNomVM,$bCreerSiInexistante=true) { if (!isset($this->m_tabVMs[$sNomVM])) { $nPosVM = array_search(utf8_strtoupper($sNomVM),array_keys(utf8_array_change_key_case($this->m_tabVMs,CASE_UPPER))); if ($nPosVM!==false) { return $this->m_tabVMs[current(array_slice(array_keys($this->m_tabVMs),$nPosVM,1))]; } if (!$bCreerSiInexistante) { $null = null; return $null; } global $MaPage; $this->F6f72c396($sNomVM,($MaPage->Nom==$sNomVM) ? 1 : 2); } return $this->m_tabVMs[$sNomVM]; } function& Fe5d77316($i) { $Retour=null; if (!isset($this->m_stackVMs[$i])) { return $Retour; } return $this->m_tabVMs[ $this->m_stackVMs[$i] ]; } function obtenirVM() { return $this->m_stackVMs[$this->m_nTaillePile-1]; } function F9faba883() { $i=$this->m_nTaillePile; while(array_key_exists(--$i,$this->m_stackMoiMeme)) if($this->m_stackMoiMeme[$i]!='') return $this->m_stackMoiMeme[$i]; return null; } } function& F08aafbb0() { if (!isset($GLOBALS['_WB_VM_MANAGER_'])) { $GLOBALS['_WB_VM_MANAGER_'] = new FMK_VMManager(VM_MONPROJET); } return $GLOBALS['_WB_VM_MANAGER_']; } function F13331dbd(&$pclVMMgr) { $GLOBALS['_WB_VM_MANAGER_'] = null; $GLOBALS['_WB_VM_MANAGER_'] =& $pclVMMgr; $GLOBALS['_WB_VM_MANAGER_']->F2ddada23(); $GLOBALS['_VM_VERROU_RECURSIF_'] = false; } function empileVM( $sNomComplet, $pclChampMoimeme=null ) { $VMMgr =& F08aafbb0(); return $VMMgr->empileVM($sNomComplet,$pclChampMoimeme); } function Ff094e78e() { $VMMgr =& F08aafbb0(); $VMMgr->Ff094e78e(); } function lierVM($sNomVM , $sNomWL, $sNomPHP, $sFichier = null) { $VMMgr =& F08aafbb0(); $VMMgr->lierVM($sNomVM , $sNomWL, $sNomPHP, $sFichier) ; } function& obtenirVM() { $VMMgr =& F08aafbb0(); return $VMMgr->Fe26ffff2( $VMMgr->obtenirVM() ); } function setContextePile($nCode,$nInfo) { $pclCtx =& FMK_Contexte(); $pclCtx->setContextePile($nCode,$nInfo); } function F8a27199b($nCode=null) { $pclCtx =& FMK_Contexte(); $pclCtx->F8a27199b($nCode); } function verifiePileVM($nNiveauAttendu) { $VMMgr =& F08aafbb0(); while($nNiveauAttendu<$VMMgr->m_nTaillePile) { _return(getRef()); } } function& _return(&$param) { Ff094e78e(); F8a27199b(); F7112dc57(); return $param; } class CContexteWL extends CTypeComparable { var $TabVarGlobale; var $TabParamsGlobaux = null; var $TabVarGlobaleInterneComposante; var $pclContexteSQL; var $pclContexteHF; var $m_tabContexteInternational = null; var $TabVarConstante = array(); var $m_tabCallbacksSauveContexte = array(); var $m_tabCallbacksRestaureContexte = array(); function F214aea6a($sNomGlobale, $sValeur) { if (!isset($this->m_tabContexteInternational)) $this->m_tabContexteInternational = array(); $this->m_tabContexteInternational[$sNomGlobale] = $sValeur; $GLOBALS[$sNomGlobale] = $sValeur; } function WB_DeclareVarGlobale( $sNomWL , $sNomPHP ) { $this->TabVarGlobale[ $sNomPHP ] = ""; $clVM =& obtenirVM(); $clVM->F34270a9b($sNomWL,$sNomPHP); } function WB_DeclareParametre( $sNomPHP , $nIndice ) { if (!isset( $this->TabParamsGlobaux ) ) $this->TabParamsGlobaux = array(); $this->TabParamsGlobaux [$nIndice] = $sNomPHP; } function WB_DeclareCte( $szNomVar ) { $pclVM =& obtenirVM(); $szNomVar = $pclVM->m_sNom .'_'.$szNomVar; $this->TabVarConstante[ $szNomVar ] = constant($szNomVar); } function F4d351a8f() { if (isset( $this->TabVarGlobale ) ) { $clContexte =& F4a1887ce(); $tabAutoInclude = $clContexte->F239ddeda('__AUTO__INCLUDE__'); if (!isset($tabAutoInclude)) $tabAutoInclude = array(); $tabTabVarGlobale = array_keys($this->TabVarGlobale ); $nNbVar = count($tabTabVarGlobale,COUNT_NORMAL); for($i = 0; $i<$nNbVar; $i++) { $szNomVar = $tabTabVarGlobale[$i]; if (isset($GLOBALS[$szNomVar])) { $this->TabVarGlobale[ $szNomVar ] = $GLOBALS[ $szNomVar ]; if (is_object($GLOBALS[ $szNomVar ])) { $tabAutoInclude[$GLOBALS[ $szNomVar ]->F1e21db15()] = true; $tabDependances = array(); $tabDependances = $GLOBALS[ $szNomVar ]->F6571e3e1(); foreach ($tabDependances as $dep) $tabAutoInclude[$dep]=true; } } } $clContexte->F4c8f9bd4('__AUTO__INCLUDE__',$tabAutoInclude); } if (function_exists( 'SQL_SauveContexte' ) ) { SQL_SauveContexte( $this ); } if (function_exists( 'HF_SauveContexte' ) ) { HF_SauveContexte( $this ); } if (function_exists( 'VM_SauveVariableGlobaleInterne' ) ) { VM_SauveVariableGlobaleInterne( $this ); } if (function_exists( 'STD_SauveVariableGlobaleInterne' ) ) { STD_SauveVariableGlobaleInterne( $this ); } if (function_exists( 'MAT_SauveVariableGlobaleInterne' ) ) { MAT_SauveVariableGlobaleInterne( $this ); } if (function_exists( 'XML_SauveVariableGlobaleInterne' ) ) { XML_SauveVariableGlobaleInterne( $this ); } if (function_exists( 'COM_SauveVariableGlobaleInterne' ) ) { COM_SauveVariableGlobaleInterne( $this ); } if (function_exists( 'PAGE_SauveVariableGlobaleInterne' ) ) { PAGE_SauveVariableGlobaleInterne( $this ); } global $gtabCallbacksSauveContexte; if (isset($gtabCallbacksSauveContexte)) { $this->m_tabCallbacksSauveContexte = $gtabCallbacksSauveContexte; foreach ($this->m_tabCallbacksSauveContexte as $sNomCallback) { if (function_exists($sNomCallback)) { call_user_func_array($sNomCallback,array(&$this)); } } } if (isset($this->m_tabContexteInternational)) { foreach (array_keys($this->m_tabContexteInternational) as $sNomInfo) { $this->m_tabContexteInternational[$sNomInfo] = $GLOBALS[$sNomInfo]; } } } function WB_RestaureContexte() { if (isset($this->TabVarGlobale)) { foreach ($this->TabVarGlobale as $szNomVar => $ValeurVar ) { $GLOBALS[ $szNomVar ] = $ValeurVar; } } foreach ($this->TabVarConstante as $sNomConstante => $ValeurCte) { define($sNomConstante,$ValeurCte); } if (function_exists( 'SQL_RestaureContexte' ) ) { SQL_RestaureContexte( $this ); } if (function_exists( 'HF_RestaureContexte' ) ) { HF_RestaureContexte( $this ); } if (function_exists( 'VM_RestaureVariableGlobaleInterne' ) ) { VM_RestaureVariableGlobaleInterne( $this ); } if (function_exists( 'STD_RestaureVariableGlobaleInterne' ) ) { STD_RestaureVariableGlobaleInterne( $this ); } if (function_exists( 'MAT_RestaureVariableGlobaleInterne' ) ) { MAT_RestaureVariableGlobaleInterne( $this ); } if (function_exists( 'XML_RestaureVariableGlobaleInterne' ) ) { XML_RestaureVariableGlobaleInterne( $this ); } if (function_exists( 'COM_RestaureVariableGlobaleInterne' ) ) { COM_RestaureVariableGlobaleInterne( $this ); } if (function_exists( 'PAGE_RestaureVariableGlobaleInterne' ) ) { PAGE_RestaureVariableGlobaleInterne( $this ); } global $gtabCallbacksRestaureContexte; if (isset($gtabCallbacksRestaureContexte)) { $this->m_tabCallbacksRestaureContexte = $gtabCallbacksRestaureContexte; foreach ($this->m_tabCallbacksRestaureContexte as $sNomCallback) { if (function_exists($sNomCallback)) { call_user_func_array($sNomCallback,array(&$this)); } } } if (isset($this->m_tabContexteInternational)) { foreach (array_keys($this->m_tabContexteInternational) as $sNomInfo) { $GLOBALS[$sNomInfo] = $this->m_tabContexteInternational[$sNomInfo]; } } if (isset( $this->TabParamsGlobaux ) ) { foreach($this->TabParamsGlobaux as $nIndice => $sNomPHP) { $GLOBALS[$sNomPHP] = F4e7f6fae('P' . $nIndice,$GLOBALS[$sNomPHP]); } } } } function Callback_FinExecution() { global $MaPage; $i=0; while(isset($MaPage)&&isset($MaPage->m_tabShutdownFunctions[$i])&&function_exists($MaPage->m_tabShutdownFunctions[$i])) { call_user_func($MaPage->m_tabShutdownFunctions[$i]); ++$i; } } class CPage extends CContexteWL { var $TabChamp; var $TabInfoPreGenerationChamp = array(); var $TabChampLiaison; var $Nom; var $Libelle; var $LibelleRiche; var $CouleurFond; var $CouleurFondInitiale; var $Type ; var $bUTF8 = false; var $bAvecContexte = false; var $m_sDescription; var $m_sMotsCles; var $m_ValeurRenvoyee; var $m_clContexteManager = null; var $m_sNomPHP; var $m_tabShutdownFunctions = array('_PEAR_call_destructors'); var $bChampsAffectes = false; var $bDansGereActionsAjax = false; var $m_bAccueil = false; var $sFichierPalette = ''; var $m_sHTMLEntete = ''; var $m_sHTMLFinPage = ''; var $Alias; function CPage($bAccueil=false) { $this->TabChamp = array(); $this->TabChampLiaison = array(); $this->CouleurFond = -1; $this->CouleurFondInitiale = -1; $this->m_clContexteManager =& F08aafbb0(); $this->m_bAccueil = $bAccueil; } function Ff017d92b($sNomFonction) { XASSERT(function_exists($sNomFonction)); $this->m_tabShutdownFunctions[] = $sNomFonction; } function Fba0bee0f() { return Feef890d7(); } function Ffe9176c6(&$pclChamp,$sValeurPOST) { if (null !== $pclChamp->m_pclControleur) { $pclChamp->m_pclControleur->Fb29dfdd9($sValeurPOST); return true; } return false; } function Ff1153809($sPrefix='?') { $sHtmlSupp = ''; if ($this->bAvecContexte === false && isset($this->TabParamsGlobaux)) { foreach ($this->TabParamsGlobaux as $nIndice => $sNomPHP) { $sHtmlSupp .= $sPrefix . 'P' . $nIndice . '=' . VersPrimitif(F9abbf335($sNomPHP,IND_VARIABLE)); $sPrefix = '&'; } } return $sHtmlSupp; } function Ff4e94fc7( &$pclObjet, $stModifProprieteAJAX) { switch ($stModifProprieteAJAX->F18e6794c()) { case TYPE: case VERTICAL: case RESSOURCE: case GRANULARITERENDEZVOUS: case HEUREOUVRABLEDEBUT: case HEUREOUVRABLEFIN: case MASQUETITREDATE: $stModifProprieteAJAX->m_ePropriete = PROP_INVALID_MIN; break; default: ; } F4c16799e($pclObjet->m_sNomPHP , $stModifProprieteAJAX->F18e6794c() ); } function& GetNom() { $sNom = $this->Nom; return $sNom; } function& F960e3ffe() { return $this->m_sNomPHP; } function& GetAlias() { $sNom = $this->Alias; return $sNom; } function F048cc3de() { return $this->GetAlias(); } function& GetValeurAffichee() { $retour = $this->Valeur; return $retour; } function SetLibelle($szNewVal) { $this->Libelle = $szNewVal; if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_LIBELLE); } } function& GetLibelle() { return $this->Libelle; } function SetLibelleRiche($NewVal) { $this->LibelleRiche = $NewVal; if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_LIBELLEHTML); } } function& GetLibelleRiche() { return $this->LibelleRiche; } function pszGetLibelleHTML() { return $this->LibelleRiche; } function SetTitre($szNewVal) { $this->SetLibelle($szNewVal); } function& GetTitre() { return $this->Libelle; } function F4a917fa4() { return 1; } function SetCouleurFond( $dwCoul ) { if ($dwCoul == iCouleurDefaut) { $this->CouleurFond = $this->CouleurFondInitiale; } else { $this->CouleurFond = $dwCoul; } if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_COULEURFOND); } } function& GetCouleurFond() { return $this->CouleurFond ; } function GetCouleurFondHTML() { return F5bfcd185($this->CouleurFond); } function& GetDescription() { return $this->m_sDescription; } function SetDescription($sDescription) { if (!is_string($sDescription)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PROP_SET"),$sDescription,Fc34ec142("PROP_NOM_DESCRIPTION"))); } else $this->m_sDescription = $sDescription; } function& GetMotsCles() { return $this->m_sMotsCles; } function SetMotsCles($sMotsCles) { if (!is_string($sMotsCles)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PROP_SET"),$sMotsCles,Fc34ec142("PROP_NOM_MOTSCLES"))); } else $this->m_sMotsCles = $sMotsCles; } function& GetValeurRenvoyee() { return $this->m_ValeurRenvoyee; } function SetValeurRenvoyee($ValeurRenvoyee) { $this->m_ValeurRenvoyee = $ValeurRenvoyee; } function SetHTMLEntete($szNewVal) { $this->m_sHTMLEntete = $szNewVal; } function& GetHTMLEntete() { return $this->m_sHTMLEntete; } function GetHTMLEnteteHTML() { return $this->GetHTMLEntete(); } function SetHTMLFinPage($szNewVal) { $this->m_sHTMLFinPage = $szNewVal; } function& GetHTMLFinPage() { return $this->m_sHTMLFinPage; } function GetHTMLFinPageHTML() { return $this->GetHTMLFinPage(); } function WB_AjouteChamp( $NomChamp, $ALIAS, &$pclChamp, $sNomPHP = null ) { $this->TabChamp[$ALIAS] = &$pclChamp ; $pclChamp->Nom = $NomChamp; $pclChamp->Alias = $ALIAS; if (isset($sNomPHP)) { $pclChamp->m_sNomPHP = $sNomPHP; } if (isset($this->TabInfoPreGenerationChamp[$ALIAS])) { $keys = array_keys($this->TabInfoPreGenerationChamp[$ALIAS]); $nNbMembres = count($keys); for($i=0; $i<$nNbMembres; $i++) { $pclChamp->{$keys[$i]} =& $this->TabInfoPreGenerationChamp[$ALIAS][$keys[$i]]; } unset($this->TabInfoPreGenerationChamp[$ALIAS]); } } function F7a045ba1($sAlias, &$pclChamp) { if (!array_key_exists($sAlias,$pclChamp)) $this->TabChampLiaison[$sAlias] = &$pclChamp; } function Fb6f2bea1( &$NomAttribut ) { $tabTabChamp = array_keys($this->TabChamp); $nNbChamps = count($tabTabChamp,COUNT_NORMAL); for($i=0; $i<$nNbChamps; $i++) { $RefChamp =& $this->TabChamp[ $tabTabChamp[$i] ]; if (!isset($RefChamp->TabAttribut)) continue; if (isset( $RefChamp->TabAttribut[ $NomAttribut ] )) { return $RefChamp->Alias; } if (isset($RefChamp->TabAttributNomAlias[$NomAttribut]) && isset($RefChamp->TabAttribut[$RefChamp->TabAttributNomAlias[$NomAttribut]])) { return $RefChamp->Alias; } foreach(array_keys($RefChamp->TabAttribut) as $sNom) { $Attribut =& $RefChamp->TabAttribut[$sNom]; $sCleAttAuto = 'ATT_' . $Attribut->m_sAliasChampLie . '_' . $Attribut->m_nIndicePropServeurWL; if ($NomAttribut == $sCleAttAuto) { $NomAttribut = $Attribut->Nom; return $RefChamp->Alias; } } } return null; } function& F1cbb0dd2( $szNomChampRech ) { $RetourParDefaut = null; $szNomChampRech = F03771b65($szNomChampRech); foreach ($this->TabChamp as $sAlias => $RefChamp ) { if (utf8_strcasecmp(F03771b65($RefChamp->Nom), $szNomChampRech) == 0) { return $this->TabChamp[$sAlias]; } } return F9abbf335($RetourParDefaut,IND_CHAMP); } function F4d351a8f() { parent::F4d351a8f(); $this->m_clContexteManager =& F08aafbb0(); } function WB_RestaureContexte() { parent::WB_RestaureContexte(); $this->bChampsAffectes = false; foreach (array_keys($this->TabChamp) as $Alias) { if (isset($this->TabChamp[$Alias]->Nom)) { $sNomPHP = $this->TabChamp[ $Alias ]->F960e3ffe(); $GLOBALS[ $sNomPHP ] =& $this->TabChamp[ $Alias ]; if($GLOBALS[ $sNomPHP ]->F70cea20e() && ($GLOBALS[ $sNomPHP ]->GetType() == 9 || $GLOBALS[ $sNomPHP ]->GetType() == TYPE_CHAMP_ZR)) { $GLOBALS[ $sNomPHP ]->WB_RestaureContexte(); } } } F13331dbd($this->m_clContexteManager); } function F4c1a2ac2() { foreach (array_keys($this->TabChamp) as $Alias) { $this->TabChamp[$Alias]->Fc6eb41aa(); } } function Fd12415ea($bRaz) { foreach ($this->TabChamp as $Alias => $RefChamp ) { $sNomMethodeInit = $RefChamp->F960e3ffe() . TRT_initialisation_Page; if(!function_exists($sNomMethodeInit)) $sNomMethodeInit = $RefChamp->F960e3ffe() ."INIT"; if(function_exists($sNomMethodeInit)) { call_user_func($sNomMethodeInit); } if($bRaz) { $this->TabChamp[$Alias]->Fc6eb41aa(); } } $sNomMethodeInit = $this->F960e3ffe(). TRT_finitialisation_Page; if(!function_exists($sNomMethodeInit)) $sNomMethodeInit = $this->F960e3ffe()."FINIT"; if(function_exists($sNomMethodeInit)) { call_user_func($sNomMethodeInit); } } function& Ffc024b6b( $szNomAttribut ) { $clVM =& obtenirVM(); $sNomZR = $clVM->F7ac85ba8($szNomAttribut); if (isset($sNomZR)) { if (isset($GLOBALS[$sNomZR])) { if ($GLOBALS[$sNomZR]->bEstZoneRepetee) { return $sNomZR; } } } $Retour = null; return $Retour; } function& GetType() { return getRef(1); } } class CProjet extends CContexteWL { var $m_szNomProjet; var $m_szPageCourante; var $m_szPageCouranteCasse; var $m_szPagePrecedente; var $m_szPagePrecedenteCasse; function InitProjet( $szNom ) { $this->m_szNomProjet = $szNom; $this->m_szPageCourante = ''; $this->m_szPageCouranteCasse = ''; $this->m_szPagePrecedente = ''; $this->m_szPagePrecedenteCasse = ''; } function SetPageCourante($szNom, $szNomCasse) { $this->m_szPagePrecedente = $this->m_szPageCourante; $this->m_szPagePrecedenteCasse = $this->m_szPageCouranteCasse; $this->m_szPageCourante = $szNom; $this->m_szPageCouranteCasse = $szNomCasse; $clVMMgr =& F08aafbb0(); $clVMProjet =& $clVMMgr->Fe26ffff2(VM_MONPROJET); $clVMProjet->F54f593cd($szNomCasse,$szNomCasse); $clVMMgr->F2ddada23(); if (!isset($clVMMgr->m_tabVMs[$szNomCasse])) { $clVMMgr->F6f72c396($szNomCasse,1); } empileVM($szNomCasse); } function SetPageCouranteContexte($szNom, $szNomCasse) { if (utf8_strcasecmp($szNom, $this->m_szPageCourante) != 0) { $this->m_szPagePrecedente = $this->m_szPageCourante; $this->m_szPagePrecedenteCasse = $this->m_szPageCouranteCasse; $this->m_szPageCourante = $szNom; $this->m_szPageCouranteCasse = $szNomCasse; } $clVMMgr =& F08aafbb0(); $clVMProjet =& $clVMMgr->Fe26ffff2(VM_MONPROJET); $clVMMgr->F2ddada23(); $clVMProjet->F54f593cd($szNomCasse,$szNomCasse); empileVM($szNomCasse); } function F539b5aa8() { return $this->m_szPagePrecedente; } function F03298240() { return $this->m_szPagePrecedenteCasse; } } function F0ce8ab0e($sNom) { if (!isset($GLOBALS['gtabCallbacksSauveContexte'])) $GLOBALS['gtabCallbacksSauveContexte']=array(); $GLOBALS['gtabCallbacksSauveContexte'][] = $sNom; } function F493cdf66($sNom) { if (!isset($GLOBALS['gtabCallbacksRestaureContexte'])) $GLOBALS['gtabCallbacksRestaureContexte']=array(); $GLOBALS['gtabCallbacksRestaureContexte'][] = $sNom; } function& F4a1887ce() { return FMK_Contexte(); } function& GetPage($sNomPage) { if (isset($GLOBALS[$sNomPage])) { } $clContexte =& F4a1887ce(); $tabSessionVar = $clContexte->Fcb77bf46(); if (isset($tabSessionVar[$sNomPage])) { return $tabSessionVar[$sNomPage]; } return Fe81a7f9e('ERR_PAGE_INCONNUE',$sNomPage); } function ChangeAlphabet ($nCharSet, $bForce = true) { if ($bForce || (F0cc8c968() == null)) { Fef4f813c($nCharSet); } } function F0cc8c968(){ return F160ffa8c(); } function Fef4f813c($s){ F2b624e31($s); } function ChangeNation($nNation) { $nNation = Fd1163413($nNation); $gclEnvLangue =& FMK_Langue_Alphabet(); $gclEnvLangue->nNation = $nNation; $gclEnvLangue->nLangue = F5bb5caf8($nNation); } function EnModeTest() { return ( (utf8_strpos( F78b7df27() , '127.0.0.1' )!==false) || (utf8_strpos( F78b7df27() , '::1' )!==false) ); } function DebutErreurAttendue() { F6b1e3687(); } function FinErreurAttendue() { F1e7b0563(); } function GetMessageErreurAttendue() { return F1abae4f0(); } function EstErreurAttendue() { return F977b2c2d(); } function EstErreurDetectee() { return F572d2e3e(); } function SetErreurDetectee($bEtat) { Fe7895f62($bEtat); } function ErreurInfo($nTypeInformation = errMessage) { $sMessageErreurInfo = F20e10363(); if (!EstErreurDetectee() || !is_object($sMessageErreurInfo)) { F67cfd262(); } $sRetour = $sMessageErreurInfo->Feda00d5c($nTypeInformation); if (strcmp($sRetour,'')===0) { if (defined('HF')) { $gclContextHF =& FMK_ContextHF(); if ($gclContextHF->bAnalyseChargee) { $sRetour = HErreurInfo(); } } } return $sRetour; } function F0a2f481f($nTypeInformation = errMessage) { $sMessageErreurInfo = F20e10363(); if (!EstErreurDetectee() || !is_object($sMessageErreurInfo)) F67cfd262(); $sRetour = $sMessageErreurInfo->Fa66b1dbb($nTypeInformation); if (defined('HF')&&(strcmp($sRetour,'')===0)) $sRetour = HErreurInfo(); return $sRetour; } function F67cfd262() { Fa19d34ae(); } function Fdd46bacf($sMessageErreur, $nTypeInformation = null) { F853b7085($sMessageErreur,$nTypeInformation); F4e2fbe05(); } function Fdd279d21($sMessageErreur,$nTypeInformation = null) { F3ccdac86($sMessageErreur,$nTypeInformation); F4e2fbe05(); } function F4e2fbe05() { $pclCtx =& FMK_Contexte(); if ($pclCtx->F3ecfb7c5('VM_NOTIF_ERREUR',true)) { Fcec078b5(); } } function F6339f211() { $pszGetNomFonction = ''; $fmkPile = new FMK_Exception_Pile(true,debug_backtrace()); $fmkPile->F74a027ca(); $fmkPile->F74a027ca(); while($fmkPile->F537feeb3() != '') { $sNomCTE = 'FCT_' . utf8_strtoupper( $fmkPile->F537feeb3() ); if ( defined($sNomCTE) ) { $pszGetNomFonction = constant($sNomCTE); break; } $fmkPile->Fa9342e22(); } return $pszGetNomFonction; } function F1795d655($pclObjetAPCodePage, $eTypeAttendu) { Fb22214f3($pclObjetAPCodePage, F83ff700b($eTypeAttendu)); } function Fb22214f3($pclObjetAPCodePage,$sNomTypeAttendu) { $sTypeNom = F3b9ec4ca($pclObjetAPCodePage); Fe81a7f9e('ERR_NOTA_GENERIQUE', F6339f211(), !is_object($pclObjetAPCodePage) ? VersChaine($pclObjetAPCodePage) : $pclObjetAPCodePage->GetNom(), $sTypeNom, $sNomTypeAttendu); } function Fb9eb0792() { $args = func_get_args(); $nNbArgs = func_num_args(); foreach ($args as $nIndice => $arg) { $args[$nIndice] = Fc34ec142($arg); } if (utf8_strpos($args[0],'%1')!==false) { if (utf8_strpos($args[0],'%' . ($nNbArgs ))!==false) { array_push($args,F6339f211()); } $sChaineConstruite = call_user_func_array('FMK_ChaineConstruit', $args); } else $sChaineConstruite = $args[0]; call_user_func_array('Erreur',array('ErreurGenerique',$sChaineConstruite)); $ret=null;return $ret; } function& Fe81a7f9e() { $args = func_get_args(); foreach ($args as $nIndice => $arg) { $args[$nIndice] = Fc34ec142($arg); } $sChaineConstruite = call_user_func_array('FMK_ChaineConstruit', $args); call_user_func_array('Erreur',array('ErreurGenerique',$sChaineConstruite)); $ret=null;return $ret; } function& getRef($param=null) { return $param; } function Fc34ec142($sNom) { return F1ac3f040($sNom); } function Page_ANY2STR( $Any ) { if (is_bool($Any)) return $Any ? '1' : '0'; return (is_float($Any) ? F617bf240($Any) : (string)$Any); } function F0f2ffe8c( $szNomPropriete ) { return F2080fcae($szNomPropriete, SETTER_PROPRIETE) ; } function Ff88f3cc3( $szNomPropriete ) { return F2080fcae($szNomPropriete, GETTER_PROPRIETE) ; } function Ffaaa0c13( $szNomPropriete ) { return F2080fcae($szNomPropriete, GETTER_PROPRIETE_HTML) ; } function WB_PageParametre($NomParam,$NomParamWL,$bObligatoire,$ValeurParDefaut='') { $bTrouve = false; $Valeur = F4e7f6fae($NomParam,$ValeurParDefaut,array(&$bTrouve)); if (!$bTrouve) $Valeur = F4e7f6fae($NomParamWL,$ValeurParDefaut,array(&$bTrouve)); if ($bObligatoire && !$bTrouve) { Fe81a7f9e('ERR_PAGEAFFICHE_PARAMETRE_NON_DEFINI',$NomParamWL,$NomParam); } return $Valeur; } function PageParametre( $NomParam, $ValeurParDefaut='' ) { return F4e7f6fae( $NomParam, $ValeurParDefaut ); } function F4e7f6fae( $NomParam, $ValeurParDefaut='', $tabInfo = null ) { if (isset($tabInfo) && isset($tabInfo[0])) $tabInfo[0] = true; $SCRIPT_PARAM = F19b65b78(); if (is_integer($NomParam)) { if ($NomParam === -1) { F6b1e3687(); $postData = file_get_contents('php://input'); F1e7b0563(); if (false !== $postData) { return $postData; } if (isset($HTTP_RAW_POST_DATA)) { return $HTTP_RAW_POST_DATA; } } else { $i = 0; foreach ($SCRIPT_PARAM as $szNom => $szValeur ) { ++$i; if ($i == $NomParam) return $szNom.'='.utf8_stripslashes(Fcab655af($szValeur,true)); } } if (isset($tabInfo) && isset($tabInfo[0])) $tabInfo[0] = false; return $ValeurParDefaut; } if (!isset($SCRIPT_PARAM[$NomParam])) { foreach ($SCRIPT_PARAM as $szNom => $szValeur ) { if (utf8_strtoupper($szNom) == utf8_strtoupper($NomParam)) return utf8_stripslashes(Fcab655af($szValeur,true)); } if (isset($tabInfo) && isset($tabInfo[0])) $tabInfo[0] = false; return $ValeurParDefaut; } return utf8_stripslashes(Fcab655af($SCRIPT_PARAM[$NomParam],true)); } function Feef890d7() { global $WB_bEnModeAJAX; return $WB_bEnModeAJAX; } function F3ecf4149($bModeAjax) { global $WB_bEnModeAJAX; $WB_bEnModeAJAX = $bModeAjax; } function ChaineConstruit() { $args= func_get_args(); return call_user_func_array('FMK_ChaineConstruit',$args); } function Trace( ) { $tabArgs = func_get_args(); $tabArgs = array_map('Page_ANY2STR',$tabArgs); $szString = utf8_implode(TAB,$tabArgs); $clContexte =& F4a1887ce(); if ( $clContexte->F239ddeda('TraceMode') & trDesactive ) return; if ( $clContexte->F239ddeda('TraceMode') & trFichier ) { $resFichier = F0a2479f9($clContexte->F239ddeda('TraceFichier'),foAjout+foCreationSiInexistant); Fa40bd700($resFichier,$szString); Fae814d9e($resFichier); if (!( $clContexte->F239ddeda('TraceMode') & trFenetre )) return; } if(!Feef890d7()) { $szString = utf8_str_replace( '<', '&lt;', $szString ); $szString = utf8_str_replace( '>', '&gt;', $szString ); } $szString = utf8_str_replace( "\r\n", '<\r><\n>', $szString ); $szString = utf8_str_replace( "\n\r", '<\r><\n>', $szString ); $szString = utf8_str_replace( "\r", '<\r>', $szString ); $szString = utf8_str_replace( "\n", '<\n>', $szString ); $szString = utf8_str_replace( "\t", ' ', $szString ); F01cd7827($szString); } function F01cd7827($szString) { $clContexte =& F4a1887ce(); if(Feef890d7()) { $sMessagePrecedent = $clContexte->F239ddeda('TraceMessage'); if ($sMessagePrecedent!='') { $sMessagePrecedent .= "\r\n"; } $clContexte->F4c8f9bd4('TraceMessage', $sMessagePrecedent . $szString ); Fea4f23e5($szString); } else { $sMessagePrecedent = $clContexte->F239ddeda('TraceMessage'); if ($sMessagePrecedent!='') { $sMessagePrecedent .= "\r\n"; } $clContexte->F4c8f9bd4('TraceMessage', $sMessagePrecedent . $szString ); } } function WB_AfficheInfo() { $clContexte =& F4a1887ce(); return (string)$clContexte->F8affbbd4('InfoMessage'); } function ChampExiste( $szNomChamp ) { global $MaPage; if (Fda9fdf77($MaPage->Nom,$szNomChamp,ccSansAccent+ccSansCasse)===0) return true; $szNom = GetNomChamp($szNomChamp); if (!isset($GLOBALS[$szNom]) ) { return false; } $clChamp =& $GLOBALS[$szNom]; if ( !is_object($clChamp) || !isset($clChamp->Alias) ) { return false; } return isset($MaPage->TabChamp[ $clChamp->Alias ] ); } function RechargementPageSiBesoin ($szNomPage) { $szAction = F542d1fd2(); $bRechargementForce = false; $clContexte =& FMK_Contexte(); $datePage = $clContexte->F239ddeda('WB_DATE_MAJ_' . WB_MAPAGE); $bRechargementForce = (!isset($datePage)) || (strcmp(utf8_substr($datePage,0,13),utf8_substr(WB_DATE_MAJ,0,13))!==0); if ($bRechargementForce || (utf8_strcasecmp($szAction, "INITPAGE") == 0)) { if ($bRechargementForce && $datePage!==null) { F9aacffd5($szNomPage); } else { Fe038c555($szNomPage); } } $clContexte->F4c8f9bd4('WB_DATE_MAJ_' .WB_MAPAGE,WB_DATE_MAJ); } function F542d1fd2($SCRIPT_PARAM = null) { if(!isset($SCRIPT_PARAM)) { $SCRIPT_PARAM = F19b65b78(); } if (isset($SCRIPT_PARAM["WD_ACTION_"]) && ($SCRIPT_PARAM["WD_ACTION_"] != "")) { $szAction = $SCRIPT_PARAM["WD_ACTION_"]; return $szAction; } return ""; } function Fe038c555( $szNomPage ) { $clContexte =& F4a1887ce(); $clContexte->Ff9d5e233($szNomPage); } function F9aacffd5() { $clContexte =& F4a1887ce(); $clContexte->RAZ(); } function GereActions(&$pclPage) { $SCRIPT_PARAM = F19b65b78(); if ( !UNICODE_PAGE_UTF8 && isset($_FILES)) { foreach (array_keys($_FILES) as $CleFichier) $_FILES[$CleFichier] = array_map('_cp1252_utf8_to_iso',$_FILES[$CleFichier]); } $sAction = F542d1fd2($SCRIPT_PARAM); if(isset($sAction) && !empty($sAction)) { if(F17a0f7d2($pclPage, $sAction)) { if (!$pclPage->bChampsAffectes) { ExecuteTraitement($pclPage->m_sNomPHP,TRT_ChaqueAffichagePagePHP,false); } return true; } FMK_Charge( 'WL/AJAX/Ajax.php' ,false); $pclPage->bDansGereActionsAjax = true; $bGereActionsAjax = (Faf10ef27($pclPage, $sAction, $SCRIPT_PARAM)); $pclPage->bDansGereActionsAjax = false; if($bGereActionsAjax) { if (!$pclPage->bChampsAffectes) { ExecuteTraitement($pclPage->m_sNomPHP,TRT_ChaqueAffichagePagePHP,false); } return true; } } else { Fbb9fbb5e($pclPage,$SCRIPT_PARAM); F61288fff($pclPage, $SCRIPT_PARAM); } if (!$pclPage->bChampsAffectes) { ExecuteTraitement($pclPage->m_sNomPHP,TRT_ChaqueAffichagePagePHP,false); } return false; } function Fbb9fbb5e(&$pclPage, $SCRIPT_PARAM) { if (array_key_exists('WD_BUTTON_CLICK_',$SCRIPT_PARAM) && array_key_exists($SCRIPT_PARAM['WD_BUTTON_CLICK_'] . '_JOUR',$SCRIPT_PARAM)) { return F94839a76($pclPage->TabChamp[$SCRIPT_PARAM['WD_BUTTON_CLICK_']]); } return false; } function F17a0f7d2(&$pclPage, $szAction = null) { if(!isset($szAction)) { $szAction = F542d1fd2(); } if (utf8_strcasecmp($szAction, "SCROLLTABLE") == 0) { $SCRIPT_PARAM = F19b65b78(); foreach (array_keys($SCRIPT_PARAM) as $Nom) { if (isset($pclPage->TabChamp[$Nom])) { $pclPage->TabChamp[$Nom]->F47301c2e($SCRIPT_PARAM[$Nom] + 0); } } return true; } $pos = utf8_strpos($szAction, "REGLETTE_"); if ($pos !== false && $pos==0) { $SCRIPT_PARAM = F19b65b78(); $sNomReglette = utf8_substr($szAction, 9); F61288fff($pclPage, $SCRIPT_PARAM); if (isset($pclPage->TabChamp[$sNomReglette])) { $Reglette = &$pclPage->TabChamp[$sNomReglette]; $sNomPCode = $Reglette->F960e3ffe(). TRT_clic_Page; if(!function_exists($sNomPCode))$sNomPCode = $Reglette->F960e3ffe()."CLICSER"; if(function_exists($sNomPCode)) { call_user_func_array($sNomPCode, array()); } $Reglette->F47301c2e($SCRIPT_PARAM[$sNomReglette] + 0); } return true; } $pos = utf8_strpos($szAction, "CLICTABLE"); if ($pos !== false && $pos==0) { $SCRIPT_PARAM = F19b65b78(); F61288fff($pclPage, $SCRIPT_PARAM); $Colonne =& $pclPage->TabChamp[$SCRIPT_PARAM['WD_BUTTON_CLICK_']]; if (isset($Colonne)) { $Table =& $GLOBALS[$Colonne->Table]; empileVM($pclPage->Nom,$Table->m_sNomPHP); $Table->F03b82a62($SCRIPT_PARAM[$Table->Alias]); $Table->Ff8a71d2b($Colonne,true); Ff094e78e(); } return true; } if (utf8_strpos($szAction ,'CALENDRIER')===0) { $SCRIPT_PARAM = F19b65b78(); $Champ =& $pclPage->TabChamp[$SCRIPT_PARAM['WD_BUTTON_CLICK_']]; if (F94839a76($Champ, $szAction)) { return true; } return false; } if (utf8_strpos($szAction ,'AGENDA')===0) { $SCRIPT_PARAM = F19b65b78(); $Champ =& $pclPage->TabChamp[$SCRIPT_PARAM['WD_BUTTON_CLICK_']]; if (Fbc7be080($pclPage, $Champ, $szAction, false, $SCRIPT_PARAM)) { return true; } return false; } if (utf8_strpos($szAction ,'UPLOAD')===0) { FMK_Charge( 'WL/AJAX/Ajax.php' ,false); F3ecf4149(true); global $WB_ContexteAjax; $WB_ContexteAjax = new FMK_ContexteAjax(); $SCRIPT_PARAM = F19b65b78(); $Champ =& $pclPage->TabChamp[$SCRIPT_PARAM['WD_BUTTON_CLICK_']]; switch ($szAction) { case 'UPLOADFICHIER': $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_UPLOAD_FICHIER); break; case 'UPLOADFICHIERFIN': $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_UPLOAD_FICHIERDERNIER); break; case 'UPLOADREVEIL': $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_UPLOAD_REVEIL); break; default: } return ($Etat == ACTION_WEB_RESULTAT_OK); } if (true===F61bc61eb($szAction,'CLICSMP')) { list($sAlias, $nIndice) = utf8_explode(';',utf8_substr($szAction,utf8_strpos($szAction,';')+1)); $Champ =& $pclPage->TabChamp[$sAlias]; if (isset($Champ)) { $Champ->Fdc05d49f($nIndice); } } return false; } function Fbc7be080(&$pclPage, &$Champ, $sActionPlanning, $bAjax, $SCRIPT_PARAM) { if (!isset($Champ->m_pclControleur)) return false; switch ($sActionPlanning) { case 'AGENDAPERAFF': F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_AGENDA_PERIODE_AFFICHE); break; case 'AGENDARDVAJO': F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_AGENDA_RDV_AJOUTE); break; case 'AGENDARDVDEP': F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_AGENDA_RDV_DEPLACEMENT); break; case 'AGENDARDVEDT': F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_AGENDA_RDV_EDITIONTITRE); break; case 'AGENDARDVRED': F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_AGENDA_RDV_REDIM); break; case 'AGENDARDVSUP': F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_AGENDA_RDV_SUPPRIME); break; case 'ENDETABLE': $nValeurLigneSelectionnee = $SCRIPT_PARAM[$Champ->Alias]; unset($SCRIPT_PARAM[$Champ->Alias]); F61288fff($pclPage, $SCRIPT_PARAM); F3ecf4149($bAjax); $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_TABLE_ENROULEDEROULE,$nValeurLigneSelectionnee); break; default: $Etat = ACTION_WEB_RESULTAT_ERREUR; } return($Etat === ACTION_WEB_RESULTAT_OK); } function F94839a76(&$Champ, $sActionCalendrier=null) { $Etat = null; $pclZRParent = null; $Champ->F6ce2b314($pclZRParent); $bEstLieZR = false; if (isset($pclZRParent)) { $tabAttributs = array_keys($pclZRParent->TabAttribut); $nOccurrence = count($tabAttributs); for($i=0; $i<$nOccurrence; $i++) { $pclAttribut =& $pclZRParent->TabAttribut[$tabAttributs[$i]]; if (($pclAttribut->m_sAliasChampLie == $Champ->Alias)) { $bEstLieZR = (utf8_strcasecmp($pclAttribut->m_sNomProprieteLiee,'Valeur')===0); break; } } } global $MaPage; if ($bEstLieZR) { F61288fff($MaPage); if (Feef890d7()) { global $WB_ContexteAjax; $WB_ContexteAjax->m_TabModifChamp[$pclZRParent->m_sNomPHP]->F3f4b73b8(true); } return true; } switch ( $sActionCalendrier ) { case 'CALENDRIERAUJO': $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_CALENDRIER_AUJOURDHUI); break; case 'CALENDRIERPREC': $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_CALENDRIER_MOISPREC); break; case 'CALENDRIERSUIV': $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_CALENDRIER_MOISSUIV); break; default: $Etat = $Champ->m_pclControleur->F0bf0c400(ACTION_WEB_PRINCIPALE); } if ($Etat == ACTION_WEB_RESULTAT_OK) { F61288fff($MaPage, F19b65b78()); return true; } return false; } function F61288fff( &$pclPage, $SCRIPT_PARAM = null) { if(!isset($SCRIPT_PARAM)) { $SCRIPT_PARAM = F19b65b78(); } global $_bContexteProjetExiste; if (XSS_VERIFIER_REFERER) { if ((isset($_SERVER['HTTP_REFERER'])) && (isset($_bContexteProjetExiste)) && ($_bContexteProjetExiste != false)) { $szReferrer = $_SERVER['HTTP_REFERER']; $tabTmp = parse_url($szReferrer); $sHttpHost = $_SERVER["HTTP_HOST"]; if (($nPosPort=utf8_strpos($sHttpHost,':'))!==false) { if ($tabTmp['port'] != utf8_substr($sHttpHost,$nPosPort+1)) { if (XSS_KILL) die('Le port doit tre identique, l' . __LINE__ . " " . ($_SERVER['HTTP_REFERER']) . " " . $_SERVER["HTTP_HOST"]); return; } $sHttpHost = utf8_substr($sHttpHost,0,$nPosPort); } if ($tabTmp['host'] != $sHttpHost) { if (XSS_KILL) die('L\'hte doit tre identique, l' . __LINE__ . " " . ($_SERVER['HTTP_REFERER']) . " " . $_SERVER["HTTP_HOST"]); return; } $szReferrer = $tabTmp['path']; $szReferrer = utf8_strtoupper($szReferrer); if (F0728da76($szReferrer,'/')) $szNomPage= 'INDEX'; else $szNomPage = basename($szReferrer, ".PHP"); global $_bContexteProjetExiste; if ((utf8_strlen($szNomPage) > 0) && ($szNomPage != utf8_strtoupper($pclPage->NomPhysique))) { if (in_array($szNomPage,array("DEFAULT","INDEX"))) { global $gszRepLangue; if (!$pclPage->m_bAccueil) { if (XSS_KILL) die("On vient d'une page d'accueil vers une autre page non accueil l" . __LINE__ . " " . ($_SERVER['HTTP_REFERER']) . " " . $_SERVER["HTTP_HOST"]); return; } } else { if (XSS_KILL) die("On vient d'une autre page que la page d'accueil, l" . __LINE__ . " " . ($_SERVER['HTTP_REFERER']) . " " . $_SERVER["HTTP_HOST"]); return; } } } } if (isset($_FILES)) { foreach (array_keys($_FILES) as $sAliasChampUpload) { if (isset($_FILES[$sAliasChampUpload]['name']) && ($_FILES[$sAliasChampUpload]['name']!='')) { $SCRIPT_PARAM[$sAliasChampUpload] = $_FILES[$sAliasChampUpload]['name'] . ';' . $_FILES[$sAliasChampUpload]['tmp_name']; } } } foreach (array_keys($SCRIPT_PARAM) as $Nom) { if ( substr($Nom, 0, 4) === 'zrl_' ) { $IndiceZR = (int)utf8_substr($Nom,4); if ( $IndiceZR > 0 ) { $NomAttributComplet = utf8_substr($Nom, 5 + utf8_strlen($IndiceZR) ); $NomAttribut = $NomAttributComplet; $NomZR = $pclPage->Fb6f2bea1( $NomAttribut ); if ($NomZR == "" && F0728da76($NomAttribut,'_DATA')) { $NomAttribut=utf8_substr($NomAttribut,0,utf8_strlen($NomAttribut)-5); $NomZR = $pclPage->Fb6f2bea1($NomAttribut); } if ($NomZR != "") { $NomAttribut = $pclPage->TabChamp[ $NomZR ]->Ffe0edf57($NomAttribut); $pclZR =& $pclPage->TabChamp[ $NomZR ]; $Attribut =& $pclZR->TabAttribut[$NomAttribut]; $pclChampLie =& $pclPage->TabChamp[ $Attribut->m_sAliasChampLie ]; if (isset($pclChampLie)) { if ($pclChampLie->GetType()===ID_RANGESLIDER) { if (F0728da76($NomAttributComplet, '_DATA')) { $tabValeurDATA = explode(',',$pclChampLie->Ff11ff472($SCRIPT_PARAM[$Nom])); foreach(array_keys($pclZR->TabAttribut) as $sNom) { $AttributCourant =& $pclZR->TabAttribut[$sNom]; $NomAttributCourant = $pclZR->Ffe0edf57($AttributCourant->sNom); if ($AttributCourant->m_sAliasChampLie !== $Attribut->m_sAliasChampLie) continue; if (utf8_strpos($AttributCourant->m_sNomProprieteLiee , Fd7624002('ValeurInfrieure'))===0) $pclPage->TabChamp[ $NomZR ]->F7d306d49($NomAttributCourant, $IndiceZR, $tabValeurDATA[0] ); if (utf8_strpos($AttributCourant->m_sNomProprieteLiee , Fd7624002('ValeurSuprieure'))===0) $pclPage->TabChamp[ $NomZR ]->F7d306d49($NomAttributCourant, $IndiceZR, $tabValeurDATA[1] ); } } } else { $pclPage->TabChamp[ $NomZR ]->F7d306d49($NomAttribut, $IndiceZR, $pclChampLie->Ff11ff472($SCRIPT_PARAM[$Nom]) ); } } else { $pclPage->TabChamp[ $NomZR ]->F7d306d49($NomAttribut, $IndiceZR, $SCRIPT_PARAM[$Nom] ); } } elseif (utf8_strpos($NomAttribut,'_MOIS')!==false) { $NomAttribut = utf8_substr($NomAttribut,0,utf8_strpos($NomAttribut,'_')); $NomZR = $pclPage->Fb6f2bea1( $NomAttribut ); $pclZR =& $pclPage->TabChamp[ $NomZR ]; if (isset($pclZR)) { $sNomAttributZR = $pclZR->TabAttributNomAlias[$NomAttribut]; $pclChampLie =& $pclPage->TabChamp[ $pclZR->TabAttribut[$sNomAttributZR]->m_sAliasChampLie ]; if (isset($pclChampLie)) { $sValeurAConsiderer = null; if (isset($SCRIPT_PARAM['CLICCALENDRIER']) || isset($SCRIPT_PARAM['ACTIONCHAMP'])) { switch ( isset($SCRIPT_PARAM['CLICCALENDRIER']) ? isset($SCRIPT_PARAM['CLICCALENDRIER']) : ($SCRIPT_PARAM['ACTIONCHAMP']) ) { case 'CALENDRIERPREC': case 'CALENDRIERSUIV': $sValeurAConsiderer = $SCRIPT_PARAM[$Nom]; break; case 'CALENDRIERAUJO': default: $sValeurAConsiderer = $SCRIPT_PARAM['zrl_' . $IndiceZR . '_' . $NomAttribut ]; } } else { if ( (isset($SCRIPT_PARAM['WD_BUTTON_CLICK_']) && ($SCRIPT_PARAM['WD_BUTTON_CLICK_'] == $pclChampLie->Alias)) && ($SCRIPT_PARAM[$pclZR->Alias] == $IndiceZR) ) { if (isset($SCRIPT_PARAM['WD_ACTION_'] )) { switch ( $SCRIPT_PARAM['WD_ACTION_'] ) { case 'CALENDRIERPREC': case 'CALENDRIERSUIV': $sValeurAConsiderer = $SCRIPT_PARAM[$Nom]; break; case 'CALENDRIERAUJO': default: $sValeurAConsiderer = $SCRIPT_PARAM['zrl_' . $IndiceZR . '_' . $NomAttribut ]; } } else { $sValeurAConsiderer = $SCRIPT_PARAM[$Nom]; } } else { $sValeurAConsiderer = $SCRIPT_PARAM[$Nom]; } } $pclZR->TabSauvegardeProp[$IndiceZR][$sNomAttributZR] = $pclChampLie->F8b6fb5ae($pclZR->TabAttribut[$sNomAttributZR]->m_sNomProprieteLiee,$sValeurAConsiderer,$IndiceZR,$sNomAttributZR); } } } } } if ( isset($pclPage->TabChamp[ $Nom ])) { $pclPage->TabChamp[ $Nom ]->Fdc05d49f( $SCRIPT_PARAM[$Nom] ); } elseif(false !== ($nPos_ = utf8_strpos($Nom,'_'))) { $sAliasChampSpecial = utf8_substr($Nom,0,$nPos_); if ( !isset($pclPage->TabChamp[ $sAliasChampSpecial ]) && F0728da76($Nom,'_DATA')) $sAliasChampSpecial = utf8_substr($Nom,0,utf8_strlen($Nom)-5); if ( isset($pclPage->TabChamp[ $sAliasChampSpecial ])) { $pclPage->Ffe9176c6($pclPage->TabChamp[ $sAliasChampSpecial ],$SCRIPT_PARAM[$Nom]); } } } $pclPage->bChampsAffectes = true; if ($pclPage->bDansGereActionsAjax) { $b=Feef890d7(); F3ecf4149(true); } ExecuteTraitement($pclPage->m_sNomPHP,TRT_ChaqueAffichagePagePHP,false); if ($pclPage->bDansGereActionsAjax) { F3ecf4149($b); } } function TrouveBouton( &$pclPage ) { if(Feef890d7()) { return F742091de(); } $bUniquementBoutonSeul = false; global $_bContexteProjetExiste; if ((isset($_bContexteProjetExiste)) && ($_bContexteProjetExiste != false)) { $pclContexte =& F4a1887ce(); if ($pclContexte->F1a1d6423('WD_BUTTON_CLICK_')) { $sNomEtTrtduChamp = $pclContexte->F239ddeda('WD_BUTTON_CLICK_'); $pclContexte->Ff9d5e233('WD_BUTTON_CLICK_'); ExecuteTraitement(utf8_substr($sNomEtTrtduChamp,0,$nPosSep=utf8_strpos($sNomEtTrtduChamp,TAB)),utf8_substr($sNomEtTrtduChamp,$nPosSep+1)); return null; } if ((isset($_SERVER['HTTP_REFERER']))) { $szReferrer = $_SERVER['HTTP_REFERER']; $tabTmp = parse_url($szReferrer); $szReferrer = $tabTmp['path']; $szReferrer = utf8_strtoupper($szReferrer); $szNomPage = basename($szReferrer, ".PHP"); if ( ($szNomPage == basename($szReferrer)) || in_array($szNomPage,array("DEFAULT","INDEX")) ) { $szNomPage = utf8_strtoupper($pclPage->NomPhysique); } global $_bContexteProjetExiste; if ((utf8_strlen($szNomPage) > 0) && ($szNomPage != utf8_strtoupper(F828b8ca2($pclPage->NomPhysique)))) { $bUniquementBoutonSeul = true; } } } $SCRIPT_PARAM = F19b65b78(); if (isset($SCRIPT_PARAM['WD_ACTION_'])) { if ( (isset($SCRIPT_PARAM['ID']) && ($SCRIPT_PARAM['WD_ACTION_']=='MENU')) || (isset($SCRIPT_PARAM['WD_BUTTON_CLICK_']) && ($SCRIPT_PARAM['WD_ACTION_']=='MENU_SUBMIT'))) { $sAliasOption = (isset($SCRIPT_PARAM['ID'])) ? $SCRIPT_PARAM['ID'] : $SCRIPT_PARAM['WD_BUTTON_CLICK_']; if (isset($pclPage->TabChamp[$sAliasOption]) && $pclPage->TabChamp[$sAliasOption]->F60786b1e()) { $pclPage->TabChamp[$sAliasOption]->Fc1a6d5f6(trtClic); } else { return $sAliasOption; } } elseif (true===F61bc61eb($SCRIPT_PARAM['WD_ACTION_'],'CLICSMP')) { $Champ =& $pclPage->TabChamp[utf8_substr($SCRIPT_PARAM['WD_ACTION_'],8,utf8_strpos($SCRIPT_PARAM['WD_ACTION_'],';',8)-8)]; if (isset($Champ)) { $Champ->Fc1a6d5f6(trtClic); } } } if ($bUniquementBoutonSeul == false) { if ( isset($SCRIPT_PARAM["WD_BUTTON_CLICK_"]) && ($SCRIPT_PARAM["WD_BUTTON_CLICK_"] != "") ) { return $SCRIPT_PARAM["WD_BUTTON_CLICK_"]; } } foreach ($SCRIPT_PARAM as $Nom => $Valeur ) { if ( isset($pclPage->TabChamp[ $Nom ]->EstBouton) ) { if (($bUniquementBoutonSeul == false) || ((is_string($Valeur) != false) && (utf8_strlen($Valeur) == 0))) { return $Nom; } } } foreach ($SCRIPT_PARAM as $Nom => $Valeur ) { foreach ($pclPage->TabChamp as $AliasChamp => $pclChamp ) { if (is_object($pclChamp)) if ( ($pclChamp->Nom == $Nom) && isset($pclChamp->EstBouton) ) { if (($bUniquementBoutonSeul == false) || ((is_string($Valeur) != false) && (utf8_strlen($Valeur) == 0))) { return $AliasChamp; } } } } if (isset($SCRIPT_PARAM['ISMAP'])) { $sAliasImage = utf8_substr($SCRIPT_PARAM['ISMAP'],0,utf8_strpos($SCRIPT_PARAM['ISMAP'],'?')); return $sAliasImage; } return null; } function F42d47045(&$pclChamp,$bAvecBalise=true) { return ($bAvecBalise ? ('<PROP NUM="' . PROP_INVALID_MIN . '">') : '') . cTABL_JSON_O . F5192ea98($pclChamp->pszGetChampParametresHTML()) . cSEPARATEUR_JSON_O . F5192ea98($pclChamp->pszGetChampDonneesHTML()) . cTABL_JSON_F . ($bAvecBalise ? ('</PROP>') : ''); } function bRenvoitCodeHTML(&$pclPage, $bSauveContexte) { $bSauveContextePage = (isset($GLOBALS['bSauveContexte'])) ? $GLOBALS['bSauveContexte'] : $bSauveContexte; if(Feef890d7()) { global $WB_ContexteAjax; if(isset($WB_ContexteAjax)) { $WB_ContexteAjax->F99c63beb($pclPage->bUTF8); } if ($bSauveContexte) { F4d351a8f($pclPage,$bSauveContextePage); } return false; } if ($bSauveContexte) { F4d351a8f($pclPage,$bSauveContextePage); } global $gbFinRequete; if(isset($gbFinRequete)) { $autoappend=ini_get("auto_append_file"); if ((!empty($autoappend))&&(file_exists($autoappend))) include($autoappend); return false; } $sTraceMessage = Ff11192e9(); if (isset($sTraceMessage)) { echo $sTraceMessage; } return true; } function F4d351a8f( &$Page, $bSauvePageAussi=true ) { global $MonProjet; $clContexte =& F4a1887ce(); if ($bSauvePageAussi) { $Page->F4d351a8f(); $clContexte->F4c8f9bd4($Page->m_sNomPHP , $Page); } if (isset( $MonProjet)) { $MonProjet->F4d351a8f(); $clContexte->F4c8f9bd4(VM_MONPROJET, $MonProjet); } } function GetSessionVar() { $clContexte =& F4a1887ce(); $AutoInclude = $clContexte->F239ddeda('__AUTO__INCLUDE__'); $bRechargerNecessaire = false; if (isset($AutoInclude)) { foreach (array_keys($AutoInclude) as $sNomDependanceType) { if (TYPE_Include($sNomDependanceType) !== -1) { $bRechargerNecessaire=true; } } } if ($bRechargerNecessaire) $clContexte->F25b1e96a(); return $clContexte->Fcb77bf46(); } function F962be4d3() { global $gbFinRequete; $gbFinRequete = true; } function F6e3689dc( $Url, $MoreHeader = "", $bRedirectionPermanente = false ) { global $gbFinRequete; if(isset($gbFinRequete)) return; $sSessionName = ini_get('session.name'); if (!isset($_COOKIE[$sSessionName])) { global $MaPage; if (isset($MaPage) && $MaPage->bAvecContexte) { $sParamSessionAvecValeur = $sSessionName.'='.session_id(); if ($MoreHeader === '') { $MoreHeader = $sParamSessionAvecValeur; } else { $MoreHeader .= '&' . $sParamSessionAvecValeur; } } } if(Feef890d7()) { Ffbcbe502( $Url, $MoreHeader); } else { if ($MoreHeader != "") { $Url .= '?'.$MoreHeader; } if ($bRedirectionPermanente) header('HTTP/1.0 301 Moved Permanently',false,301); header('Location: '.utf8_str_replace(' ','%20',$Url) ); } F962be4d3(); } function ConvertirCouleur_HTML($dwCouleur) { return F5bfcd185($dwCouleur); } function NameSpace_definirLocal($sNom, $Valeur = true) { if (!isset($GLOBALS['__WB_SCOPE_MANAGER__'])) $GLOBALS['__WB_SCOPE_MANAGER__'] = array(); $GLOBALS['__WB_SCOPE_MANAGER__'][$sNom] = $Valeur; } function F7112dc57($sNom = null) { if (!isset($GLOBALS['__WB_SCOPE_MANAGER__'])) return; if (isset($sNom)&&isset($GLOBALS['__WB_SCOPE_MANAGER__'][$sNom])) unset($GLOBALS['__WB_SCOPE_MANAGER__'][$sNom]); else unset($GLOBALS['__WB_SCOPE_MANAGER__']); } function F10625e0f($sNom, $Valeur = true) { return ( (isset($GLOBALS['__WB_SCOPE_MANAGER__'])) && (isset($GLOBALS['__WB_SCOPE_MANAGER__'][$sNom])) && ($GLOBALS['__WB_SCOPE_MANAGER__'][$sNom]==$Valeur) ); } function Fd057c510( &$pclChamp, $ePropriete) { if (isset($pclChamp)) { $pclPage =& $pclChamp->F87d9a981(); if ((isset($pclPage)) && ($pclPage->Fba0bee0f() != false)) { $stModifProprieteAJAX = new stMODIFPROPRIETEAJAX($ePropriete); $pclPage->Ff4e94fc7($pclChamp, $stModifProprieteAJAX); } } } function ExecuteTraitement($NomObjet,$Traitement,$bErreurSiNonTrouve=true,$bSansAppeler=false) { if ($Traitement == trtProcedure) { $sNomAppel = Fb4985004($NomObjet); } else { $sNomAppel = GetNomChamp($NomObjet); } $sNomAppel = VersChaine($sNomAppel); $nPosSepPageObjet = utf8_strpos($sNomAppel,SepPageObjet); if ($nPosSepPageObjet !== false) { $sNomPage = utf8_substr($sNomAppel,0,$nPosSepPageObjet); if ( (utf8_strcasecmp($sNomPage , $GLOBALS['MaPage']->Nom)!==0) && file_exists(F9486bf1a($sNomPage).'.php') ) { $sNomWL = utf8_substr($sNomAppel,utf8_strlen($sNomPage)+1); $pclContexte =& F4a1887ce(); $pclContexte->F4c8f9bd4('WD_BUTTON_CLICK_',$sNomWL . TAB . $Traitement); F6e3689dc($sNomPage.'.php'); return null; } } $nPcodeAvecParamParRef = -1; $Arg = func_get_args(); $tabParams = array_slice($Arg,4); $sNomAppelBase = $sNomAppel; $trtPage = $Traitement; switch($Traitement) { case TRT_1erAffichagePage: $sNomAppel .= 'PREMAFF'; break; case TRT_ChaqueAffichagePagePHP: $sNomAppel .= 'CHAQUEAFFPAGE'; break; case trtInit: global $MaPage; if (utf8_strcasecmp($MaPage->Nom,$sNomAppel)===0) { $sNomAppel .= 'FINIT'; $trtPage = TRT_finitialisation_Page; } else { $sNomAppel .= 'INIT'; $trtPage = TRT_initialisation_Page; } break; case trtClic: $sNomAppel .= 'CLICSER'; $trtPage = TRT_clic_Page; break; case TRT_SelectionJour: $sNomAppel .= 'MODIFJOUR'; break; case TRT_AffichageMois: $sNomAppel .= 'AFFMOIS'; break; case TRT_ClicBoutonCalendrier: $sNomAppel .= 'SELTODAY'; break; case TRT_ChangementMois: $sNomAppel .= 'CLICMOIS'; break; case trtAffichageLigne: $sNomAppel .= 'AFFL'; $trtPage = TRT_affichageligne_Page; break; case TRT_Filtre_Page: $sNomAppel .= 'FILTREPAGE'; break; case WLTRT_Modification: case TRT_modification_Serveur: $sNomAppel .= 'MODSER'; $trtPage = TRT_modification_Serveur; break; case trtOptionMenu: { $pclOption =& F9abbf335($sNomAppel); if (isset($pclOption) && $pclOption->F70cea20e() && ($pclOption->GetType() === ntypOPTIONMENU) && $pclOption->F60786b1e() ) { return $pclOption->Fc1a6d5f6(trtClic,$tabParams); } else { $sNomAppel .= 'CLICMENU'; $trtPage = TRT_optionmenu_Page; } } break; case TRT_UploadFichier: $sNomAppel .= 'UPLOADFIC'; break; case TRT_DeplacementRdvAgenda: $nPcodeAvecParamParRef = 1; $sNomAppel .= 'DEPLACEEVENTAGENDA'; break; case TRT_RedimRdvAgenda: $nPcodeAvecParamParRef = 1; $sNomAppel .= 'REDIMEVENTAGENDA'; break; case TRT_SupprimeRdvAgenda: $nPcodeAvecParamParRef = 1; $sNomAppel .= 'SUPPREVENEMENTAGENDA'; break; case TRT_AjouteRdvAgenda: $nPcodeAvecParamParRef = 1; $sNomAppel .= 'AVANTCREATIONEVENEMENTAGENDA'; break; case TRT_ModifTitreRdvAgenda: $nPcodeAvecParamParRef = 1; $sNomAppel .= 'SORTIESAISIEEVENEMENTAGENDA'; break; case TRT_AffichagePeriodeAgenda: $nPcodeAvecParamParRef = 0; $sNomAppel .= 'AFFICHEPERIODEAGENDA'; break; case TRT_DeplacementRessourceRdvPlanning: $nPcodeAvecParamParRef = 1; $sNomAppel .= 'DEPLACEMENTRDVRESSOURCE'; break; case trtSelection: $bErreur=false; $pclChamp =& F9abbf335($sNomAppel,IND_CHAMP,array('ERR'=>&$bErreur)); if (!$bErreur && $pclChamp->GetType() == ID_CALENDRIER) { $sNomAppel .= 'MODIFJOUR'; $trtPage = TRT_SelectionJour; } else { $sNomAppel .= 'SELECTION'; $trtPage = TRT_selection_Page; } break; default: } if ( (function_exists($sNomAppelBase . $trtPage)) ||(function_exists(($sNomAppelBase=F03771b65($sNomAppelBase)) . $trtPage)) ) { $sNomAppel = $sNomAppelBase . $trtPage; } else { if (!function_exists($sNomAppel)) { $sNomAppel = F03771b65($sNomAppel); } if (!function_exists($sNomAppel)) { if (!$bErreurSiNonTrouve) { return false; } if ($Traitement==trtProcedure) { Fe81a7f9e('ERR_PROCEDURE_INCONNUE',$sNomAppel); } else { Fe81a7f9e('ERR_PCODE_CHAMP',Fac06269c($sNomAppel)); } } } if ($bSansAppeler) return true; switch ($nPcodeAvecParamParRef) { case 0: return $sNomAppel(); case 1: return $sNomAppel($tabParams[0]); case -1: return call_user_func_array($sNomAppel,$tabParams); default: return null; } } function Fac06269c($sNomPHP) { $sNomPHPMAJ = utf8_strtoupper($sNomPHP); while (utf8_substr($sNomPHPMAJ,utf8_strlen($sNomPHPMAJ)-2,1) === '_') $sNomPHPMAJ = utf8_substr($sNomPHPMAJ,0,utf8_strlen($sNomPHPMAJ)-2); $sNomPHP = utf8_substr($sNomPHP,0,utf8_strlen($sNomPHPMAJ)); if (empty($sNomPHP)) return $sNomPHP; $sMessage=$sSuffix=''; if ( F0728da76($sNomPHPMAJ, $sSuffix="INIT")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_initialisation_Page) ) { $sMessage = 'MSG_PCODE_INIT'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="CLICSER")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_clic_Page) ) { $sMessage = 'MSG_PCODE_CLIC'; } else if ( ( F0728da76($sNomPHPMAJ, $sSuffix="MODIFJOUR")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_SelectionJour) ) || ( F0728da76($sNomPHPMAJ, $sSuffix="SELECTION")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_selection_Page) ) ){ $sMessage = 'MSG_PCODE_SELECTION'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="AFFMOIS")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_AffichageMois) ) { $sMessage = 'MSG_PCODE_AFFICHAGE'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="AFFL")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_affichageligne_Page) ) { $sMessage = 'MSG_PCODE_AFFL'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="FILTREPAGE")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_Filtre_Page) ) { $sMessage = 'MSG_PCODE_FILTREPAGE'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="OPEN")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_ouverture) ) { $sMessage = 'MSG_PCODE_DECL'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="CHAQUEAFFPAGE")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_ChaqueAffichagePagePHP) ) { $sMessage = 'MSG_PCODE_CHAQUEAFFPAGE'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="EVAL")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_SetValeur_Page) ) { $sMessage = 'MSG_PCODE_EVAL'; } else if ( F0728da76($sNomPHPMAJ, $sSuffix="LVAL")||F0728da76($sNomPHPMAJ, $sSuffix=TRT_GetValeur_Page) ) { $sMessage = 'MSG_PCODE_LVAL'; } else { $pclVM =& obtenirVM(); foreach ($pclVM->m_tabProcedures as $sNomWL => $tabInfoProcPHP) { if (utf8_strcasecmp($tabInfoProcPHP[VM_NOM_PHP],$sNomPHPMAJ)===0) { return $sNomWL; } } } return (empty($sMessage)) ? $sNomPHP : FMK_ChaineConstruit(Fc34ec142($sMessage),F211b7277(utf8_substr($sNomPHP,0,utf8_strlen($sNomPHP)-strlen($sSuffix)))); } function F211b7277($sNomPHP) { $clChamp = F9abbf335($sNomPHP,IND_CHAMP); if (!isset($clChamp)||empty($clChamp->m_sNomWL)) return $sNomPHP; return $clChamp->m_sNomWL; } function F3d2e5bce(&$var) { if (is_object($var) && is_callable(array($var,'Destructeur'))) { $var->Destructeur(); } unset($var); } function F1c7c7cae($objetTable) { return ( ( is_object($objetTable)) && ( is_callable(array($objetTable,'GetType'))) && ( $objetTable->F70cea20e() ) && ( ($objetTable->GetType() == TYPE_CHAMP_TABLE) || ($objetTable->GetType() == ID_TABLEHIERARCHIQUE) ) && ( isset($objetTable->TabColonnes)) ); } function Fa966307f($objetListe) { return ( ( is_object($objetListe)) && ( is_callable(array($objetListe,'GetType'))) && ( $objetListe->F70cea20e() ) && ( ( $objetListe->GetType() == TYPE_CHAMP_LISTE) || ( $objetListe->GetType() == TYPE_CHAMP_COMBO) ) ); } function Fba68c6f1($objetTable) { return ( ( is_object($objetTable)) && ( is_callable(array($objetTable,'GetType'))) && ( $objetTable->F70cea20e() ) && ( ( $objetTable->GetType() == TYPE_CHAMP_ZR) || ( $objetTable->GetType() == TYPE_CHAMP_ZRLINEAIRE) ) ); } function& F617bf240( $sValeur, $nChiffresPartieEntiere = null, $nChiffresPartieDecimale = null) { if ( strpos($sValeur,'E') === false) { $sRetour = (string)$sValeur; } else { $sApresVirgule = ''; if ( strpos($sValeur,'.') !== false) { $sApresVirgule = substr($sValeur,strpos($sValeur,'.')+1,strpos($sValeur,'E')-1-strpos($sValeur,'.')); if ((empty($sApresVirgule))) $sApresVirgule = ''; $sAvantVirgule = substr($sValeur,0,strpos($sValeur,'.')); } else { $sAvantVirgule = substr($sValeur,0,strpos($sValeur,'E')); $sApresVirgule = ''; } $nPuissance = intval(substr($sValeur,strpos($sValeur,'E')+1)); if ($nPuissance>0) { $sApresVirgule = str_pad($sApresVirgule,$nPuissance,'0'); $sRetour = $sAvantVirgule . $sApresVirgule; } else { $sRetour = '0.' . str_pad($sAvantVirgule,abs($nPuissance),'0',STR_PAD_LEFT) . $sApresVirgule; } } if ($nChiffresPartieEntiere!==null) { $bDecimauxSelonReste = ($nChiffresPartieDecimale === null); $sValeurChaine = $sRetour; $bNegatif = false; if (0===strpos($sValeurChaine,'-')) { $bNegatif = true; $sValeurChaine = substr($sValeurChaine,1); } $nPosPoint = strpos($sValeurChaine,'.'); $nTaille = strlen($sValeurChaine); $sValeurFinale = ''; if ($nPosPoint===false) { $nChiffresPartieEntiere = ($nChiffresPartieEntiere>0) ? $nChiffresPartieEntiere : min(14,$nTaille); $nTailleChoisie = min($nTaille,$nChiffresPartieEntiere); $sValeurFinale = str_pad( (isset($sValeurChaine[$nTailleChoisie]) && ($nTailleChoisie<14)) ? (string)round(substr($sValeurChaine,0,$nTailleChoisie) . '.' . $sValeurChaine[$nTailleChoisie],0) : substr($sValeurChaine,0,$nTailleChoisie) ,$nTaille,'0',STR_PAD_RIGHT); } else { $nChiffresPartieEntiere = ($nChiffresPartieEntiere>0) ? min(14,$nChiffresPartieEntiere) : min(14,$nPosPoint); $nChiffresPartieDecimale = ($nChiffresPartieDecimale!==null) ? min(14,$nChiffresPartieDecimale) : null; $nTailleChoisie = min($nPosPoint,$nChiffresPartieEntiere); $sValeurFinale = str_pad( (isset($sValeurChaine[$nTailleChoisie]) && ($nTailleChoisie<14)) ? (string)round(substr($sValeurChaine,0,$nTailleChoisie) . '.' . $sValeurChaine[$nTailleChoisie],0) : substr($sValeurChaine,0,$nTailleChoisie) ,$nPosPoint,'0',STR_PAD_RIGHT); if ($bDecimauxSelonReste) { $nMin = $nChiffresPartieEntiere-$nTailleChoisie; } elseif ($nChiffresPartieDecimale===null) { $nMin = 14-$nTailleChoisie; } else { $nMin = $nChiffresPartieDecimale; } $nTailleChoisie = min($nTaille-$nPosPoint-1,$nMin); if ($sValeurFinale == '0') { if (isset($sValeurChaine[$nTailleChoisie+$nPosPoint+1])&&is_numeric($sValeurChaine[$nTailleChoisie+$nPosPoint+1])) ++$nTailleChoisie; } if($nTailleChoisie>0) { $sPartieDecimale = (isset($sValeurChaine[$nTailleChoisie+$nPosPoint+1])) ? substr((string)round('0.' . substr($sValeurChaine,$nPosPoint+1,$nTailleChoisie) . $sValeurChaine[$nTailleChoisie+$nPosPoint+1],$nTailleChoisie),2) : substr($sValeurChaine,$nPosPoint+1,$nTailleChoisie) ; if (!empty($sPartieDecimale)) { $sValeurFinale.= '.' .$sPartieDecimale; } } } $sRetour = $sValeurFinale; if ($bNegatif) $sRetour = '-'.$sRetour; } return $sRetour; } function Fbb2cb049($clJSON,&$pclDino) { $tabMembres = get_class_vars(get_class($pclDino)); foreach (array_keys($tabMembres) as $sNomMembre) { if ( isset($clJSON->$sNomMembre)) { if (is_object($pclDino->$sNomMembre)) { Fbb2cb049($clJSON->$sNomMembre,$pclDino->$sNomMembre); } else { $pclDino->$sNomMembre = $clJSON->$sNomMembre; } } } } function& F7b3eb9c8($sJSON) { $sNomDino = substr($sJSON,0,($nPosSep =strpos($sJSON,'|'))); return Fa3308798($sJSON,$sNomDino); } function& Fa3308798($sJSON,$sNomDino) { $clJSON = is_object($sJSON) ? $sJSON : json_decode($sJSON); switch($sNomDino) { case 'MARQUEUR': FMK_Charge('IHM/Champ/ChampVideo.php',false); $pclDino = new CDinoMarqueur(); $pclPosition =& $pclDino->m_clPosition; if (isset($clJSON->m_dLatitude)) $pclPosition->SetLatitude($clJSON->m_dLatitude); if (isset($clJSON->m_dLongitude)) $pclPosition->SetLongitude($clJSON->m_dLongitude); break; default: Fa79fbf41('dino non gr dans les procs ajax'); return null; } Fbb2cb049($clJSON,$pclDino); return $pclDino; } ?>