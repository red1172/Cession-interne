<?php
//20.0.56.0 IHM/Champ/Reglette.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__IHM/Champ/Champ.php')) { define('__INC__IHM/Champ/Champ.php',true); include_once(WB_INCLUDE_PATH.'WD7c939e6867492a5e5416bd4b4327fac0.php'); } if (!defined('__INC__IHM/Champ/Liste/Table/Table.php')) { define('__INC__IHM/Champ/Liste/Table/Table.php',true); include_once(WB_INCLUDE_PATH.'WDd4feee5389953c66852265e2f26ba4a3.php'); } if (!defined('__INC__IHM/Champ/Liste/ZoneRepetee/ZoneRepetee.php')) { define('__INC__IHM/Champ/Liste/ZoneRepetee/ZoneRepetee.php',true); include_once(WB_INCLUDE_PATH.'WDc8ebf9c835db84fcef0c84d5d914806f.php'); } class CReglette extends CChamp { var $sNomChampAssocie; var $nSelectedItem; var $bSubmit = false; var $bRegletteAjax = false; var $bClicSurRegletteEnCours = false; var $m_tabPartieStyle; var $m_ATTREGLETTE_INVISIBLESIVIDE_WEB = true; var $m_ATTREGLETTE_LIBELLEPREMIER_WEB='<<'; var $m_ATTREGLETTE_LIBELLEPRECEDENT_WEB='<'; var $m_ATTREGLETTE_LIBELLESUIVANT_WEB='>'; var $m_ATTREGLETTE_LIBELLEDERNIER_WEB='>>'; var $m_ATTREGLETTE_MASQUELIEN_WEB; var $m_ATTREGLETTE_MODEAFFICHAGE_WEB; var $m_ATTREGLETTE_NBMAXLIEN_WEB = 11; var $m_ATTREGLETTE_SEPARATEURINDICE_WEB=' '; var $m_ATTREGLETTE_SEPARATEURBOUTON_WEB=' '; var $ChampFormat = null; function CReglette($bSubmit=false, $bAjax=false) { parent::CChamp(); $this->sNomChampAssocie = ""; $this->nSelectedItem = 0; $this->bSubmit = $bSubmit; $this->bRegletteAjax = $bAjax; $this->m_tabPartieStyle = array(); $this->m_ATTREGLETTE_MODEAFFICHAGE_WEB = 0; $this->m_ATTREGLETTE_MASQUELIEN_WEB = MASQUE_NUMERIQUE; $this->ChampFormat = new CSaisieNumerique(); } function& GetCadrageHorizontal() { Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_CADRAGEHORIZONTAL"),F3b9ec4ca($this)); return RetourErreur_Entier; } function SetCadrageHorizontal($nCadrageHorizontal) { Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_CADRAGEHORIZONTAL"),F3b9ec4ca($this)); } function& GetBulle() { Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_BULLE"),F3b9ec4ca($this)); return RetourErreur_Entier; } function SetBulle($sBulle) { Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_BULLE"),F3b9ec4ca($this)); } function F0a9e4245() { return $this->bSubmit; } function SetChampAssocie($sNomChamp) { global $MaPage; $this->sNomChampAssocie = $sNomChamp; $Champ =& $MaPage->F1cbb0dd2($sNomChamp); if(isset($Champ)) { $this->sNomChampAssocie = $Champ->m_sNomPHP; $Champ->Reglette = &$this; } } function Fa3138986() { if(!empty($this->sNomChampAssocie)) { $Champ =& F9abbf335(GetNomChamp($this->sNomChampAssocie),IND_CHAMP); if (isset($Champ)) { if ($Champ->F7b66f7f8() >= 1) { return ceil($Champ->F1ac18ca4() / $Champ->F56a8269c()); } } } return 0; } function Fd44413e3() { if($this->nSelectedItem == 0) { return 0; } if($this->nSelectedItem < intval($this->m_ATTREGLETTE_NBMAXLIEN_WEB/2)) { return 1; } else { $nRestantApres = $this->Fa3138986() - $this->nSelectedItem; $nDecalage = intval($this->m_ATTREGLETTE_NBMAXLIEN_WEB/2); if($nRestantApres < $nDecalage) { $nDecalage += ($nDecalage-$nRestantApres); } return max(1,$this->nSelectedItem - $nDecalage); } } function F4adc3716($nElement) { if(!empty($this->sNomChampAssocie)) { $Champ =& F9abbf335(GetNomChamp($this->sNomChampAssocie ),IND_CHAMP); $nMax = $Champ->F56a8269c(); $nPage = (($nElement - $nElement%$nMax) / $nMax); return $nPage; } return 0; } function F09b9e03d() { if($this->nSelectedItem == 0) { return 0; } return min($this->Fd44413e3() + $this->m_ATTREGLETTE_NBMAXLIEN_WEB-1, $this->Fa3138986()); } function F47301c2e($nItem) { if ($nItem <=0) $nItem = 1; $this->nSelectedItem = $nItem; if(!empty($this->sNomChampAssocie)) { $Champ =& F9abbf335(GetNomChamp($this->sNomChampAssocie ),IND_CHAMP); if (isset($Champ)) { $Champ->SetFirstIndex(($this->nSelectedItem - 1) * $Champ->F56a8269c()); if(Feef890d7()) { if($Champ->GetType() == TYPE_CHAMP_TABLE) { F9402f437($Champ->GetNom(), $Champ); } else { F055fb2fe($Champ->GetNom(), $Champ); } $Champ->F8723e249($Champ->GetFirstIndex() + 1); } } } } function F1ce8f6aa() { $Champ =& F9abbf335(GetNomChamp($this->sNomChampAssocie),IND_CHAMP); $Champ->Reglette = &$this; return $this->nSelectedItem; } function F27083b0f() { if($this->Fb19c91cc()) { $this->F47301c2e($this->nSelectedItem + 1); } } function Fb7f6538b() { if($this->Fd6de9dad()) { $this->F47301c2e($this->nSelectedItem - 1); } } function FirstItem() { $this->F47301c2e(1); } function F9fd92c7d() { $this->F47301c2e($this->Fa3138986()); } function Fd6de9dad() { return $this->nSelectedItem > 1; } function Fb19c91cc() { return $this->nSelectedItem > 0 && $this->nSelectedItem < $this->Fa3138986(); } function& GetType() { return getRef(21); } function& GetValeurAffichee() { if ($this->F1ce8f6aa() > $this->F09b9e03d()) $this->F9fd92c7d(); $szHTMLGenere = ''; if($this->bSubmit) { global $MaPage; $szHTMLGenere = utf8_sprintf("<INPUT TYPE=HIDDEN NAME=%1\$s VALUE=''><SCRIPT>function _R%1\$s(n){if (_%2\$s_SUB(null)){ _PAGE_.WD_ACTION_.value='REGLETTE_".$this->GetAlias()."';_PAGE_.%1\$s.value=n;_PAGE_.submit()}}</SCRIPT>", $this->Alias,$MaPage->F960e3ffe()); } if ($this->F09b9e03d() == 1 && $this->m_ATTREGLETTE_INVISIBLESIVIDE_WEB) { return $szHTMLGenere; } $bHasPrevious = $this->Fd6de9dad(); if ($bHasPrevious || $this->m_ATTREGLETTE_MODEAFFICHAGE_WEB==0) { $szHTMLGenere .= $this->F4d3c7029($this->m_ATTREGLETTE_LIBELLEPREMIER_WEB, 1, $bHasPrevious,'premier',$this->F1d48e000(4),$this->F1d48e000(8),null); } if ($bHasPrevious || $this->m_ATTREGLETTE_MODEAFFICHAGE_WEB<=2) { $szHTMLGenere .= $this->F4d3c7029($this->m_ATTREGLETTE_LIBELLEPRECEDENT_WEB, $this->F1ce8f6aa() - 1, $bHasPrevious,'precedent',$this->F1d48e000(2),$this->F1d48e000(9),($szHTMLGenere=='') ? null : $this->m_ATTREGLETTE_SEPARATEURBOUTON_WEB); } $bPremierIndice = true; for ($i = $this->Fd44413e3(); $i <= $this->F09b9e03d(); $i++) { $this->ChampFormat->Valeur = $i; $sIndice = $this->ChampFormat->GetValeurAffichee(); $nSelectedItem = $this->F1ce8f6aa(); $bEstCourant = ($i == $nSelectedItem); $sSeparateur = $this->m_ATTREGLETTE_SEPARATEURINDICE_WEB; if ($bPremierIndice) { if ($szHTMLGenere=='') { $sSeparateur=null; } else { $sSeparateur = $this->m_ATTREGLETTE_SEPARATEURBOUTON_WEB; } } $szHTMLGenere .= $this->F4d3c7029($sIndice, $i, !$bEstCourant,'indice' ,$this->F1d48e000($bEstCourant ? 1 : (($i < $nSelectedItem) ? 6 : 7)) ,$this->F1d48e000(10) ,$sSeparateur ); $bPremierIndice=false; } $bHasNext = $this->Fb19c91cc(); if ($bHasNext || $this->m_ATTREGLETTE_MODEAFFICHAGE_WEB<=2) { $szHTMLGenere .= $this->F4d3c7029($this->m_ATTREGLETTE_LIBELLESUIVANT_WEB, $this->F1ce8f6aa() + 1, $bHasNext,'suivant',$this->F1d48e000(3),$this->F1d48e000(11),$this->m_ATTREGLETTE_SEPARATEURBOUTON_WEB); } if ($bHasNext || $this->m_ATTREGLETTE_MODEAFFICHAGE_WEB==0) { $szHTMLGenere .= $this->F4d3c7029($this->m_ATTREGLETTE_LIBELLEDERNIER_WEB, $this->Fa3138986(), $bHasNext,'dernier',$this->F1d48e000(5),$this->F1d48e000(12),$this->m_ATTREGLETTE_SEPARATEURBOUTON_WEB); } return $szHTMLGenere; } function F1d48e000($ePartie) { $return = array('class' => '','local' => ''); if (!isset($this->m_tabPartieStyle[$ePartie])) return $return; if (isset($this->m_tabPartieStyle[0]['class'])) $return['class'] = $this->m_tabPartieStyle[0]['class']; if (isset($this->m_tabPartieStyle[0]['local'])) $return['local'] = $this->m_tabPartieStyle[0]['local']; if (isset($this->m_tabPartieStyle[$ePartie]['class'])) $return['class'] .= ' '.$this->m_tabPartieStyle[$ePartie]['class']; if (isset($this->m_tabPartieStyle[$ePartie]['local'])) $return['local'] .= ' '.$this->m_tabPartieStyle[$ePartie]['local']; return $return; } function F4d3c7029($szTexteElement, $nNumeroElement, $bAvecLien, $sNom, $tabSyle,$tabSyleSep, $sSeparateur) { global $MaPage; $szHTMLElement = ''; if ( $sSeparateur !== null ) { $szHTMLElement .= '<span class="padding ' . implode(' ',array_values($tabSyleSep)) . '">'. utf8_str_replace(' ','&nbsp;',utf8_htmlspecialchars($sSeparateur)) .'</span>'; } $szHTMLElement .= '<a'; if ($bAvecLien == true) { $cszNomFonctionApresClicAJAX = F156ead2e($this,TRT_Clic_Navigateur_Apres_AJAX); $cszLienFin = ",window['". $cszNomFonctionApresClicAJAX. "']"; if($this->bRegletteAjax) { if($this->bSubmit) { global $MaPage; $szHTMLElement .= " href=\"javascript:{if (_".$MaPage->GetAlias()."_SU" . "B(null)){_JAEE(_PAGE_,'".$this->Alias."',".$nNumeroElement.",4" . $cszLienFin . ")}}\""; } else { $szHTMLElement .= utf8_sprintf(' href="javascript:_JAEE(_PAGE_,\'%s\',%d,%d' . $cszLienFin . ');"', $this->Alias, $nNumeroElement, 3); } } else { if($this->bSubmit) { $szHTMLElement .= utf8_sprintf(' href="javascript:if (_%s_SUB(null)){_R'.$this->Alias.'(\''.$nNumeroElement.'\')}"',$MaPage->m_sNomPHP); } else { $szHTMLElement .= ' href="?WD_ACTION_=SCROLLTABLE&' . $this->Alias . '=' . $nNumeroElement . $MaPage->Ff1153809('&').'"'; } } } $szHTMLElement .= ' class="padding ' . implode(' ',array_values($tabSyle)) . '">' . utf8_htmlspecialchars($szTexteElement) . '</a>'; return '<li class="'.$sNom.'">'.$szHTMLElement.'</li>'; } function F4a917fa4() { return 21; } function F16d5955d() { return $this->GetValeurAffichee(); } function F236bb7fa($bAvecSelection = true) { $sCodeXML = ''; $ChampAssocie =& F9abbf335(GetNomChamp($this->sNomChampAssocie),IND_CHAMP); if(isset($ChampAssocie)) { $sCodeXML .= "<CHAMP ALIAS=\"".$ChampAssocie->GetAlias()."\" TYPE=\"".$ChampAssocie->F4a917fa4()."\">"; $sCodeXML .= $ChampAssocie->F236bb7fa($bAvecSelection); $sCodeXML .= "</CHAMP>"; } $sCodeXML .= "<CHAMP ALIAS=\"".$this->GetAlias()."\" TYPE=\"".$this->F4a917fa4()."\">"; $sCodeXML .= $this->GetValeurAffichee(); $sCodeXML .= "</CHAMP>"; return $sCodeXML; } function Fdc05d49f( $ValeurHTTP ) { $this->SetValeur($ValeurHTTP); } } function F156ead2e(&$pclChamp, $eTypeTraitement) { $pszSuffixe = ''; switch ($eTypeTraitement) { default: case TRT_Clic_Navigateur: $pszSuffixe = "CLI"; break; case TRT_onSubmit_Navigateur: $pszSuffixe = "SUB"; break; case TRT_Clic_Navigateur_Apres_AJAX: $pszSuffixe = "CLA"; break; } return "_" . $pclChamp->Alias . "_" . $pszSuffixe; } ?>