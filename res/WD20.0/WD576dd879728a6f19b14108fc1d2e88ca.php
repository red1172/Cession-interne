<?php
//20.0.56.0 WL/STD/Std.php GF 
//VersionVI: 30F200066p
//(c) 2006-2008 PC SOFT  - Release
 if (!defined('__INC__FMK/Disque.php')) { define('__INC__FMK/Disque.php',true); include_once(WB_INCLUDE_PATH.'WD99bd5984d9c78e9239c729a52b83e562.php'); } if (!defined('__INC__FMK/Chaine.php')) { define('__INC__FMK/Chaine.php',true); include_once(WB_INCLUDE_PATH.'WD55acb2e708e26f23cb8956cd93e98123.php'); } if (!defined('__INC__FMK/Date.php')) { define('__INC__FMK/Date.php',true); include_once(WB_INCLUDE_PATH.'WD97af71f4453b9d548e8ff90b4bbaba9f.php'); } if (!defined('__INC__FMK/Date/Duree.php')) { define('__INC__FMK/Date/Duree.php',true); include_once(WB_INCLUDE_PATH.'WD6d1d70fd32a89f3c5df66eb4471caef2.php'); } if (!defined('__INC__FMK/Exception.php')) { define('__INC__FMK/Exception.php',true); include_once(WB_INCLUDE_PATH.'WDad4db5db8c5c5d46f4e2f107ea6466df.php'); } if (!defined('__INC__FMK/Compat/xsystem.php')) { define('__INC__FMK/Compat/xsystem.php',true); include_once(WB_INCLUDE_PATH.'WD14183cc5dbbd843da831afdd3bf106e4.php'); } if (!defined('__INC__FMK/Hash.php')) { define('__INC__FMK/Hash.php',true); include_once(WB_INCLUDE_PATH.'WDf11d1f55fc38121769a6f5736c1e5eeb.php'); } if (!defined('__INC__FMK/Disque/Fichier.php')) { define('__INC__FMK/Disque/Fichier.php',true); include_once(WB_INCLUDE_PATH.'WD5e394596c6434eec95aa14dd761a6e59.php'); } $_STD_etc = null; $_STD_etl = null; function F15f3feee() { global $_STD_etc, $_STD_etl; $_STD_etc=array(); $_STD_etc[eEUR] = 1; $_STD_etc[eFRF] = 6.55957; $_STD_etc[eITL] = 1936.27; $_STD_etc[eBEF] = 40.3399; $_STD_etc[eLUF] = 40.3399; $_STD_etc[eDEM] = 1.95583; $_STD_etc[eATS] = 13.7603; $_STD_etc[eDKK] = 0; $_STD_etc[eESP] = 166.386; $_STD_etc[eIEP] = 0.787564; $_STD_etc[eNLG] = 2.20371; $_STD_etc[ePTE] = 200.482; $_STD_etc[eGBP] = 0; $_STD_etc[eSEK] = 0; $_STD_etc[eGRD] = 340.75; $_STD_etc[eFIM] = 5.94573; $_STD_etl = array(); $_STD_etl[eEUR] = utf8_chr(128); $_STD_etl[eFRF] = "F"; $_STD_etl[eITL] = "ITL"; $_STD_etl[eBEF] = "BEF"; $_STD_etl[eLUF] = "LUF"; $_STD_etl[eDEM] = "DEM"; $_STD_etl[eATS] = "ATS"; $_STD_etl[eDKK] = "DKK"; $_STD_etl[eESP] = "ESP"; $_STD_etl[eIEP] = "IEP"; $_STD_etl[eNLG] = "NLG"; $_STD_etl[ePTE] = "PTE"; $_STD_etl[eGBP] = "GBP"; $_STD_etl[eSEK] = "SEK"; $_STD_etl[eGRD] = "GRD"; $_STD_etl[eFIM] = "FIM"; for ($i = 0; $i < NbMaxDeviseLibre; $i++) { $_STD_etl[] = Fc34ec142("LIBELLEDEVISELIBRE") . ($i + 1); $_STD_etc[] = 0; } } function& F6300b66c() { global $_STD_etc; if (!isset($_STD_etc)) { F15f3feee(); } return $_STD_etc; } function& F95cd1453() { global $_STD_etl; if (!isset($_STD_etl)) { F15f3feee(); } return $_STD_etl; } $_TabFormatDateAnnee = array(); $_TabFormatDateAnnee[0] = FormatDateAnnee; $_TabFormatDateAnnee[1] = FormatDateAnneeUS; $_TabFormatDateAnnee[2] = FormatDateAnnee2; $_TabFormatDateAnnee[3] = FormatDateAnnee2US; $_TabFormatDateJour = array(); $_TabFormatDateJour[0] = FormatDateJour; $_TabFormatDateJour[1] = FormatDateJourUS; $_TabFormatDateJour[2] = FormatDateJourUnique; $_Identifiant = 0; $TabVariableGlobaleSTD = array(); define("MEM_LST_ZONE",0); define("MEM_ZONE_COURANTE",1); $TabVariableGlobaleSTD[MEM_ZONE_COURANTE] = ""; define("NOM_DEFAUT_ZONE", "WDMEMDEF"); $sNomDerniereFonctionMem = ""; function STD_SauveVariableGlobaleInterne(&$pclPage) { global $TabVariableGlobaleSTD; $pclPage->TabVarGlobaleInterneComposante["STD"] = $TabVariableGlobaleSTD; } function STD_RestaureVariableGlobaleInterne(&$pclPage) { global $TabVariableGlobaleSTD; if (!isset($pclPage->TabVarGlobaleInterneComposante["STD"])) return; $TabVariableGlobaleSTD = $pclPage->TabVarGlobaleInterneComposante["STD"]; } function InitHasard() { $Param = func_get_args(); srand((func_num_args() > 0) ? $Param[0] : time()); } function CookieEcrit($Cookie, $Valeur, $Validite = NbJourValiditeCookieDefaut, $path = null, $domain = null) { if (isset($domain)) { setcookie($Cookie,$Valeur,time() + ($Validite * NbSecondeParJour), $path, $domain); } else if (isset($path)) { setcookie($Cookie,$Valeur,time() + ($Validite * NbSecondeParJour), $path); } else { setcookie($Cookie,$Valeur,time() + ($Validite * NbSecondeParJour)); } } function CookieLit($Cookie) { return array_key_exists($Cookie,$_COOKIE) ? $_COOKIE[$Cookie] : ""; } function DateDuJour() { return Fdaa64b0d(); } function DateSys() { return Fdaa64b0d(); } function DateValide($Date) { return F3c5ce664($Date); } function F8a6c65f8(&$DateHeure, $Format,$Remplacement,&$DateHeureFormat,$bSupprimeDuFormat = true, $nNbRemplacementsAutorises = null) { $nRemplacementsFaits = 0; $nTailleFormat = utf8_strlen($Format); $nTailleRemplacement = utf8_strlen($Remplacement); while ((!isset($nNbRemplacementsAutorises)||$nNbRemplacementsAutorises>$nRemplacementsFaits) && ($sChaineTrouvee = F2960db32($DateHeureFormat,$Format,$nTailleFormat))!==false) { $nPosOccurrence = utf8_strlen($DateHeureFormat) - utf8_strlen($sChaineTrouvee); if (!is_numeric($Remplacement) && utf8_substr($DateHeureFormat,$nPosOccurrence,utf8_strlen($Format)) === utf8_ucfirst(utf8_strtolower($Format))) { $DateHeure = utf8_substr_replace($DateHeure,utf8_ucfirst($Remplacement),$nPosOccurrence,$nTailleFormat); ++$nRemplacementsFaits; } else { $sFormatTrouve = utf8_substr($sChaineTrouvee,0,$nTailleFormat); if($nTailleFormat===1 ? $sFormatTrouve===$Format : ($sFormatTrouve===utf8_strtolower($Format)) || ($sFormatTrouve===utf8_strtoupper($Format)) ) { $DateHeure = utf8_substr_replace($DateHeure,$Remplacement,$nPosOccurrence,$nTailleFormat); ++$nRemplacementsFaits; } } if ($bSupprimeDuFormat) { $DateHeureFormat = utf8_substr_replace($DateHeureFormat,utf8_str_pad('',$nTailleRemplacement,' '),$nPosOccurrence,$nTailleFormat); } } return $nRemplacementsFaits; } function F2960db32($DateHeureFormat,$Format,$nTailleFormat) { if (FormatDate1ereLettreJourMaj === $Format) { $sChaineTrouvee = utf8_stristr($DateHeureFormat,$Format . '|'); if (false!==$sChaineTrouvee) return $sChaineTrouvee; if ($nTailleFormat>0 && F0728da76($DateHeureFormat,$Format)) { return utf8_substr($DateHeureFormat,utf8_strlen($DateHeureFormat)-$nTailleFormat); } return false; } return utf8_stristr($DateHeureFormat,$Format); } function DateVersChaine($Date, $Format = FormatDateDefaut) { if ($Date == '') return ''; if ($Format == szMASKDATEHEURE_SYTEME) { $Format = EnvGet('FORMATDATESYSTEME'); if (!isset($Format)) $Format = Fc34ec142('FORMATDATESYSTEME'); } elseif ($Format == szMASKDATEHEURE_DUREEERELATIVE) { F47db8683(); return F347a93ed($Date,$Format); } $DateFormat = $Format; F8a6c65f8($DateFormat,FormatDateAnnee,utf8_substr($Date,DebutAnneeDansDateHeure,TailleAnneeDansDateHeure),$Format); F8a6c65f8($DateFormat,FormatDateAnneeUS,utf8_substr($Date,DebutAnneeDansDateHeure,TailleAnneeDansDateHeure),$Format); F8a6c65f8($DateFormat,FormatDateAnnee2,utf8_substr($Date,DebutAnnee2DansDateHeure,TailleAnnee2DansDateHeure),$Format); F8a6c65f8($DateFormat,FormatDateAnnee2US,utf8_substr($Date,DebutAnnee2DansDateHeure,TailleAnnee2DansDateHeure),$Format); $DateJour = Ffec7ff1b($Date); $MoisLettre = F2b663679($DateJour); F8a6c65f8($DateFormat,FormatDateMoisLettre,$MoisLettre,$Format); F8a6c65f8($DateFormat,FormatDateMoisAbrege,Fa426c6ca($MoisLettre),$Format); F8a6c65f8($DateFormat,FormatDateMois,utf8_substr($Date,DebutMoisDansDateHeure,TailleMoisDansDateHeure),$Format); $JourLettre = F11ec46fa($DateJour); F8a6c65f8($DateFormat,FormatDateJourLettre,$JourLettre,$Format); F8a6c65f8($DateFormat,FormatDateJourLettreUS,$JourLettre,$Format); $JourLettreAbrege = Fa426c6ca($JourLettre); F8a6c65f8($DateFormat,FormatDateJourAbrege,$JourLettreAbrege,$Format); F8a6c65f8($DateFormat,FormatDateJourAbregeUS,$JourLettreAbrege,$Format); F8a6c65f8($DateFormat,FormatDateJour,utf8_substr($Date,DebutJourDansDateHeure,TailleJourDansDateHeure),$Format); F8a6c65f8($DateFormat,FormatDateJourUS,utf8_substr($Date,DebutJourDansDateHeure,TailleJourDansDateHeure),$Format); F8a6c65f8($DateFormat,FormatDateMoisUnique,intval(utf8_substr($Date,DebutMoisDansDateHeure,TailleMoisDansDateHeure)),$Format); F8a6c65f8($DateFormat,FormatDateJourUnique,intval(utf8_substr($Date,DebutJourDansDateHeure,TailleJourDansDateHeure)),$Format); F8a6c65f8($DateFormat,FormatDateJourUniqueUS,intval(utf8_substr($Date,DebutJourDansDateHeure,TailleJourDansDateHeure)),$Format); F8a6c65f8($DateFormat,FormatDate1ereLettreJourMaj,utf8_substr(utf8_ucfirst($JourLettre),0,1),$Format); return $DateFormat; } function ChaineVersDate($DateChaine, $Format = FormatDateDefaut) { if (empty($DateChaine)) return $DateChaine; if ('' === $Format) return ''; $_TabMois =& Fcc7e85f2(); $_TabJours =& F7d16a969(); $sFormatMin = utf8_strtolower($Format); $sValeurMin = utf8_strtolower($DateChaine); $nAnnee = $nMois = $nJour = 0; $nValeurUtilisee = 0; $bTrouve = false; while (''!==$sFormatMin) { $bModifFaite = true; if ($nValeurUtilisee>0) { $sFormatMin = utf8_substr($sFormatMin,$nValeurUtilisee); if ('' == $sFormatMin) break; } $nValeurUtilisee = 4; switch (F35bdb297($sFormatMin,$nValeurUtilisee-1) ? utf8_substr($sFormatMin,0,$nValeurUtilisee) : '') { case 'aaaa': case 'yyyy': if (utf8_strlen($sValeurMin)<4) { return ''; } $nAnnee = intval(utf8_substr($sValeurMin,0,4)); $sValeurMin = utf8_substr($sValeurMin,4); continue; case 'jjjj': case 'dddd': $bTrouve = false; foreach ($_TabJours as $sJour) { if (utf8_substr($sValeurMin,0,$nTailleJour=utf8_strlen($sJour)) === utf8_strtolower($sJour)) { $sValeurMin = utf8_substr($sValeurMin,$nTailleJour); $bTrouve = true; break; } } if ($bTrouve) continue; return ''; case 'mmmm': $nMois = 0; $bTrouve = false; foreach ($_TabMois as $sMois) { ++$nMois; if (utf8_substr($sValeurMin,0,$nTailleMois=utf8_strlen($sMois)) === utf8_strtolower($sMois)) { $sValeurMin = utf8_substr($sValeurMin,$nTailleMois); $bTrouve = true; break; } } if ($bTrouve) continue; return ''; default: $bModifFaite = false; } if ($bModifFaite) continue; $bModifFaite = true; $nValeurUtilisee = 3; switch (F35bdb297($sFormatMin,$nValeurUtilisee-1) ? utf8_substr($sFormatMin,0,$nValeurUtilisee) : '') { case 'aaa': case 'yyy': return ''; case 'mmm': $nMois = 0; $bTrouve = false; $nMaxTailleCommune = $nMoisAvecMaxTailleCommune = 0; $bAvecSuffixePoint = false; foreach ($_TabMois as $sMois) { ++$nMois; if (($nTailleCommune = Fd1fcabe5(utf8_strtolower($sMois),$sValeurMin,DepuisDebut)) > $nMaxTailleCommune) { $nMaxTailleCommune = $nTailleCommune; $nMoisAvecMaxTailleCommune = $nMois; $bAvecSuffixePoint = ('.' === (string)utf8_substr($sValeurMin,$nMaxTailleCommune,1)); $bTrouve = true; } } if ($bTrouve) { $nMois = $nMoisAvecMaxTailleCommune; $sValeurMin = utf8_substr($sValeurMin,$nMaxTailleCommune + intval($bAvecSuffixePoint)); continue; } return ''; default: $bModifFaite = false; } if ($bModifFaite) continue; $bModifFaite = true; $nValeurUtilisee = 2; switch (F35bdb297($sFormatMin,$nValeurUtilisee-1) ? utf8_substr($sFormatMin,0,$nValeurUtilisee) : '') { case 'aa': case 'yy': if ($nAnnee === 0) { $sFinAnnee = utf8_substr($sValeurMin,0,$nValeurUtilisee); $nAnnee = (intval($sFinAnnee)>50?'19':'20') . $sFinAnnee; } $sValeurMin = utf8_substr($sValeurMin,$nValeurUtilisee); continue; case 'jj': case 'dd': if ($nJour === 0) { $nJour = utf8_substr($sValeurMin,0,$nValeurUtilisee); } $sValeurMin = utf8_substr($sValeurMin,$nValeurUtilisee); continue; case 'mm': if ($nMois === 0) { $nMois = utf8_substr($sValeurMin,0,$nValeurUtilisee); } $sValeurMin = utf8_substr($sValeurMin,$nValeurUtilisee); continue; default: $bModifFaite = false; } if ($bModifFaite) continue; $nValeurUtilisee = 1; switch (utf8_substr($sFormatMin,0,$nValeurUtilisee)) { case 'j': case 'd': if ($nJour === 0) { $nJour = intval(utf8_substr($sValeurMin,0,1)); if ($nJour<=3) { $sUniteJour = (string)utf8_substr($sValeurMin,1,1); if (is_numeric($sUniteJour)) { $nUniteJour = intval($sUniteJour); switch ($nJour) { case 3: default: case 2: case 1: $nJour = $nJour*10 + $nUniteJour; $sValeurMin = utf8_substr($sValeurMin,1); } } } } $sValeurMin = utf8_substr($sValeurMin,1); continue; case 'm': if ($nMois === 0) { $nMois = intval(utf8_substr($sValeurMin,0,1)); if ($nMois<=1) { $sUniteMois = (string)utf8_substr($sValeurMin,1,1); if (is_numeric($sUniteMois)) { $nUniteMois = intval($sUniteMois); switch ($nUniteMois) { default: case 2: case 1: case 0: $nMois = $nMois*10 + $nUniteMois; $sValeurMin = utf8_substr($sValeurMin,1); } } } } $sValeurMin = utf8_substr($sValeurMin,1); continue; default: $sValeurMin = utf8_substr($sValeurMin,1); } } if ($sValeurMin!==false || !is_numeric($nAnnee) || !is_numeric($nMois) || !is_numeric($nJour)) { return ''; } if ($nJour>31) $nJour = Ff02489ac($nMois,$nAnnee); $Date = F04e7ba0d($nAnnee,4) . F04e7ba0d($nMois,2,true) . F04e7ba0d($nJour,2,true); return $Date; } function DateHeureLocaleVersUTC($sDateHeureLocale) { if ((int)$sDateHeureLocale < 1980) { return Fe81a7f9e('ERR_DATEHEURE_INVALIDE_AVANT_1980'); } $sDateHeureLocale = F472c129e($sDateHeureLocale); $CC = utf8_substr($sDateHeureLocale,14); $annee = utf8_substr($sDateHeureLocale,0,4); $mois = utf8_substr($sDateHeureLocale,4,2); $jour = utf8_substr($sDateHeureLocale,6,2); $heure = utf8_substr($sDateHeureLocale,8,2); $minute = utf8_substr($sDateHeureLocale,10,2); $seconde = utf8_substr($sDateHeureLocale,12,2); F6b1e3687(); $sRetour = gmdate('YmdHis',mktime($heure,$minute,$seconde,$mois,$jour,$annee)) . $CC; F1e7b0563(); return $sRetour; } function DateHeureUTCVersLocale($sDateHeureUTC) { if ((int)$sDateHeureUTC < 1980) { return Fe81a7f9e('ERR_DATEHEURE_INVALIDE_AVANT_1980'); } $sDateHeureUTC = F472c129e($sDateHeureUTC); $CC = utf8_substr($sDateHeureUTC,14); $annee = utf8_substr($sDateHeureUTC,0,4); $mois = utf8_substr($sDateHeureUTC,4,2); $jour = utf8_substr($sDateHeureUTC,6,2); $heure = utf8_substr($sDateHeureUTC,8,2); $minute = utf8_substr($sDateHeureUTC,10,2); $seconde = utf8_substr($sDateHeureUTC,12,2); F6b1e3687(); $sRetour = date('YmdHis',gmmktime($heure,$minute,$seconde,$mois,$jour,$annee)) . $CC; F1e7b0563(); return $sRetour; } function DateHeureParDefaut($sDate=null,$sHeure=null) { if (($sDate==null) && ($sHeure==null)) { $clContexte =& FMK_Contexte(); $clContexte->Ff9d5e233(Fd7624002('DateParDéfaut')); $clContexte->Ff9d5e233(Fd7624002('HeureParDéfaut')); } else { $sDate = F1fafd2ef($sDate,TailleDate); $sHeure = F1fafd2ef($sHeure,TailleHeure); $clContexte =& FMK_Contexte(); $clContexte->F4c8f9bd4(Fd7624002('DateParDéfaut'),$sDate); $clContexte->F4c8f9bd4(Fd7624002('HeureParDéfaut'),$sHeure); } } function DateVersEntier($Date, $DepuisDebutAnnee = false) { return Ffec7ff1b($Date,$DepuisDebutAnnee); } function DateVersJour($Date) { return F875f6ed2($Date); } function DateVersJourEnLettre($Date) { return F11ec46fa(Ffec7ff1b($Date)); } function DateVersMoisEnLettre($Date) { return F142f0517($Date); } function DonneIdentifiant() { global $_Identifiant; return ++$_Identifiant; } function EntierVersDate($DateJour, $PartieDate = '') { return Fd9b81f8e($DateJour, $PartieDate); } function EntierVersHeure($HeureCentieme) { return utf8_sprintf(ChaineFormatDateHeureHeureCentieme,$HeureCentieme / NbCentiemeParHeure,($HeureCentieme % NbCentiemeParHeure) / NbCentiemeParMinute,($HeureCentieme % NbCentiemeParMinute) / NbCentiemeParSeconde,$HeureCentieme % NbCentiemeParSeconde); } function EntierVersJour($DateJour) { return Fde803145($DateJour); } function Fa426c6ca($Chaine) { return utf8_substr($Chaine,0,$NbCar = NbLettreAbrege + ((utf8_strncasecmp($Chaine,"jui",NbLettreAbrege) == 0) ? 1 : 0)) . ((utf8_strlen($Chaine) > $NbCar) ? "." : ""); } function EntierVersJourEnLettre($DateJour) { return F11ec46fa($DateJour); } function EntierVersMoisEnLettre($DateJour) { return F2b663679($DateJour); } function EntierVersNumeroDeSemaine($DateJour) { return F6226d5b6(Fd9b81f8e($DateJour)); } function Hasard() { $nbarg = func_num_args(); $arg = func_get_args(); switch($nbarg) { case 0 : return (float)("0.".rand()); break; case 1 : return rand(min(1,max(0,$arg[0])), max(0,$arg[0])); break; case 2 : return rand($arg[0], $arg[1]); break; default : return 0; break; } } function Fc83455d1($Chaine) { return ($Chaine > 0) || (utf8_substr($Chaine,0,1) == "0") || ($Chaine == ""); } function HeureEstValide($HeureFormat) { if (!preg_match('/'.ExpRegDebut . ExpRegDébutRépétition . ExpRegChiffre . ExpRegFinRépétition . ExpRegRepetition . ExpRegFin.'/',$HeureFormat)) return false; $HeureFormat = F85189180($HeureFormat); $Heure = utf8_substr($HeureFormat,DebutHeureDansHeure,TailleHeureDansDateHeure); $Minute = utf8_substr($HeureFormat,DebutMinuteDansHeure,TailleMinuteDansDateHeure); $Seconde = utf8_substr($HeureFormat,DebutSecondeDansHeure,TailleSecondeDansDateHeure); $Centieme = utf8_substr($HeureFormat,DebutCentiemeDansHeure,TailleCentiemeDansDateHeure); return Fc83455d1($Heure) && ($Heure < NbHeureParJour) && Fc83455d1($Minute) && ($Minute < NbMinuteParHeure) && Fc83455d1($Seconde) && ($Seconde < NbSecondeParMinute) && Fc83455d1($Centieme) && ($Centieme < NbCentiemeParSeconde); } function HeureSys() { $Heure = gettimeofday(); $Retour = date("His",$Heure["sec"]).utf8_sprintf(ChaineFormatDateHeureCentieme,$Heure["usec"] / NbMicroParCentieme); return $Retour; } function Maintenant() { $Retour = new CMaintenant(); return $Retour; } function HeureVersChaine($Heure, $Format = FormatHeureDefaut) { if ($Heure==='') return '00:00:00:00'; if ($Format == szMASKDATEHEURE_SYTEME) { $Format = EnvGet('FORMATHEURESYSTEME'); if (!isset($Format)) $Format = Fc34ec142('FORMATHEURESYSTEME'); } $HeureFormat = $Format; $Heure = F85189180($Heure); $PartieHeure = utf8_substr($Heure,DebutHeureDansHeure,TailleHeureDansDateHeure); if ((utf8_strpos($Format,FormatHeureAP) !== false) || (utf8_strpos($Format,utf8_strtolower(FormatHeureAP)) !== false)) { if ('00' == $PartieHeure) { $PartieHeure = '12'; F8a6c65f8($HeureFormat,FormatHeureAP,"AM",$Format); } else F8a6c65f8($HeureFormat,FormatHeureAP,($PartieHeure < HeureAMPM) ? "AM" : "PM",$Format); $PartieHeure = utf8_sprintf(ChaineFormatDateHeureHeure,(($PartieHeure == HeureAMPM) ? HeureAMPM : $PartieHeure % HeureAMPM)); } if (F8a6c65f8($HeureFormat,FormatHeureHeure,$PartieHeure,$Format,true,1) === 0) { F8a6c65f8($HeureFormat,FormatHeureHeureCourt,intval($PartieHeure),$Format,true,1); } F8a6c65f8($HeureFormat,FormatHeureMinute,utf8_substr($Heure,DebutMinuteDansHeure,TailleMinuteDansDateHeure),$Format); F8a6c65f8($HeureFormat,FormatHeureSeconde,utf8_substr($Heure,DebutSecondeDansHeure,TailleSecondeDansDateHeure),$Format); F8a6c65f8($HeureFormat,FormatHeureCentieme,utf8_substr($Heure,DebutCentiemeDansHeure,TailleCentiemeDansDateHeure),$Format); return $HeureFormat; } function HeureVersEntier($Heure) { return F4f4d91fe($Heure); } function NumeriqueVersChaine($Nombre, $Format = "") { return F0bbea4d4($Nombre,$Format); } function NumeroDeSemaine($Date) { return F6226d5b6($Date); } function DateDifference($date1, $date2) { return Ffec7ff1b($date2) - Ffec7ff1b($date1); } function HeureDifference($HeureDebut,$HeureFin) { return F4f4d91fe($HeureFin) - F4f4d91fe($HeureDebut); } function DateHeureDifference($DateHeureDebut, $DateHeureFin) { return Fc1971e77($DateHeureDebut,$DateHeureFin); } function Age($dateNaissance, $dateCalcul = '' ) { if ($dateCalcul == '') { $dateCalcul = Fdaa64b0d(); } if ( (!is_numeric($dateNaissance)) || (!is_numeric($dateCalcul))){ Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_VALEUR_INCORRECT"),Fc34ec142("FCT_AGE"))); return ''; } if ( (!F3c5ce664($dateNaissance)) || (!F3c5ce664($dateCalcul)) ) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_VALEUR_INCORRECT"),Fc34ec142("FCT_AGE"))); return ''; } $wddateNaissance = new FMK_Date($dateNaissance ,FormatAnneeMoisJour); $wddateCalcul = new FMK_Date($dateCalcul ,FormatAnneeMoisJour); if ( $wddateNaissance->Fa8f32ca1() <= $wddateCalcul->Fa8f32ca1() ) { $dmkDuree = F7c839cd9($wddateNaissance,$wddateCalcul); return $dmkDuree->F89a4730d(); } else { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_VALEUR_INCORRECT"),Fc34ec142("FCT_AGE"),Fc34ec142("FCT_AGE_DESC"))); return ''; } } function Paques($nAnnee){ $nLongueurAnnee = utf8_strlen($nAnnee); if ($nLongueurAnnee>=4) { $nAnnee_sur4char = utf8_substr($nAnnee,0,4); } else $nAnnee_sur4char = $nAnnee; if (!is_numeric($nAnnee_sur4char)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_TYPE_INCORRECT"),Fc34ec142("FCT_PAQUES"),1,Fc34ec142("TYPEWL_NOM_CHAINE"),Fc34ec142("TYPEWL_NOM_ENTIER"))); return ''; } $nAnnee_sur4char = intval($nAnnee_sur4char); if ($nAnnee_sur4char <= AnneePassageGregorien) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_VALEUR_INCORRECT"),Fc34ec142("FCT_PAQUES")) . RC .Fc34ec142("FCT_PAQUES_DESC")); return ''; } $month = 0; $day = 0; Fc4670717($nAnnee_sur4char,$month,$day); $wddatePaques = new FMK_Date($nAnnee_sur4char.'0'.$month.F04e7ba0d($day),FormatAnneeMoisJour); if (!$wddatePaques->F97da59d7()) Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_RESULTAT_VALEUR_INCORRECT"),Fc34ec142("FCT_PAQUES"),FMK_ChaineConstruit(Fc34ec142("ERR_DATE_INCORRECT"),$wddatePaques->Fe8fc8ad8()))); return $wddatePaques->Fe8fc8ad8(); } function DureeVersChaine($sChaine, $sFormat) { if (!is_string($sChaine)){ Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_TYPE_INCORRECT"),'DureeVersChaine',1,'Objet non castable en chaine','Chaine')); return ''; } if (is_numeric($sFormat)){ switch ($sFormat ) { case dureeMillieme : $sFormat = FormatDureeMillieme; break; case dureeCentieme : $sFormat = FormatDureeCentieme; break; } } if ($sFormat=='') { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_VALEUR_INCORRECT"),'DureeVersChaine(Chaine non vide)')); return ''; } $sDuree = new FMK_Date_Duree($sChaine,FormatDureeMillieme); $sResultat = $sDuree->F1fc6a77e($sFormat); $sResultat = utf8_str_replace('+' ,($sDuree->m_bPositif) ? '' : '-',$sResultat ); $sResultat = utf8_str_replace('J' ,$sDuree->getJour() ,$sResultat ); $sResultat = utf8_str_replace('HH',$sDuree->F387e0cb8() ,$sResultat); $sResultat = utf8_str_replace('H',$sDuree->getHeure() ,$sResultat); $sResultat = utf8_str_replace('MM',$sDuree->F4dccb29e() ,$sResultat); $sResultat = utf8_str_replace('M',$sDuree->getMinute() ,$sResultat); $sResultat = utf8_str_replace('SS',$sDuree->Fcf5775ce() ,$sResultat); $sResultat = utf8_str_replace('S',$sDuree->getSeconde() ,$sResultat); if (utf8_strpos($sResultat,'LLL')!==false) $sResultat = utf8_str_replace('LLL',$sDuree->F217e7cc7(3,true),$sResultat); else if (utf8_strpos($sResultat,'LL')!==false) { $sResultat = utf8_str_replace('LL',$sDuree->F217e7cc7(2,true),$sResultat); } else $sResultat = utf8_str_replace('L',$sDuree->F217e7cc7(1,true),$sResultat); return $sResultat; } function ChaineVersDuree($sChaine, $sFormat) { if (is_numeric($sFormat)) { switch (intval($sFormat)) { case dureeMillieme : $sFormat = FormatDureeMillieme; break; case dureeCentieme: $sFormat = FormatDureeCentieme; break; } } if ( ($sFormat=='') || ($sChaine=='') ) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PARAMETRE_VALEUR_INCORRECT"),'ChaineVersDuree(Chaine non vide,Chaine non vide)')); return '0000000000'; } $sChaine = preg_replace('/[^0-9]/','',$sChaine); $sFormat = preg_replace('/[^JHMSL]/','',$sFormat); $dateChaine = new FMK_Date_Duree($sChaine,$sFormat); $Retour=null; CreerType($Retour,null,TYPEWL_DUREE,$dateChaine->F97dc9065()); return $Retour; } function F108871b4($sChar) { $tabCaractere = array( 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x18, 0x18, 0x08, 0x08, 0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x04, 0x08, 0x00, 0x08, 0x04, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x06, 0x08, 0x02, 0x08, 0x06, 0x04, 0x18, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00, 0x08, 0x08, 0x08, 0x08, 0x08, 0x00, 0x00, 0x08, 0x00, 0x00, 0x00, 0x08, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x08, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x00, 0x00, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x02, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x02, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x08, 0x06, 0x06, 0x06, 0x06, 0x06, 0x06, 0x02, 0x06, ); $_TABLEAU_DE_PONCTUATION = array( '.', ',', ';', ':', '!', '?', '"', '\'', ' ', '-', '_', '/', '*', '\\', '^', ')', '}', '+', '=', Fd7624002('°'), ']', '\n', '`', '|', '[', '(', '{', '#', '~', '&', Fd7624002('²'), '<', '>', '$', Fd7624002('£'), Fd7624002('¤'), Fd7624002('µ'), '%', Fd7624002('§') ); if (is_numeric($sChar)) return false; if ( ($nPos = array_search($sChar,$tabCaractere)!=false) && ($tabCaractere[$nPos] == 8) ) return true; return (in_array(''.$sChar,$_TABLEAU_DE_PONCTUATION)); } function TailleCommune($sChaine1, $sChaine2, $sOptions = 0) { return Fd1fcabe5($sChaine1,$sChaine2,$sOptions); } function Compile($Proc, $Code) { return eval("function $Proc() { $Code }"); } function LanceAppli($sProgramme) { passthru($sProgramme); } function LanceAppliAssociee($sProgramme) { passthru($sProgramme); } function eInitDevise($Devise, $Libelle, $Valeur) { $_etl =& F95cd1453(); $_etc =& F6300b66c(); if ($Devise >= count($_etl)) return; $_etl[$Devise] = $Libelle; $_etc[$Devise] = $Valeur; } function eVersDevise($Valeur,&$Ecart,$Devise = eFrf, $NbDecimale = 2) { $_etc =& F6300b66c(); if ($Devise >= count($_etc)) return 0; $Res = round($Valeur * $_etc[$Devise], $NbDecimale); $Ecart = round($Valeur - ($Res / (($_etc[$Devise] != 0) ? $_etc[$Devise] : 1)),$NbDecimale); return $Res; } function eVersEuro($Valeur, &$Ecart, $Devise = eFrf, $NbDecimale = 2) { $_etc =& F6300b66c(); if ($Devise >= count($_etc)) return 0; $Res = round($Valeur / (($_etc[$Devise] != 0) ? $_etc[$Devise] : 1), $NbDecimale); $Ecart = round($Valeur - ($Res * $_etc[$Devise]),$NbDecimale); return $Res; } function eChangeDevise($Valeur,&$Ecart,$DeviseSrc,$DeviseDst,$NbDecimale=2) { $_etc =& F6300b66c(); if (($DeviseSrc >= count($_etc)) || ($DeviseDst >= count($_etc))) return 0; $Taux = ($_etc[$DeviseSrc] == $_etc[$DeviseDst]) ? 1 : ($_etc[$DeviseDst] / (($_etc[$DeviseSrc] != 0) ? $_etc[$DeviseSrc] : 1)); $Res = round($Valeur * $Taux, $NbDecimale); $Ecart = round($Valeur - (((($_etc[$DeviseSrc] != 0) && ($_etc[$DeviseDst] != 0)) || ($_etc[$DeviseSrc] == $_etc[$DeviseDst])) ? ($Res / $Taux) : 0),$NbDecimale); return $Res; } function fRepCree($NomRep) { if (!Fd0f24521($NomRep)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_DOSSIER_DROITS_INSUFFISANTS"),$NomRep)); return false; } return true; } function fOuvreFichierTemp($nModeOuverture, $sPrefixe, $sRepertoire=null) { if (!isset($sRepertoire)) { $sRepertoireACP = '.'; } else { if (!is_dir($sRepertoireACP=F9486bf1a($sRepertoire))) { return RetourErreur_Entier; } } if (utf8_strlen($sPrefixe)>3) $sPrefixe = utf8_substr($sPrefixe,0,3); $sFichierNom = tempnam($sRepertoireACP, F9486bf1a($sPrefixe)); $handle = Ff1eaa899($sFichierNom); if ($handle===false) { return RetourErreur_Entier; } if (Fdef56c7f($nModeOuverture , foSuppressionAutomatique )) { global $MaPage; $MaPage->Ff017d92b(create_function('','fSupprime("'. $sFichierNom .'");')); } if ( ($nModeOuverture &~ foSuppressionAutomatique &~ foSansSuppression) != 0) { Fe81a7f9e('ERR_FOUVREFICHIERTEMP_LIMITATION_MODEOUVERTURE'); } $pclContexte =& F4a1887ce(); $pclContexte->F4c8f9bd4('STD_HANDLE_' . intval($handle), $sFichierNom); return $handle; } function fOuvre($NomFichier, $Mode = foLectureEcriture) { F67cfd262(); DebutErreurAttendue(); $Retour = F0a2479f9($NomFichier, $Mode); FinErreurAttendue(); if ($Retour != RetourErreur_Entier) { $pclContexte =& F4a1887ce(); $pclContexte->F4c8f9bd4('STD_HANDLE_' . intval($Retour), $NomFichier); } else { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142('ERR_FICHIER_OUVERTURE_IMPOSSIBLE'),$NomFichier)); } return $Retour; } function fNomFichier($resHandle) { $pclContexte =& F4a1887ce(); return $pclContexte->F239ddeda('STD_HANDLE_' . intval($resHandle)); } function fCree($NomFichier) { $Retour = Ff1eaa899($NomFichier); if ($Retour != RetourErreur_Entier) { $pclContexte =& F4a1887ce(); $pclContexte->F4c8f9bd4('STD_HANDLE_' . intval($Retour), $NomFichier); } return $Retour; } function fFerme($Fichier) { $nHandle = intval($Fichier); $Retour = Fae814d9e($Fichier); if ($Retour != RetourErreur_Entier) { $pclContexte =& F4a1887ce(); $pclContexte->Ff9d5e233('STD_HANDLE_' . $nHandle); } return $Retour; } function fLit($Fichier, $NbOctet) { return F24f63604($Fichier, $NbOctet); } function fLitLigne($Fichier) { return F71eaba88($Fichier); } function fEcrit($Fichier, $Ecrit, $NbOctet = -1) { return Fe80480f8($Fichier, $Ecrit, $NbOctet); } function fEcritLigne($Fichier, $Ecrit) { return Fa40bd700($Fichier, $Ecrit); } function fPositionne($Fichier, $Position, $Origine) { return Fa118c401($Fichier, $Position, $Origine); } function fSupprime($NomFichier) { F67cfd262(); if (!Fc0adeacb($NomFichier)) { Fdd46bacf(FMK_ChaineConstruit(F1ac3f040('ERR_FICHIER_SUPPR_IMPOSSIBLE'),$NomFichier,FMK_ChaineConstruit(F1ac3f040('ERR_FICHIER_INEXISTANT'),$NomFichier))); return false; } return true; } function fCopieFichier($NomFichierSrc, $NomFichierDst, $Récursif = false) { return Ff578b8aa($NomFichierSrc, $NomFichierDst, $Récursif); } function fRenomme($NomSrc,$NomDst) { return F70df4179($NomSrc,$NomDst); } function fTaille($NomFichier) { return F53e7b3e7($NomFichier); } function fRepTaille($sCheminFichier, $nOptions = null) { F67cfd262(); if (!is_dir(F9486bf1a($sCheminFichier))) { Fdd46bacf(FMK_ChaineConstruit(F1ac3f040('ERR_DOSSIER_INEXISTANT'),$sCheminFichier)); return RetourErreur_Entier; } if ($nOptions & frInterruptible){ Fdd46bacf(F1ac3f040('ERR_CONSTANTE_IGNOREE_FCT'),F1ac3f040('CTE_FRINTERRUPTIBLE'),F1ac3f040('FCT_FREPTAILLE')); return RetourErreur_Entier; } return Fdbd19e8c($sCheminFichier,$nOptions); } function fRepDeplace($sSource, $sDestination, $nIndicateur=null) { F67cfd262(); if (!is_dir(F9486bf1a($sSource))) { Fdd46bacf(FMK_ChaineConstruit(F1ac3f040('ERR_DOSSIER_INEXISTANT'),$sSource)); return RetourErreur_Entier; } return Fb388ca29($sSource, $sDestination, $nIndicateur); } function fDate($NomFichier, $DateModif = "", $TypeDate = fModification) { return F736e4943($NomFichier, $DateModif, $TypeDate); } function fHeure($NomFichier, $HeureModif = "", $TypeHeure = fModification) { return F0fda4c12($NomFichier, $HeureModif, $TypeHeure ); } function fChargeTexte($NomFichier) { return F8ca52887($NomFichier); } function fSauveTexte($NomFichier, $Texte) { return F7973cde3($NomFichier, $Texte); } function fAttribut($NomFichier) { return Fdecb127d($NomFichier); } function fExtraitChemin($CheminFichier, $Partie) { return F7816de1e($CheminFichier,$Partie); } function fRep($NomFicRep, $FicRep = frFichier, $FermerRépertoire = true) { return Fdbf241ef($NomFicRep, $FicRep , $FermerRépertoire); } function fRepertoireExiste($sNomDuRépertoire) { return Fd994850b($sNomDuRépertoire); } function fListeRepertoire($sChemin, $nOptions = frRecursif){ return F289f359f($sChemin, $nOptions); } function fListeRepertoireExecute($sChemin, $sProcedure, $nPointeur = 0, $nOptions = frRecursif) { $clVM =& obtenirVM(); $sProcedureCorrecte = $clVM->Ff06e3e53($sProcedure); if (!isset($sProcedureCorrecte)) { Fe81a7f9e('ERR_PROCEDURE_INCONNUE',$sProcedure); } return Fd2d7b6a5($sChemin, $sProcedureCorrecte, $nPointeur, $nOptions); } function fDeplaceFichier($sFichierOrigine,$sFichierDestination) { if (!file_exists($sFichierOrigineACP=F9486bf1a($sFichierOrigine))){ Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_FICHIER_INEXISTANT"),$sFichierOrigine)); return false; } if (!is_file($sFichierOrigineACP)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_FICHIER_INCORRECT"),$sFichierOrigine)); return false; } if (file_exists(F9486bf1a($sFichierDestination))) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_FICHIER_DEJA_EXISTANT"),$sFichierDestination)); return false; } if ( ($bResultat=Ff116711f($sFichierOrigine,$sFichierDestination)) === false) Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_FICHIER_MODIFICATION_IMPOSSIBLE"),$sFichierOrigine)); return $bResultat; } function fDateHeure($sChemin, $sNouvelleDate = '', $sTypeDateHeure = fModification) { if (!file_exists($sCheminACP=F9486bf1a($sChemin))){ Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_FICHIER_INCORRECT"),$sChemin)); return ''; } if (filemtime($sCheminACP) === false) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_DOSSIER_DROITS_INSUFFISANTS"),$sChemin)); return ''; } return F0af6a1c7($sChemin, $sNouvelleDate, $sTypeDateHeure); } function fRepAttribut($sNomDuRepertoire,$sAttributs = false) { if (!file_exists(F9486bf1a(F0ac3fb91($sNomDuRepertoire)))){ Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_FICHIER_INEXISTANT"),$sNomDuRepertoire)); return 'ERR'; } return Fc6678c4a($sNomDuRepertoire,$sAttributs); } function fListeFichier($NomFicRep, $NomProc, $Param = 0, $Indicateur = flPremierFichier, $Récursif = true, $ListeRépertoire = false) { if (isset($NomProc)) { $clVM =& obtenirVM(); $sNomProc = $clVM->Ff06e3e53($NomProc); if (!isset($sNomProc)) $sNomProc = $NomProc; if (!function_exists($sNomProc)) { Fe81a7f9e('ERR_FCT_NON_TROUVEE',$NomProc); } $NomProc = $sNomProc; } return Fb459705a($NomFicRep, $NomProc, $Param, $Indicateur, $Récursif, $ListeRépertoire); } function fRepCopie($Source,$Destination,$Récursif = 0) { if ((!is_dir(F9486bf1a($Source))) && (utf8_strstr($FichierJoker = F7816de1e($Source,fFichierExtension),JokerFichierCaractere) === false) && (utf8_strstr($FichierJoker,JokerFichierChaine) === false)) return false; if (!Fd0f24521($Destination)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142('ERR_DOSSIER_DROITS_INSUFFISANTS'),$Destination)); return false; } return F8b2ea819($Source,$Destination,$Récursif); } function fRepSupprime($NomRep, $Récursif = 0, $Joker = false) { return Fb593fee5($NomRep, $Récursif, $Joker); } function fRepertoireTemp() { return F064e9774(); } function fFichierTemp($Prefixe = null, $Repertoire = null) { return F4574f559($Prefixe, $Repertoire); } function fFichierExiste($sNomFichier) { return F22eab6af($sNomFichier); } function fRepEnCours($Repertoire = "") { return F38281c13($Repertoire); } function fDisqueEnCours($Disque = "") { return F7537e8d3($Disque); } function fDisqueInfo($Disque, $Info) { return F40ac60aa($Disque, $Info); } function fCompare($sCheminFichier1, $sCheminFichier2) { return Ff169dd4e($sCheminFichier1, $sCheminFichier2); } function fCreeLien($sFichierPointe, $sFichierDestination, $bPhysique) { F67cfd262(); $bRetour = false; $sFonction = ($bPhysique) ? 'link' : 'symlink'; if (!function_exists($sFonction)) { Fe81a7f9e('ERR_FCREELIEN_FCTLINK_NONDISPO',$sFonction); return false; } F6b1e3687(); $bRetour = $sFonction($sFichierPointe,$sFichierDestination); F1e7b0563(); if ($bRetour) return true; Fdd46bacf(F1abae4f0()); return false; } function fSeparateur($sChemin , $nSep=null) { if (!isset($nSep)) $nSep = 0; if (is_int($nSep)) { switch($nSep) { case 0: $nSep=DIRECTORY_SEPARATOR; break; case 1: $nSep='\\'; break; case 2: $nSep='/'; break; default: ; } } return utf8_str_replace('\\', $nSep, utf8_str_replace('/', (string)$nSep, $sChemin)); } function F2eb29be3() { $Page = getenv(VarEnvFichierpage); if (empty($Page)) $Page = getenv(VarEnvFichierpage_CompatPHP4); if($Page == "") $Page = getenv("SCRIPT_FILENAME"); if (SepRepURL != SeparateurRepertoire) { return str_replace(SepRepURL,SeparateurRepertoire,$Page); } return $Page; } function fRepExe() { return dirname(F2eb29be3()); } function fRepWeb() { return fRepExe(); } function ExeInfo($Info, $Module = "") { if (($Fichier = F0a2479f9(($Module == "") ? F2eb29be3() : $Module,foLecture)) == ValeurRetourErreur) return ""; F71eaba88($Fichier); $Info = utf8_strtoupper($Info); if ($Info == exeVersionVI) F71eaba88($Fichier); $Ligne = F05ad8ed4(F71eaba88($Fichier),1,RC); Fae814d9e($Fichier); return F05ad8ed4(($Info == exeVersionVI) ? $Ligne : F05ad8ed4($Ligne,2,"#"),($Info == exeVersion) ? 1 : 2," "); } function EstNumerique($Variable) { return is_numeric($Variable) || (is_string($Variable) && is_numeric(Fb6596e39($Variable,1))); } function EstImpair( $nNombre ) { return !Fd1d65e7e($nNombre); } function EstPair( $nNombre ) { return Fd1d65e7e($nNombre); } function Fd1d65e7e($nNombre) { return ((($nNombre) % 2)==0); } function Fd3756407($Tableau, $Cle = "") { if ($Cle == "") { $ListeCle = ""; foreach(array_keys($Tableau) as $c) $ListeCle .= $c . RC; return $ListeCle; } if (!array_key_exists($Cle = utf8_strtoupper($Cle),$Tableau = utf8_array_change_key_case($Tableau,CASE_UPPER))) return false; return $Tableau[$Cle]; } function INILit($Section, $MotCle = "", $NonTrouve = "", $Fichier = "PHP.INI") { return F57247a85($Section, $MotCle, $NonTrouve, $Fichier); } function F57247a85($Section, $MotCle = "", $NonTrouve = "", $Fichier = "PHP.INI") { if (!is_file($FichierACP=F9486bf1a($Fichier))) return $NonTrouve; if (($Info = parse_ini_file($FichierACP,true)) === false) return $NonTrouve; if (!is_array($InfoSection = Fd3756407($Info,$Section))) return ($InfoSection === false) ? $NonTrouve : $InfoSection; return (($Valeur = Fd3756407($InfoSection,$MotCle)) === false) ? $NonTrouve : $Valeur; } function F40acd8a0($Param) { return (utf8_trim($Param) != "") && ($Param !== null); } function Fa8c18ae6($Chaine, $Position) { return F3449a00a($Chaine,$Position,(($PosFin = FMK_Position($Chaine,FinLigne,$Position)) == 0) ? null : ($PosFin - $Position + 1)); } function F3f0bfbcb($Ligne) { return F05ad8ed4($Ligne,1,";"); } function F2a33a5a3($Ligne, $Section = "") { if (($PosDeb = FMK_Position($Ligne = F3f0bfbcb($Ligne),INIDebutSection)) == 0) return false; if (($PosFin = FMK_Position($Ligne,INIFinSection,$PosDeb)) == 0) return false; if ((($PosSep = FMK_Position($Ligne,INISepMotCleValeur)) > 0) && ($PosSep < $PosDeb)) return false; if (!F40acd8a0($Section)) return true; return Fda9fdf77($Section,F3449a00a($Ligne,$PosDeb + 1,$PosFin - $PosDeb - 1),OptionCompareINI) == 0; } function Faaa72473($Contenu, $Ligne, $Position) { return Fb6596e39($Contenu,$Position - 1) . F3449a00a($Contenu,$Position + utf8_strlen($Ligne)); } function Fa794b9ee($Contenu, &$Position, $Section) { while (($Ligne = Fa8c18ae6($Contenu,$Position)) != "") { if (F2a33a5a3($Ligne,$Section)) break; $Position += utf8_strlen($Ligne); } return $Ligne; } function F60a40aa2($Contenu, &$Position, $Section, $MotCle) { $Ligne = Fa794b9ee($Contenu,$Position,$Section); while ($Ligne != "") { $Position += utf8_strlen($Ligne); $Ligne = Fa8c18ae6($Contenu,$Position); if (F2a33a5a3($Ligne)) return ""; if ((F05ad8ed4($Ligne,2,INISepMotCleValeur) != EOT) && (Fda9fdf77(F05ad8ed4($Ligne,1,INISepMotCleValeur),$MotCle,OptionCompareINI) == 0)) break; } return $Ligne; } function F997c63c6($Contenu, $Ligne, $Position = 0) { $Ajout = ""; if (($Contenu != "") && (!F0728da76($Contenu,FinLigne))) $Ajout .= RC; $Ajout .= $Ligne . RC; $Contenu = ($Position == 0) ? ($Contenu . $Ajout) : (Fb6596e39($Contenu,$Position - 1) . $Ajout . F3449a00a($Contenu,$Position)); return $Contenu; } function INIEcrit($Section, $MotCle = "", $Valeur = "", $Fichier = "PHP.INI") { if (!F40acd8a0($Section)) return false; if (((!F40acd8a0($MotCle)) || (!F40acd8a0($Valeur))) && (!is_file(F9486bf1a($Fichier)))) return false; $Contenu = F8ca52887($Fichier); $SectionExiste = (F57247a85($Section,"",false,$Fichier) !== false); $Position = 1; if (!F40acd8a0($MotCle)) { if (!$SectionExiste) return true; $Ligne = Fa794b9ee($Contenu,$Position,$Section); while ($Ligne != "") { $Contenu = Faaa72473($Contenu,$Ligne,$Position); if (F2a33a5a3($Ligne = Fa8c18ae6($Contenu,$Position))) break; } } else { $SupprimeMotCle = false; if (!F40acd8a0($Valeur)) { if (!$SectionExiste) return true; $SupprimeMotCle = true; } else { $MotCleExiste = true; if (!$SectionExiste) { $Contenu = F997c63c6($Contenu,INIDebutSection . $Section . INIFinSection); $MotCleExiste = false; } if ((!$MotCleExiste) || (F57247a85($Section,$MotCle,false,$Fichier) === false)) { $MotCleExiste = false; } else { $SupprimeMotCle = true; } } $Ligne = F60a40aa2($Contenu,$Position,$Section,$MotCle); if ($SupprimeMotCle && ($Ligne != "")) $Contenu = Faaa72473($Contenu,$Ligne,$Position); if (!F40acd8a0($Valeur)) { if ($Ligne == "") return true; } else { $Contenu = F997c63c6($Contenu,($MotCleExiste ? F05ad8ed4($Ligne,1,INISepMotCleValeur) : $MotCle) . INISepMotCleValeur . ( (F61bc61eb($Valeur,'"') && F0728da76($Valeur,'"')) ? $Valeur : ('"'.$Valeur.'"')) ,$Position); } } return F7973cde3($Fichier,$Contenu); } function sCalculeCrc32($sChaine) { return (!isset($sChaine)) ? 558161692 : utf8_crc32($sChaine); } class CCrc16 { var $m_uTableCrc16 = array(); var $m_uCrc16; var $m_bCrc16Initialized; function CCrc16() { $this->m_uCrc16 = 0; $this->m_bCrc16Initialized = false; } function Fed48362b($uVal) { if ( !$this->m_bCrc16Initialized ) { $this->m_uTableCrc16 = array ( 0x0000, 0xC0C1, 0xC181, 0x0140, 0xC301, 0x03C0, 0x0280, 0xC241, 0xC601, 0x06C0, 0x0780, 0xC741, 0x0500, 0xC5C1, 0xC481, 0x0440, 0xCC01, 0x0CC0, 0x0D80, 0xCD41, 0x0F00, 0xCFC1, 0xCE81, 0x0E40, 0x0A00, 0xCAC1, 0xCB81, 0x0B40, 0xC901, 0x09C0, 0x0880, 0xC841, 0xD801, 0x18C0, 0x1980, 0xD941, 0x1B00, 0xDBC1, 0xDA81, 0x1A40, 0x1E00, 0xDEC1, 0xDF81, 0x1F40, 0xDD01, 0x1DC0, 0x1C80, 0xDC41, 0x1400, 0xD4C1, 0xD581, 0x1540, 0xD701, 0x17C0, 0x1680, 0xD641, 0xD201, 0x12C0, 0x1380, 0xD341, 0x1100, 0xD1C1, 0xD081, 0x1040, 0xF001, 0x30C0, 0x3180, 0xF141, 0x3300, 0xF3C1, 0xF281, 0x3240, 0x3600, 0xF6C1, 0xF781, 0x3740, 0xF501, 0x35C0, 0x3480, 0xF441, 0x3C00, 0xFCC1, 0xFD81, 0x3D40, 0xFF01, 0x3FC0, 0x3E80, 0xFE41, 0xFA01, 0x3AC0, 0x3B80, 0xFB41, 0x3900, 0xF9C1, 0xF881, 0x3840, 0x2800, 0xE8C1, 0xE981, 0x2940, 0xEB01, 0x2BC0, 0x2A80, 0xEA41, 0xEE01, 0x2EC0, 0x2F80, 0xEF41, 0x2D00, 0xEDC1, 0xEC81, 0x2C40, 0xE401, 0x24C0, 0x2580, 0xE541, 0x2700, 0xE7C1, 0xE681, 0x2640, 0x2200, 0xE2C1, 0xE381, 0x2340, 0xE101, 0x21C0, 0x2080, 0xE041, 0xA001, 0x60C0, 0x6180, 0xA141, 0x6300, 0xA3C1, 0xA281, 0x6240, 0x6600, 0xA6C1, 0xA781, 0x6740, 0xA501, 0x65C0, 0x6480, 0xA441, 0x6C00, 0xACC1, 0xAD81, 0x6D40, 0xAF01, 0x6FC0, 0x6E80, 0xAE41, 0xAA01, 0x6AC0, 0x6B80, 0xAB41, 0x6900, 0xA9C1, 0xA881, 0x6840, 0x7800, 0xB8C1, 0xB981, 0x7940, 0xBB01, 0x7BC0, 0x7A80, 0xBA41, 0xBE01, 0x7EC0, 0x7F80, 0xBF41, 0x7D00, 0xBDC1, 0xBC81, 0x7C40, 0xB401, 0x74C0, 0x7580, 0xB541, 0x7700, 0xB7C1, 0xB681, 0x7640, 0x7200, 0xB2C1, 0xB381, 0x7340, 0xB101, 0x71C0, 0x7080, 0xB041, 0x5000, 0x90C1, 0x9181, 0x5140, 0x9301, 0x53C0, 0x5280, 0x9241, 0x9601, 0x56C0, 0x5780, 0x9741, 0x5500, 0x95C1, 0x9481, 0x5440, 0x9C01, 0x5CC0, 0x5D80, 0x9D41, 0x5F00, 0x9FC1, 0x9E81, 0x5E40, 0x5A00, 0x9AC1, 0x9B81, 0x5B40, 0x9901, 0x59C0, 0x5880, 0x9841, 0x8801, 0x48C0, 0x4980, 0x8941, 0x4B00, 0x8BC1, 0x8A81, 0x4A40, 0x4E00, 0x8EC1, 0x8F81, 0x4F40, 0x8D01, 0x4DC0, 0x4C80, 0x8C41, 0x4400, 0x84C1, 0x8581, 0x4540, 0x8701, 0x47C0, 0x4680, 0x8641, 0x8201, 0x42C0, 0x4380, 0x8341, 0x4100, 0x81C1, 0x8081, 0x4040 ); $this->m_bCrc16Initialized = true; } $this->m_uCrc16 = $uVal & 0xffff; } function F7cd4092a( $c ) { $t = ($this->m_uCrc16 ^ utf8_ord($c)) & 0xff; $this->m_uCrc16 = (($this->m_uCrc16 >> 8) ^ $this->m_uTableCrc16[$t]) & 0xffff; } function F33996885() { return $this->m_uCrc16; } function F2e89a060($pcBuf,$nTaille) { $this->Fed48362b(0); for ($i=1;$i<=$nTaille;$i++) { $this->F7cd4092a($pcBuf[$i-1]); } return $this->F33996885(); } } function F01481792($data) { $crc = new CCrc16(); $nCRC16 = $crc->F2e89a060($data,utf8_strlen($data)); unset($crc); return $nCRC16; } function VerifieExpressionReguliere($sChaineAVerifier, $sFormat, $sListVar=null) { $sFormat = utf8_str_replace('/','\\/',$sFormat); $result = null; if(preg_match("/^".$sFormat."$/" . UNICODE_REGEXP, $sChaineAVerifier, $result) == 0) { return false; } $tabParams = (isset($sListVar)) ? $sListVar : array(); $nNbParams = count($tabParams); for ($i=0; $i<$nNbParams; $i++) { if ($tabParams[$i]!='') { if(isset($result[$i-1]) && is_array($result[$i-1])) { Operateur(95,$tabParams[$i],$result[$i-1][0]); } elseif(isset($result[$i-1])) { Operateur(95,$tabParams[$i],$result[$i-1]); } elseif(isset($result[0])) { Operateur(95,$tabParams[$i],$result[0]); } else { Operateur(95,$tabParams[$i],''); } } } return true; } function MemCree($sNomZoneMemoire) { F01435650($sNomZoneMemoire); } function MemAjoute($sNomZone = NOM_DEFAUT_ZONE, $cle = '', $valeur = null) { if (!isset($valeur)) { $valeur = $cle; $cle = ''; } global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_AJOUTE"); $ZoneMemoire = &Fafe98fbc($sNomZone); $ZoneMemoire->F265229a9($cle, $valeur); } function MemValCle($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_VAL_CLE"); $ZoneMemoire = Fafe98fbc($sNomZone); $ValCle = $ZoneMemoire->F85def1ce(); if(!isset($ValCle)) { Erreur('ErreurWL',"ErreurZoneMemoireInexistante", $sNomDerniereFonctionMem); } return $ValCle; } function MemPremier($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_PREMIER"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->F28a0aa6d(); } function MemDernier($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_DERNIER"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->F7cd87865(); } function MemSuivant($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_SUIVANT"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->Fc2588602(); } function MemPrededent($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_PRECEDENT"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->F1c6d54cf(); } function MemEnCours($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_EN_COURS"); $ZoneMemoire = Fafe98fbc($sNomZone); return $ZoneMemoire->nIndiceParcours + 1; } function MemEnDehors($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_EN_DEHORS"); $ZoneMemoire = Fafe98fbc($sNomZone); return $ZoneMemoire->bEnDehors; } function MemTrouve($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_TROUVE"); $ZoneMemoire = Fafe98fbc($sNomZone); return $ZoneMemoire->bTrouve; } function MemExiste($sNomZone) { return Fafe98fbc($sNomZone, false) != null; } function MemOccurrence($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_OCCURRENCE"); $ZoneMemoire = Fafe98fbc($sNomZone); return count($ZoneMemoire->TabValeurs); } function MemModifie($sNomZone, $cle, $valeur, $nIndice) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_MODIFIE"); $ZoneMemoire = &Fafe98fbc($sNomZone); $ZoneMemoire->F3ad7320f($cle, $valeur, $nIndice); } function MemPositionne($sNomZone, $nIndice) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_POSITIONNE"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->getPosition($nIndice); } function MemRecupere($sNomZone = NOM_DEFAUT_ZONE, $nIndice) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_RECUPERE"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->getValeur($nIndice); } function MemSupprime($sNomZone, $nIndice=1) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_SUPPRIME"); $ZoneMemoire = &Fafe98fbc($sNomZone); return $ZoneMemoire->F6418f8c0($nIndice); } function MemSupprimeTout($sNomZone = NOM_DEFAUT_ZONE) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_SUPPRIME_TOUT"); if($sNomZone == '*') { F1e1457ab(); } else { F485d9571($sNomZone); } } function MemTrie($sNomZone = NOM_DEFAUT_ZONE, $bAscendant = true) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_TRIE"); $ZoneMemoire = &Fafe98fbc($sNomZone); $ZoneMemoire->Fdf9bd17f($bAscendant); } function MemRecherche($sNomZone = NOM_DEFAUT_ZONE, $valeur, $bElement = true) { global $sNomDerniereFonctionMem; $sNomDerniereFonctionMem = Fc34ec142("FCT_MEM_RECHERCHE"); $ZoneMemoire = &Fafe98fbc($sNomZone); if($bElement) { return $ZoneMemoire->F92375428($valeur); } else { return $ZoneMemoire->F955a967d($valeur); } } function& F01435650($sNomZoneMemoire) { global $TabVariableGlobaleSTD; if(!isset($TabVariableGlobaleSTD[MEM_LST_ZONE])) { $TabZoneMemoire = array(); $TabVariableGlobaleSTD[MEM_LST_ZONE] = &$TabZoneMemoire; } else { $TabZoneMemoire = &$TabVariableGlobaleSTD[MEM_LST_ZONE]; } $ZoneMemoire = new FMK_ZoneMemoire(); $TabZoneMemoire[utf8_strtolower($sNomZoneMemoire)] = &$ZoneMemoire; $TabVariableGlobaleSTD[MEM_ZONE_COURANTE]= $sNomZoneMemoire; return $ZoneMemoire; } function F485d9571($sNomZone) { global $TabVariableGlobaleSTD; if(isset($TabVariableGlobaleSTD[MEM_LST_ZONE])) { $TabZoneMemoire = &$TabVariableGlobaleSTD[MEM_LST_ZONE]; if(isset($TabZoneMemoire[utf8_strtolower($sNomZone)])) { $TabZoneMemoire[utf8_strtolower($sNomZone)] = null; } } } function F1e1457ab() { global $TabVariableGlobaleSTD; if(isset($TabVariableGlobaleSTD[MEM_LST_ZONE])) { $TabZoneMemoire = &$TabVariableGlobaleSTD[MEM_LST_ZONE]; $TabZoneMemoire = array(); $TabVariableGlobaleSTD[MEM_LST_ZONE] = $TabZoneMemoire; } } function& Fafe98fbc($sNomZone, $bErreurSiInexistant=true) { global $TabVariableGlobaleSTD,$sNomDerniereFonctionMem; $Zone = null; if(!isset($sNomZone) || empty($sNomZone)) { $sNomZone = $TabVariableGlobaleSTD[MEM_ZONE_COURANTE]; } if(utf8_strcasecmp($sNomZone, NOM_DEFAUT_ZONE) == 0) { $Zone = &F543f2856(); } else if(isset($TabVariableGlobaleSTD[MEM_LST_ZONE])) { $TabZoneMemoire = &$TabVariableGlobaleSTD[MEM_LST_ZONE]; if(isset($TabZoneMemoire[utf8_strtolower($sNomZone)])) { $Zone = &$TabZoneMemoire[utf8_strtolower($sNomZone)]; } } if(isset($Zone)) { $TabVariableGlobaleSTD[MEM_ZONE_COURANTE] = $sNomZone; } else if($bErreurSiInexistant) { Erreur('ErreurWL',"ErreurZoneMemoireInexistante", $sNomDerniereFonctionMem); } return $Zone; } function& F543f2856() { global $TabVariableGlobaleSTD; if(isset($TabVariableGlobaleSTD[MEM_LST_ZONE])) { $TabZoneMemoire = &$TabVariableGlobaleSTD[MEM_LST_ZONE]; if(isset($TabZoneMemoire[utf8_strtolower(NOM_DEFAUT_ZONE)])) { $ZoneMemoireDefaut = &$TabZoneMemoire[utf8_strtolower(NOM_DEFAUT_ZONE)]; } } if(!isset($ZoneMemoireDefaut)) { $ZoneMemoireDefaut = &F01435650(NOM_DEFAUT_ZONE); } return $ZoneMemoireDefaut; } class FMK_ZoneMemoire { var $TabValeurs; var $nIndiceParcours = -1; var $bEnDehors = false; var $bTrouve = false; function FMK_ZoneMemoire() { $this->TabValeurs = array(); } function F265229a9($cle, $valeur) { $item = new FMK_ItemZoneMemoire($cle, $valeur); $this->TabValeurs[] = $item; if($this->nIndiceParcours == -1) { $this->nIndiceParcours = 0; } } function F3ad7320f($cle, $valeur, $nIndice) { --$nIndice; if($nIndice >= 0 && $nIndice < count($this->TabValeurs)) { $item = new FMK_ItemZoneMemoire($cle, $valeur); $this->TabValeurs[$nIndice] = $item; } } function F6418f8c0($nIndice) { --$nIndice; if($nIndice >= 0 && $nIndice < count($this->TabValeurs)) { array_splice($this->TabValeurs, $nIndice ,1); if($nIndice < 0 || $nIndice >= count($this->TabValeurs)) { $this->bTrouve = false; $this->bEnDehors = true; } } else { $this->bTrouve = false; $this->bEnDehors = true; } } function Fdf9bd17f($bAscendant) { if($bAscendant) { utf8_usort($this->TabValeurs, array(&$this,"compareItemAsc")); } else { utf8_usort($this->TabValeurs, array(&$this,"compareItemDesc")); } } function compareItemAsc($item1, $item2) { $cle1 = $item1->cle; $cle2 = $item2->cle; if( ! is_string($cle1) ) { if( is_string($cle2) ) { return -1; } if($cle1 < $cle2) { return -1; } return (int)($cle1 > $cle2); } else { if(!is_string($cle2)) { return 1; } return strcmp($cle1,$cle2); } } function compareItemDesc($item1, $item2) { $cle1 = $item1->cle; $cle2 = $item2->cle; if(!is_string($cle1)) { if(is_string($cle2)) { return -1; } if($cle1 > $cle2) { return -1; } return (int)($cle1 < $cle2); } else { if(!is_string($cle2)) { return -1; } return strcmp($cle2,$cle1); } } function Fe551cca4() { $this->TabValeurs = array(); } function getPosition($nIndice) { --$nIndice; return $this->F03d1e301($nIndice); } function F85def1ce() { if($this->nIndiceParcours >= 0 && $this->nIndiceParcours < count($this->TabValeurs)) { $item = $this->TabValeurs[$this->nIndiceParcours]; return $item->cle; } return null; } function getValeur($nIndice) { --$nIndice; if($nIndice >= 0 && $nIndice < count($this->TabValeurs)) { $this->bTrouve = true; $this->bEnDehors = false; $item = $this->TabValeurs[$nIndice]; return $item->valeur; } $this->bTrouve = true; $this->bEnDehors = false; return ""; } function F92375428($valeurRecherche) { $this->bTrouve = false; $this->bEnDehors = false; $nIndex = 0; foreach($this->TabValeurs as $item) { $cle = $item->cle; $valeur = $item->valeur; if(is_numeric($valeurRecherche) && is_numeric($cle) || gettype($cle) == gettype($valeurRecherche)) { if($valeurRecherche == $cle) { $this->bTrouve = true; $this->nIndiceParcours = $nIndex; return $valeur; } } ++$nIndex; } $this->bEnDehors = true; return ""; } function F955a967d($valeurRecherche) { $this->bTrouve = false; $this->bEnDehors = false; $nIndex = 0; foreach($this->TabValeurs as $item) { $valeur = $item->valeur; if(gettype($valeur) == gettype($valeurRecherche)) { if($valeurRecherche == $valeur) { $this->bTrouve = true; $this->nIndiceParcours = $nIndex; return $nIndex + 1; } } ++$nIndex; } $this->bEnDehors = true; return -1; } function F28a0aa6d() { return $this->F03d1e301(0); } function F7cd87865() { return $this->F03d1e301(count($this->TabValeurs) - 1); } function Fc2588602() { return $this->F03d1e301($this->nIndiceParcours + 1); } function F1c6d54cf() { return $this->F03d1e301($this->nIndiceParcours - 1); } function F03d1e301($nPosition) { if(!$this->F371a91e5() && $nPosition >= 0 && $nPosition < count($this->TabValeurs)) { $this->nIndiceParcours = $nPosition; $this->bEnDehors = false; $this->bTrouve = true; $item = $this->TabValeurs[$this->nIndiceParcours]; return $item->valeur; } $this->bEnDehors = true; $this->bTrouve = false; return ""; } function F371a91e5() { return count($this->TabValeurs) == 0; } } class FMK_ItemZoneMemoire { var $cle; var $valeur; function FMK_ItemZoneMemoire($cle, $valeur) { $this->cle = $cle; $this->valeur = $valeur; } } function TableVersTexte($Table, $nOptions=null, $sSeparateur=null, $nLigneDebut=null, $nLigneFin=null, $sSeparateurLigne=null) { if (!isset($nOptions)) $nOptions = taTitreColonnes; if (!isset($sSeparateur)) $sSeparateur = TAB; if (!isset($sSeparateurLigne)) $sSeparateurLigne = RC; $bAvecColonnesInvisibles = false; $bSansTitre = false; $bLigneSelectionnees = false; $bSansTotaux = false; if (Fdef56c7f($nOptions,taAvecColonnesInvisibles)) { $bAvecColonnesInvisibles = true; F27efdc07($nOptions,taAvecColonnesInvisibles); } if (Fdef56c7f($nOptions,taSansTitre)) { $bSansTitre = true; F27efdc07($nOptions,taSansTitre); } else { $bSansTitre = false; F27efdc07($nOptions,taTitreColonnes); } if (Fdef56c7f($nOptions,taSansTotaux)) { $bSansTotaux = true; F27efdc07($nOptions,taSansTotaux); } if (Fdef56c7f($nOptions,taLigneSelectionnees)) { $bLigneSelectionnees = true; F27efdc07($nOptions,taLigneSelectionnees); } if (!empty($nOptions)) { Fe81a7f9e('ERR_PARAMETRE_CONSTANTE_INCORRECTE','FCT_TABLEVERSTEXTE',2, utf8_implode(', ',array( Fc34ec142('CTE_taTitreColonnes'), Fc34ec142('CTE_taAvecColonnesInvisibles'), Fc34ec142('CTE_taSansTitre'), Fc34ec142('CTE_taSansTotaux'), Fc34ec142('CTE_taLigneSelectionnees'), ) ) ); } if (!F1c7c7cae($Table)) { $pclVM =& obtenirVM(); $sNomTable = $pclVM->F67af5b5c(VersChaine($Table)); if (!isset($sNomTable)) { Fe81a7f9e('ERR_CHAMP_INCONNU','FCT_TABLEVERSTEXTE',1,$sNomTable); } $pclChampTable =& F9abbf335($sNomTable,IND_CHAMP); if (!F1c7c7cae($pclChampTable)) { Fe81a7f9e('ERR_TABLE_INCONNUE','FCT_TABLEVERSTEXTE',1,$sNomTable); } } else { $pclChampTable =& $Table; } $nTabOcc = $pclChampTable->GetOccurrence(); $nPremiereLigne = 1; if (isset($nLigneDebut) && ($nLigneDebut>0)) $nPremiereLigne = $nLigneDebut; $nDerniereLigne = $nTabOcc; if (isset($nLigneFin) && ($nLigneFin>0)) $nDerniereLigne = $nLigneFin; if ($nPremiereLigne>$nDerniereLigne) { $b=$nPremiereLigne; $nPremiereLigne=$nDerniereLigne; $nDerniereLigne=$b; unset($b); } if ($nDerniereLigne>$nTabOcc) $nDerniereLigne = $nTabOcc; $sTexte = ''; $nCol = count($pclChampTable->TabColonnes); if (!$bSansTitre) { $bSeparateurNecessaire = false; for ($i=1 ; $i<=$nCol ; $i++) { $pclCol =& $pclChampTable->TabColonnes[$i]; if (!$bAvecColonnesInvisibles && ($pclCol->Visible == 0)) { continue; } $sTitre = $pclCol->m_sTitre; if ($bSeparateurNecessaire) $sTexte.= $sSeparateur; $sTexte.= $sTitre; $bSeparateurNecessaire=true; } } for ($i=$nPremiereLigne ; $i<=$nDerniereLigne ; $i++) { if ($bLigneSelectionnees && (!array_key_exists($i,$pclChampTable->TabSelect) || ($pclChampTable->TabSelect[$i]!=1))) { continue; } if (!empty($sTexte)) $sTexte.= $sSeparateurLigne; $pclLigne =& $pclChampTable->TabLigne[$i]; if (!is_object($pclLigne)) continue; $bSeparateurNecessaire = false; for ($j=1 ; $j<=$nCol ; $j++) { if (!$bAvecColonnesInvisibles && ($pclChampTable->TabColonnes[$j]->Visible == 0)) { continue; } $sValCell = $pclChampTable->GetValII($i,$j); if ($bSeparateurNecessaire) $sTexte.= $sSeparateur; $sTexte.= $sValCell; $bSeparateurNecessaire=true; } } return $sTexte; } function TableVersXML($Table, $sNomFichierXML, $nOptions=null, $nLigneDebut=null, $nLigneFin=null) { return Fb4bc79c6(true,$Table, $sNomFichierXML, $nOptions, $nLigneDebut, $nLigneFin); } function ZoneRepeteeVersXML($Table, $sNomFichierXML, $nOptions=null, $nLigneDebut=null, $nLigneFin=null) { return Fb4bc79c6(false,$Table, $sNomFichierXML, $nOptions, $nLigneDebut, $nLigneFin); } function Fb4bc79c6($bTableVersXML, $Table, $sNomFichierXML, $nOptions=null, $nLigneDebut=null, $nLigneFin=null) { FMK_Charge('WL/XML/XML.php',false); define('TVX_XMLDOC','TableVersXML_DocumentXml'); if (!isset($nOptions)) $nOptions = taTitreColonnes; $bAvecColonnesInvisibles = false; $bSansTitre = false; $bSansTotaux = false; $bLigneSelectionnees = false; $bSansXSL = false; $sNomFonction = $bTableVersXML ? 'FCT_TABLEVERSXML' : 'FCT_ZRVERSXML'; if ($bTableVersXML) { if (Fdef56c7f($nOptions,taAvecColonnesInvisibles)) { $bAvecColonnesInvisibles = true; F27efdc07($nOptions,taAvecColonnesInvisibles); } if (Fdef56c7f($nOptions,taSansTitre)) { $bSansTitre = true; F27efdc07($nOptions,taSansTitre); } if (Fdef56c7f($nOptions,taTitreColonnes)) { $bSansTitre = false; F27efdc07($nOptions,taTitreColonnes); } if (Fdef56c7f($nOptions,taSansTotaux)) { $bSansTotaux = true; F27efdc07($nOptions,taSansTotaux); } if (Fdef56c7f($nOptions,taLigneSelectionnees)) { $bLigneSelectionnees = true; F27efdc07($nOptions,taLigneSelectionnees); } if (Fdef56c7f($nOptions,taSansXSL)) { $bSansXSL = true; F27efdc07($nOptions,taSansXSL); } if (!empty($nOptions)) { Fe81a7f9e('ERR_PARAMETRE_CONSTANTE_INCORRECTE',$sNomFonction,3, utf8_implode(', ',array( Fc34ec142('CTE_taTitreColonnes'), Fc34ec142('CTE_taAvecColonnesInvisibles'), Fc34ec142('CTE_taSansTitre'), Fc34ec142('CTE_taSansTotaux'), Fc34ec142('CTE_taLigneSelectionnees'), Fc34ec142('CTE_taSansXSL'), ) ) ); } } else { if (Fdef56c7f($nOptions,taTitreColonnes)) { $bSansTitre = false; F27efdc07($nOptions,taTitreColonnes); } if (Fdef56c7f($nOptions,taLigneSelectionnees)) { $bLigneSelectionnees = true; F27efdc07($nOptions,taLigneSelectionnees); } if (Fdef56c7f($nOptions,taSansXSL)) { $bSansXSL = true; F27efdc07($nOptions,taSansXSL); } if (!empty($nOptions)) { Fe81a7f9e('ERR_PARAMETRE_CONSTANTE_INCORRECTE',$sNomFonction,3, utf8_implode(', ',array( Fc34ec142('CTE_taTitreColonnes'), Fc34ec142('CTE_taLigneSelectionnees'), Fc34ec142('CTE_taSansXSL'), ) ) ); } } if (!(F1c7c7cae($Table)||Fba68c6f1($Table))) { $pclVM =& obtenirVM(); $sNomTable = $pclVM->F67af5b5c(VersChaine($Table)); if (!isset($sNomTable)) { Fe81a7f9e('ERR_CHAMP_INCONNU',$sNomFonction,1,$sNomTable); } $pclChampTable = F9abbf335($sNomTable,IND_CHAMP); } else { $pclChampTable =& $Table; $sNomTable = $pclChampTable->Nom; } if ( ($bTableVersXML && !F1c7c7cae($pclChampTable)) || (!$bTableVersXML && !Fba68c6f1($pclChampTable)) ) { Fe81a7f9e($bTableVersXML ? 'ERR_TABLE_INCONNUE' : 'ERR_ZR_INCONNUE',$sNomFonction,1,$sNomTable); } $nTabOcc = $pclChampTable->GetOccurrence(); $nPremiereLigne = 1; if (isset($nLigneDebut) && ($nLigneDebut>0)) $nPremiereLigne = $nLigneDebut; $nDerniereLigne = $nTabOcc; if (isset($nLigneFin) && ($nLigneFin>0)) $nDerniereLigne = $nLigneFin; if ($nPremiereLigne>$nDerniereLigne) { $b=$nPremiereLigne; $nPremiereLigne=$nDerniereLigne; $nDerniereLigne=$b; } if ($nDerniereLigne>$nTabOcc) $nDerniereLigne = $nTabOcc; $sNomTable = F56651974($pclChampTable->GetLibelle()); if (empty($sNomTable)&&($sNomTable!='0')) $sNomTable = $pclChampTable->Nom; $nTaille = utf8_strlen($sNomFichierXML); if ( Fbe774e59($sNomFichierXML,$nTaille-3) == '.xml' ) { $sNomFichier = utf8_substr($sNomFichierXML,0,$nTaille-4); } else { $sNomFichier = $sNomFichierXML; } define('XML_DEFAULT_DOCUMENTNAME' ,'WINDEV_TABLE'); $pclDoc = null; F2f7503e2($pclDoc, '<?xml version="1.0" encoding="'.(UNICODE_PAGE_UTF8?'UTF-8':"ISO-8859-1").'" ?>' .(($bSansXSL) ? '' : '<?xml-stylesheet type="text/xsl" href="'.$sNomFichier.'.xsl"?>'). '<'.XML_DEFAULT_DOCUMENTNAME.' />' ); $tabColTitre = array(); { if ($bTableVersXML) { $nCol = count($pclChampTable->TabColonnes); for ($i=1 ; $i<=$nCol ; $i++) { $pclCol =& $pclChampTable->TabColonnes[$i]; if (!$bAvecColonnesInvisibles && ($pclCol->Visible == 0)) { continue; } $sTitre = $pclCol->m_sTitre; if (empty($sTitre)) $sTitre = $pclCol->Nom; $tabColTitre[$i] = F56651974($sTitre); } } else { $nCol = 0; foreach( $pclChampTable->TabAttribut as $sNomAttr => $pclAtt ) { $tabColTitre[ $pclAtt->nIndiceAttribut+1 ] = F56651974($sNomAttr); ++$nCol; } } } $pclDoc->xmlEcrit('/' . XML_DEFAULT_DOCUMENTNAME.'/' . $sNomTable,''); $nLigneExportee = 0; for ($i=$nPremiereLigne ; $i<=$nDerniereLigne ; $i++) { $pclDoc->xmlEcrit('/' . XML_DEFAULT_DOCUMENTNAME.'/' . $sNomTable . '['. ($nLigneExportee+1) .']',''); if ($bLigneSelectionnees) { if ( ($bTableVersXML && (!array_key_exists($i,$pclChampTable->TabSelect) || ($pclChampTable->TabSelect[$i]!=1))) || (!$bTableVersXML && ($i == $pclChampTable->Valeur))) { continue; } } for ($j=1 ; $j<=$nCol ; $j++) { if ($bTableVersXML) { if (!$bAvecColonnesInvisibles && ($pclChampTable->TabColonnes[$j]->Visible == 0)) { continue; } $sValCell = $pclChampTable->GetValII($i,$j); } else { $sValCell = (string)$pclChampTable->GetValAttributHTML($tabColTitre[$j],$i); } $pclDoc->xmlEcrit('/' . XML_DEFAULT_DOCUMENTNAME.'/' . $sNomTable . '['. ($nLigneExportee+1) .']/'.$tabColTitre[$j],$sValCell); } ++$nLigneExportee; } $sChaineXML = $pclDoc->F778e8c6e(); if (!$bSansXSL) { if (utf8_strpos($sChaineXML,'<?xml-stylesheet')===false) { $sChaineXML = utf8_substr($sChaineXML,0,($n=(utf8_strpos($sChaineXML,'?>')+2))) . '<?xml-stylesheet type="text/xsl" href="'.$sNomFichier.'.xsl"?>' . utf8_substr($sChaineXML,$n+1); } $bOK = F7973cde3($sNomFichier.'.xsl',F36d8246b($sNomTable,$tabColTitre,$bSansTitre)); } $bOK = F7973cde3($sNomFichier.'.xml',$sChaineXML) && $bOK; unset($pclDoc); return $bOK; } function fRepParent($sRepBase,$nOptions=null) { $sRepBase = dirname(F9486bf1a($sRepBase)); if (F5f7235e7($nOptions,fCheminRelatif)) { $sRepBase = realpath($sRepBase); } return F8df7b692($sRepBase); } function EntierVersHexa($nEntier, $nTailleMot = 0) { $sChaineHexa = utf8_str_pad(dechex($nEntier),PHP_INT_SIZE*2,'0',STR_PAD_LEFT); if($nTailleMot>0) { for($i=utf8_strlen($sChaineHexa)-1 - $nTailleMot ; $i>=0 ; $i-=$nTailleMot) { $sChaineHexa = utf8_substr($sChaineHexa,0,$i+1) . ' ' . utf8_substr($sChaineHexa,$i+1); } } return utf8_strtoupper($sChaineHexa); } function HexaVersEntier($xHexa) { return hexdec($xHexa); } function F9d2a8c22(&$nTypeCryptageCompression,&$nFormat) { if (!isset($nTypeCryptageCompression)) $nTypeCryptageCompression = 1 + 0; if (!isset($nFormat)) $nFormat = 1; } function F3ef30d44($sChaine,$sMotDePasse,$nTypeCryptageCompression,$nFormat,$sFonctionAppelante=null) { F9d2a8c22($nTypeCryptageCompression,$nFormat); $pclCrypteur =& FMK_CRYPT(); $sErreur = '';$pclCrypteur->F6a15f49c($sErreur); $pclCrypteur->m_sMotDePasse = $sMotDePasse; $Resultat = $pclCrypteur->Fb4468e0c($nTypeCryptageCompression,$sChaine,$nFormat); if ($Resultat===false && $sFonctionAppelante!==null) { Fe81a7f9e($sErreur,$nTypeCryptageCompression,$nFormat,$sFonctionAppelante); return ''; } return $Resultat; } function Ff4de3774($sChaine,$sMotDePasse,$nTypeCryptageCompression,$nFormat,$sFonctionAppelante=null) { F9d2a8c22($nTypeCryptageCompression,$nFormat); $pclCrypteur =& FMK_CRYPT(); $sErreur = '';$pclCrypteur->F6a15f49c($sErreur); $pclCrypteur->m_sMotDePasse = $sMotDePasse; $Resultat = $pclCrypteur->F9c5ce817($nTypeCryptageCompression,$sChaine,$nFormat); if ($Resultat===false && $sFonctionAppelante!==null) { Fe81a7f9e($sErreur,$nTypeCryptageCompression,$nFormat,$sFonctionAppelante); return ''; } return $Resultat; } function CrypteStandard($sMessage, $sCle, $nAlgo=1, $nMode=2, $nRemplissage=1 ) { $pclCrypteur =& FMK_CRYPT(); $nAlgo = $pclCrypteur->F48147400($nAlgo); $bSansIV = $nMode == 1; $nMode = $pclCrypteur->F988988a3($nMode); $iv_size = mcrypt_get_iv_size($nAlgo, $nMode); $iv = mcrypt_create_iv($iv_size, MCRYPT_RAND); $block = mcrypt_get_block_size($nAlgo, $nMode); $pad = $block - (strlen($sMessage) % $block); if ($nRemplissage==1) { $sMessage .= str_repeat(chr($pad), $pad); } else if ($nRemplissage==2) { $sMessage .= str_repeat(chr(0), $pad); } $ciphertext = mcrypt_encrypt($nAlgo, $sCle,$sMessage, $nMode, $iv); $ciphertext = ($bSansIV ? '' : $iv) . $ciphertext; return $ciphertext; } function DecrypteStandard($sMessage, $sCle, $nAlgo=1, $nMode=2, $nRemplissage=1) { $pclCrypteur =& FMK_CRYPT(); $nAlgo = $pclCrypteur->F48147400($nAlgo); $bSansIV = $nMode == 1; $nMode = $pclCrypteur->F988988a3($nMode); $iv_size = mcrypt_get_iv_size($nAlgo, $nMode); $iv = substr($sMessage,0,$iv_size); $sMessageClair = mcrypt_decrypt($nAlgo, $sCle,substr($sMessage,$bSansIV ? 0 : strlen($iv)), $nMode, $iv); $block = mcrypt_get_block_size($nAlgo, $nMode); $pad = ord($sMessageClair[($len = strlen($sMessageClair)) - 1]); return substr($sMessageClair, 0, $len - $pad); } function Crypte($sChaine,$sMotDePasse,$nTypeCryptageCompression=null,$nFormat=null) { return F3ef30d44($sChaine,$sMotDePasse,$nTypeCryptageCompression,$nFormat,'FCT_CRYPTE'); } function Decrypte($sChaine,$sMotDePasse,$nTypeCryptageCompression=null,$nFormat=null) { return Ff4de3774($sChaine,$sMotDePasse,$nTypeCryptageCompression,$nFormat,'FCT_DECRYPTE'); } function fCrypte($sCheminSource,$sCheminDestination,$sMotDePasse,$nTypeCryptageCompression=null,$nFormat=null) { if (!is_file($sCheminSourceACP=F9486bf1a($sCheminSource))) return ''; $sChaineCryptee = F3ef30d44(file_get_contents($sCheminSourceACP),$sMotDePasse,$nTypeCryptageCompression,$nFormat,'FCT_FCRYPTE'); return F7973cde3($sCheminDestination,$sChaineCryptee); } function fDecrypte($sCheminSource,$sCheminDestination,$sMotDePasse,$nTypeCryptageCompression=null,$nFormat=null) { if (!is_file($sCheminSourceACP=F9486bf1a($sCheminSource))) return ''; $sChaineClaire = Ff4de3774(file_get_contents($sCheminSourceACP),$sMotDePasse,$nTypeCryptageCompression,$nFormat,'FCT_FDECRYPTE'); return F7973cde3($sCheminDestination,$sChaineClaire); } function UUEncode($sChaine) { return utf8_convert_uuencode($sChaine); } function UUDecode($sChaine) { return utf8_convert_uudecode($sChaine); } function OpenSSLVerifie($sData,$sSignature,$sCle) { F67cfd262(); $cdependancesPHP = FMK_Dependance(); if (isset($cdependancesPHP)) if (!$cdependancesPHP->F0b5f8f06('openssl')) { return false; } $signature = base64_decode($sSignature); F6b1e3687(); $key = openssl_pkey_get_public($sCle); if (is_resource($key)) { $ok = openssl_verify($sData, $signature, $sCle); openssl_free_key($key); unset($key); } F1e7b0563(); if (!(bool)$ok) { $sErr = F1abae4f0(); while ($err = openssl_error_string()) $sErr.=RC.$err; Fdd46bacf($sErr); return false; } return true; } ?>