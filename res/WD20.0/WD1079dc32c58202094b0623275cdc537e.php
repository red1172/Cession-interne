<?php
//20.0.56.0 WL/HF/RubriqueHF.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 class CRubriqueAnalyse extends CFichierAnalyse { var $sNom = ""; var $sNomBase = ""; var $nType = 0; var $nType_Cle = 0; var $nSens_Parcours = 0; var $nTaille = 0; var $bNull = true; var $bNullSupporte = true; var $BufferParcours = null; var $TabRubCleComp = null; var $ValeurDefaut = null; var $Fichier = null; var $bRubriqueFiltre = false; var $sInfosEtendues = ''; var $LF = ""; var $LFOpen = null; var $NativeType = 0; var $idParcour = null; var $ASType = -1; function CRubriqueAnalyse($sNom ="", $nType =0, $nType_Cle = 0, $nSens_Parcours = 0, $nTaille = 0) { $this->m_nIsXXX |= 1; $this->sNom = $sNom; $this->sNomBase = $sNom; $this->sNomLogique = $sNom; $this->nType = $nType; $this->nType_Cle = $nType_Cle; $this->nSens_Parcours = $nSens_Parcours; $this->nTaille = $nTaille; } function F9047540f() { if (!empty($this->sNomAvecDelimiteurs)) return $this->sNomAvecDelimiteurs; if (!isset($this->Fichier)) { return $this->sNom; } $pclAN = $this->Fichier->Fb56717be(); if (!isset($pclAN)) return $this->sNom; $this->sNomAvecDelimiteurs = $pclAN->F57e42f93($this->sNom); return $this->sNomAvecDelimiteurs; } function& Fb56717be($sNomConnexion = null, $bSansErreur=false) { $nullRetour=null; if (!isset($this->Fichier)) { return $nullRetour; } return $this->Fichier->Fb56717be($sNomConnexion, $bSansErreur); } function& GetType() { return 2; } function setInfosEtendues($data) { $this->sInfosEtendues .= $data; if (($found = utf8_stristr($data, "LF=")) != ""){ $this->LF = utf8_trim(utf8_substr ($found, 3)); } if (($found = utf8_stristr($data, "NATIVETYPE=")) != ""){ $this->NativeType = utf8_substr ($found, 11); } } function Fe37f0136() { $this->raz(); $RAZ = null; $this->Fichier =& $RAZ; $this->bRubriqueFiltre = false; } function F0e4c65d4() { return $this->nType_Cle != NON_CLE; } function F27570670() { return $this->bNullSupporte; } function Fecba8a60() { return ($this->nType_Cle == CLE_PRIMAIRE); } function Fa2afd757() { return ($this->nType == TYPE_ID_AUTO || $this->nType == TYPE_ID_AUTO_4); } function F5c7b90f9() { return ($this->nType == TYPE_MEMO_TEXTE) || ($this->nType == TYPE_MEMO_TEXTE_UNICODE) || ($this->nType == TYPE_MEMO_BINAIRE); } function F7b5edca9() { return ($this->nType >= TYPE_ENTIER_2 && $this->nType <= TYPE_REEL_8) || ($this->nType == TYPE_ENTIER_NON_SIGNE_2) || ($this->nType == TYPE_MONETAIRE) || ($this->nType == TYPE_DECIMAL) || ($this->nType >= TYPE_ID_AUTO && $this->nType <= TYPE_ENTIER_NON_SIGNE_8) || ($this->nType == TYPE_ENTIER_NON_SIGNE_1) || ($this->nType == TYPE_ENTIER_NON_SIGNE_1) || ($this->nType == TYPE_BOOLEEN) || ($this->nType == TYPE_ID_AUTO_4); } function F81d228c1() { return ($this->nType == TYPE_CHAINE || $this->nType == TYPE_MEMO_TEXTE || $this->nType == TYPE_CARACTERE || $this->nType == TYPE_UNICODE || $this->nType == TYPE_MEMO_TEXTE_UNICODE); } function Fbe67fb2c() { return isset($this->TabRubCleComp); } function F19c595c2() { return (F929705c7($this->Fichier) && (!$this->F0e4c65d4() || $this->nSens_Parcours == 0)) || (Feee3b2d5($this->Fichier) && ((($bSens=$this->Fichier->m_clWDRInfo->Fafdb1f0a($this))===true) || (!isset($bSens) && ($this->nSens_Parcours == 0)))) ; } function F805b1e57() { $nVal = 0; switch($this->nType_Cle) { case NON_CLE : $nVal = 2; break; case CLE_AVEC_DOUBLON : $nVal = 4; break; case CLE_UNIQUE : $nVal = 6; break; case CLE_PRIMAIRE : $nVal = 8; break; } if($this->F5c7b90f9() || $this->nType == TYPE_CALCULE) { --$nVal; } elseif ($this->Fa2afd757()) { ++$nVal; } return $nVal; } function Fcc1f14ff($nIdPosition, &$Position) { $BufferParcours = &$this->BufferParcours; if(isset($BufferParcours)) { $BufferParcours->Fcc1f14ff($nIdPosition); $Position->F663363d9($this); } } function F26b5b13e($nIdPosition, $nIdModif) { $BufferParcours = &$this->BufferParcours; if(isset($BufferParcours)) { $BufferParcours->F26b5b13e($nIdPosition, $nIdModif); } } function F24fddaf4($nIdPosition) { $BufferParcours = &$this->BufferParcours; if(isset($BufferParcours)) { $BufferParcours->F24fddaf4($nIdPosition); } } function Fe2fe9bfd($sNomRubrique, $nSens) { if(!isset($this->TabRubCleComp)) { $this->TabRubCleComp = array(); } $this->TabRubCleComp[$sNomRubrique] = $nSens; } function& GetValeur($bFormat = true) { $sRetourParDefaut = ""; $Valeur = ""; if(!isset($this->Fichier->EnregUtilisateur)) { $Enreg = $this->Fichier->F06b47f2e(); $this->Fichier->EnregUtilisateur = $Enreg; } if($this->Fbe67fb2c()) { if(isset($this->TabRubCleComp)) { $TabRub = array_keys($this->TabRubCleComp); $sNomComposante = $TabRub[0]; $Valeur = $this->Fichier->EnregUtilisateur[$sNomComposante]; return $Valeur; } return $sRetourParDefaut; } if(!$this->Fcb7fac30()) { return $sRetourParDefaut; } $Valeur =& $this->F26439a0e(); if($bFormat) { $sRetourParDefaut = $this->F48bb09ec($Valeur); return $sRetourParDefaut; } else { return $Valeur; } } function F48bb09ec($Valeur) { if (!isset($this->Fichier)) { return $Valeur; } if ($Valeur===null && $this->F27570670()) return null; $pclAN = $this->Fichier->Fb56717be(null,true); if (!isset($pclAN)) return $Valeur; return $pclAN->F48bb09ec($this,$Valeur); } function SetValeur($Valeur) { if($this->Fbe67fb2c()) { Erreur('ErreurHF_1_Param',"OperationInterditeCleComposee", $this->sNom); } if(!isset($this->Fichier->EnregUtilisateur)) { $Enreg = $this->Fichier->F06b47f2e(); $this->Fichier->EnregUtilisateur = $Enreg; } if(!$this->Fcb7fac30()) { return; } if ($Valeur===null && $this->F27570670()) { } else { if($this->F7b5edca9()) { switch($this->nType) { case TYPE_BOOLEEN : $Valeur = (boolean)($Valeur); break; case TYPE_ENTIER_NON_SIGNE_1 : case TYPE_ENTIER_NON_SIGNE_2 : case TYPE_ENTIER_NON_SIGNE_4 : $Valeur = abs((int)($Valeur)); break; case TYPE_ENTIER_1 : case TYPE_ENTIER_2 : case TYPE_ENTIER_4 : case TYPE_ID_AUTO_4 : $Valeur = (int)($Valeur); break; case TYPE_REEL_8 : case TYPE_ENTIER_8 : case TYPE_ID_AUTO : $Valeur = (double)($Valeur); break; case TYPE_REEL_4 : $Valeur = (float)($Valeur); break; case TYPE_MONETAIRE : $Valeur = round((double)($Valeur),6); break; case TYPE_DECIMAL : $Valeur = round((double)($Valeur),6); break; default : break; } } elseif($this->F81d228c1()&& ($this->nType != TYPE_MEMO_TEXTE)&& ($this->nType != TYPE_MEMO_TEXTE_UNICODE)) { $Valeur = VersChaine($Valeur); if ( ($this->nTaille>0) && ($this->nTaille<utf8_strlen($Valeur))) { $Valeur = utf8_substr($Valeur,0,$this->nTaille); } } } $xValeurActuel =& $this->F26439a0e(); $pclAN =& $this->Fb56717be(null,true); $xValeurActuel = (isset($pclAN)) ? $pclAN->F137bdb94($this,$Valeur) : $Valeur; } function F9b258a4a() { if(!$this->Fbe67fb2c()) { if(!empty($this->ValeurDefaut)) { return $this->ValeurDefaut; } else { if($this->F7b5edca9()) { return $this->F27570670() ? null : 0; } else if($this->F5c7b90f9()) { return null; } else { return $this->F27570670() ? null : ''; } } } Erreur('ErreurHF_1_Param',"OperationInterditeCleComposee",$this->sNom); return ""; } function raz() { $this->BufferParcours = null; $this->sNomAvecDelimiteurs = null; } function Fa73f5cc0() { switch ($this->nType) { case TYPE_BINAIRE : return utf8_chr(0); case TYPE_BOOLEEN : return '-128'; case TYPE_CARACTERE : return utf8_chr(0); case TYPE_CHAINE : return utf8_chr(0); case TYPE_UNICODE : return utf8_chr(0); case TYPE_DATE : return '1000-01-01'; case TYPE_DATE_HEURE : return '1000-01-01 00:00:00'; case TYPE_DUREE : return Fd7624002('–2147483648'); case TYPE_ENTIER_1 : return '-128'; case TYPE_ENTIER_2 : return '-32768'; case TYPE_ENTIER_4 : return Fd7624002('–2147483648'); case TYPE_ENTIER_8 : return Fd7624002('–9223372036854775808'); case TYPE_ENTIER_NON_SIGNE_1 : return '0'; case TYPE_ENTIER_NON_SIGNE_2 : return '0'; case TYPE_ENTIER_NON_SIGNE_4 : return '0'; case TYPE_ENTIER_NON_SIGNE_8 : return '0'; case TYPE_REEL_4 : return '-3.402823466E+38'; case TYPE_REEL_8 : return '-1.7976931348623157E+308'; case TYPE_HEURE : return '-838:59:59'; case TYPE_ID_AUTO : return '0'; case TYPE_ID_AUTO_4 : return '0'; case TYPE_MEMO_BINAIRE : return 'null'; case TYPE_MEMO_TEXTE : return utf8_chr(0); case TYPE_MEMO_TEXTE_UNICODE: return utf8_chr(0); case TYPE_MONETAIRE : return '-604462909807314587.353087'; case TYPE_DECIMAL : return '-604462909807314587.353087'; default : break; } } function F59cfd421() { switch ($this->nType) { case TYPE_BINAIRE : return utf8_chr(255); case TYPE_BOOLEEN : return '127'; case TYPE_CARACTERE : return utf8_chr(255); case TYPE_CHAINE : return utf8_chr(255); case TYPE_UNICODE : return utf8_chr(255); case TYPE_DATE : return '9999-12-31'; case TYPE_DATE_HEURE : return '9999-12-31 23:59:59'; case TYPE_DUREE : return '2147483647'; case TYPE_ENTIER_1 : return '127'; case TYPE_ENTIER_2 : return '32767'; case TYPE_ENTIER_4 : return '2147483647'; case TYPE_ENTIER_8 : return '9223372036854775807'; case TYPE_ENTIER_NON_SIGNE_1 : return '255'; case TYPE_ENTIER_NON_SIGNE_2 : return '65535'; case TYPE_ENTIER_NON_SIGNE_4 : return '4294967296'; case TYPE_ENTIER_NON_SIGNE_8 : return '18446744073709551615'; case TYPE_REEL_4 : return '3.402823466E+38'; case TYPE_REEL_8 : return '1.7976931348623157E+308'; case TYPE_HEURE : return '838:59:59'; case TYPE_ID_AUTO : return '9223372036854775807'; case TYPE_ID_AUTO_4 : return '2147483647'; case TYPE_MEMO_BINAIRE : return 'null'; case TYPE_MEMO_TEXTE : return utf8_chr(255); case TYPE_MEMO_TEXTE_UNICODE: return utf8_chr(255); case TYPE_MONETAIRE : return '604462909807314587.353087'; case TYPE_DECIMAL : return '604462909807314587.353087'; default : break; } } function F0c01be43($pclAN, $nTypeParcours) { $sResultat = ''; if($this->Fbe67fb2c()) { $nNbComposante = count($this->TabRubCleComp); foreach($this->TabRubCleComp as $nom => $sens) { --$nNbComposante; $sResultat .= $pclAN->F57e42f93($nom); if($nTypeParcours == PARCOURS_PREMIER_SUIVANT && $sens != 0) { $sResultat .= " DESC"; } else if($nTypeParcours == PARCOURS_DERNIER_PRECEDENT && $sens == 0) { $sResultat .= " DESC"; } if($nNbComposante > 0) { $sResultat .= ", "; } } } else { $sResultat = $this->F9047540f(); if($nTypeParcours == PARCOURS_PREMIER_SUIVANT && $this->F0e4c65d4() && $this->nSens_Parcours != 0) { $sResultat .= " DESC"; } else if($nTypeParcours == PARCOURS_DERNIER_PRECEDENT && (!$this->F0e4c65d4() || ($this->F0e4c65d4() && $this->nSens_Parcours == 0))) { $sResultat .= " DESC"; } } return $sResultat; } function& F26439a0e() { if(isset($this->Fichier->EnregUtilisateur[$this->sNom])) { return $this->Fichier->EnregUtilisateur[$this->sNom]; } $tabKeys = array_keys($this->Fichier->EnregUtilisateur); $nKeys = count($tabKeys); for($i=0;$i<$nKeys;$i++) { if (utf8_strcasecmp($tabKeys[$i],$this->sNom)===0) { $this->sNom = $tabKeys[$i]; return $this->Fichier->EnregUtilisateur[$tabKeys[$i]]; } } return null; } function Fcb7fac30() { if(isset($this->Fichier->EnregUtilisateur[$this->sNom])) { return true; } $tabKeys = array_keys($this->Fichier->EnregUtilisateur); $nKeys = count($tabKeys); for($i=0;$i<$nKeys;$i++) { if (utf8_strcasecmp($tabKeys[$i],$this->sNom)===0) { $this->sNom = $tabKeys[$i]; return true; } } return false; } } ?>