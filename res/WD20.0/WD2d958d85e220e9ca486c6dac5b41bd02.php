<?php
//20.0.56.0 IHM/Champ/Saisie/Saisie.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__IHM/Champ/Champ.php')) { define('__INC__IHM/Champ/Champ.php',true); include_once(WB_INCLUDE_PATH.'WD7c939e6867492a5e5416bd4b4327fac0.php'); } if (!defined('__INC__WL/STD/Std.php')) { define('__INC__WL/STD/Std.php',true); include_once(WB_INCLUDE_PATH.'WD576dd879728a6f19b14108fc1d2e88ca.php'); } IHM_Include('CListe'); class CSaisie extends CChamp { var $Masque; var $bChampFormate = false; var $m_bATTNULLSIVIDE = false; var $m_bATTMISEABLANC = false; var $m_sIndication; var $m_pclListeFaaSauveSaisie = null; var $m_bSaisieAssistee = false; var $m_nSaisieAssisteTailleMin = 0; var $m_cszValeurPourSaisieAssistee=''; var $m_nSaisieAssisteFiltre = 31979; var $m_bSaisieAssisteOuvertureAutomatique = true; var $m_bSaisieAssisteSansCasse = true; var $m_nSaisieAssisteDelai = 0; function CSaisie() { parent::CChamp(); $this->Valeur = ''; $this->Masque = 0; $this->bTypeSaisieTexte = true; } function F12828e6d( $eTypeVue) { return $this->F0198de68('CVueChampSaisie_Web' , $eTypeVue); } function Fd2c2cc01() { return false; } function SetATTNULLSIVIDE($b) { $this->m_bATTNULLSIVIDE = $b; $this->F21766077(); } function SetATTMISEABLANC($b) { $this->m_bATTMISEABLANC = $b; $this->F21766077(); } function Fdc05d49f( $ValeurHTTP ) { $this->SetValeur($ValeurHTTP); } function& GetIndication() { return $this->m_sIndication; } function GetIndicationHTML() { return $this->GetIndication(); } function SetIndication($sIndication) { F67cfd262(); if (!is_string($sIndication)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_PROP_SET"),$sIndication,Fc34ec142("PROP_NOM_INDICATION"))); } else { $this->m_sIndication = $sIndication; if (Feef890d7()) { F4c16799e($this->m_sNomPHP,XML_CHAMP_PROP_NUM_INDICATION); } } } function SetValeur($NewVal) { $NewVal=(string)$NewVal; switch ($this->Masque) { case '2': $NewVal = utf8_strtoupper($NewVal); break; case '18': $NewVal = utf8_strtoupper(F03771b65($NewVal)); break; case '3': $NewVal = utf8_strtolower($NewVal); break; case '1': $NewVal = utf8_ucfirst($NewVal); break; default: ; } parent::SetValeur($NewVal); $this->F21766077(); } function& GetValeur() { $this->F21766077(); return $this->Valeur ; } function F21766077() { ; if (($this->GetType()!=20001) && $this->m_bATTMISEABLANC) { if ($this->Valeur == 0) { $this->Valeur = ''; } } if ($this->m_bATTNULLSIVIDE) { if ($this->Valeur == '') { $this->Valeur = null; } } } function F37bb1c9f($Valeur) { $this->Valeur = (string)($Valeur); $this->F21766077(); } function GetValeurHTML( $TypeConvertion = 0 ) { if ($TypeConvertion==2) return $this->GetValeurAffichee(); return utf8_htmlentities( $this->GetValeurAffichee() ); } function& GetType() { return getRef(20001); } function SetChampFormate($bChampFormate) { $this->bChampFormate = $bChampFormate; } function F4a917fa4() { if($this->bChampFormate) { return 10; } return 2; } function& Fccb308bb() { $sNomGlobal = uniqid($this->m_sNomPHP . '_'); $GLOBALS[$sNomGlobal] = null; $GLOBALS[$sNomGlobal]=&CreerChamp('CListe'); $pclListeFaaSauveSaisie =& $GLOBALS[$sNomGlobal]; global $MaPage; $MaPage->WB_AjouteChamp(($pclListeFaaSauveSaisie->Nom=uniqid($this->Nom)),uniqid('ALIAS'),$pclListeFaaSauveSaisie,$sNomGlobal); $pclListeFaaSauveSaisie->lierVM($MaPage->Nom,$pclListeFaaSauveSaisie->Nom,$sNomGlobal); $pclListeFaaSauveSaisie->m_bInterne = true; if (!empty($this->sFichierBase)) $pclListeFaaSauveSaisie->SetSourceRemplissage($this->sFichierBase,$this->sRubriqueBase,$this->sRubriqueBase,$this->sRubriqueBase,true,'',0); return $pclListeFaaSauveSaisie; } function& F4470825e() { return $this->m_pclListeFaaSauveSaisie; } function& F36eecfce() { if ($this->F4470825e() === null) { $this->m_pclListeFaaSauveSaisie =& $this->Fccb308bb(); } return $this->F4470825e(); } function F15eb06d2() { if (false !== $this->m_bSaisieAssistee) { $cszValeurPourSaisieAssistee = null; if (false === ($this->m_cszValeurPourSaisieAssistee=='')) { $cszValeurPourSaisieAssistee = $this->m_cszValeurPourSaisieAssistee; } else { $cszValeurPourSaisieAssistee = $this->Valeur; } if (utf8_strlen($cszValeurPourSaisieAssistee) < max($this->m_nSaisieAssisteTailleMin, 1)) return false; return (F4fc992ba($this)!==null) && !$this->bMultiLiaison && ($this->RubriqueLiaison->F0e4c65d4() || (isset($this->FichierLiaison)&&isset($this->FichierLiaison->bEstUneRequete)&&$this->FichierLiaison->bEstUneRequete)); } else { return false; } } function F05bc6f05($rcszValeurPourSaisieAssistee) { $this->m_cszValeurPourSaisieAssistee = $rcszValeurPourSaisieAssistee; $this->F36eecfce(); Fd057c510($this, CONTENU_WEB); } function Fdff5b8e3() { if (false !== $this->F15eb06d2()) { $clValeur = null; if (false === ($this->m_cszValeurPourSaisieAssistee=='')) { $clValeur = $this->m_cszValeurPourSaisieAssistee; $this->m_cszValeurPourSaisieAssistee=''; } else { $clValeur = $this->GetValeur(); } $pclChampListePourFaaSauveSaisie =& $this->F36eecfce(); if ($pclChampListePourFaaSauveSaisie->sValeurRecherche !== $clValeur) { $pclChampListePourFaaSauveSaisie->sValeurRecherche = $clValeur; if ($pclChampListePourFaaSauveSaisie->bInitLiaison) $pclChampListePourFaaSauveSaisie->ListeAffiche(); else $pclChampListePourFaaSauveSaisie->InitRemplissage(); } } } function F75f16a43() { $pclChampListePourFaaSauveSaisie =& $this->F36eecfce(); if (isset($pclChampListePourFaaSauveSaisie)) { return $pclChampListePourFaaSauveSaisie->ListeOccurrence(); } else { return 0; } } function pszGetContenuHTML() { return $this->F6107e7bd(false,true); } function F6107e7bd($bContenu, $bPropriete) { $sRetour = '<SAISIEA'; if (false !== $bPropriete) { $sRetour .= ' FILTRE="' . $this->m_nSaisieAssisteFiltre . '" OUVERTUREAUTO="' . $this->m_bSaisieAssisteOuvertureAutomatique . '" TAILLEMIN="' . $this->m_nSaisieAssisteTailleMin . '" DELAI="' . $this->m_nSaisieAssisteDelai . '" SANSCASSE="' . $this->m_bSaisieAssisteSansCasse . '"' ; } $sRetour .='>'; if (false !== $bContenu) { $pclChampListePourFaaSauveSaisie =& $this->F4470825e(); if (null !== $pclChampListePourFaaSauveSaisie) { $this->Fdff5b8e3(); $sRetour .= $pclChampListePourFaaSauveSaisie->Fec2dc3df(true,true); } } return $sRetour . '</SAISIEA>'; } function SaisieAssisteeSupprimeTout() { Fd057c510($this, CONTENU_WEB); if (!isset($this->m_pclListeFaaSauveSaisie)) return; $this->m_pclListeFaaSauveSaisie->ListeSupprimeTout(); } function SaisieAssisteeAjoute($pszTexte) { Fd057c510($this, CONTENU_WEB); if ($this->F36eecfce() === null) return NUMLIGNE_INVALIDE; if (!isset($this->m_pclListeFaaSauveSaisie)) return NUMLIGNE_INVALIDE; $this->m_pclListeFaaSauveSaisie->ListeAjoute($pszTexte); return $this->m_pclListeFaaSauveSaisie->ListeOccurrence(); } function SaisieAssisteeParametre($nParametre, $pclValeur) { $bInterditSiSaisieAssisteeLiaisonDonnees = false; switch ($nParametre) { case 0: case 4: $bInterditSiSaisieAssisteeLiaisonDonnees = true; break; } $bErreurValeur = false; switch ($nParametre) { case 0: { $nFiltre = (false == $pclValeur) ? false : intval($pclValeur); if ((is_numeric($pclValeur) && ($nFiltre >= 31978) && ($nFiltre <= 31989)) || (false === $nFiltre)) { $this->m_nSaisieAssisteFiltre = $nFiltre; } else { $bErreurValeur = true; } } break; case 1: { if (is_bool($pclValeur)) { $this->m_bSaisieAssisteOuvertureAutomatique = (bool)$pclValeur; } else { $bErreurValeur = true; } } break; case 2: { $nTailleMin = intval($pclValeur); if (is_numeric($pclValeur) && $nTailleMin>=0) { $this->m_nSaisieAssisteTailleMin = $nTailleMin; } else { $bErreurValeur = true; } } break; case 3: { $nDelai = intval($pclValeur); if (is_numeric($pclValeur) && $nDelai>=0) { $this->m_nSaisieAssisteDelai = $nDelai; } else { $bErreurValeur = true; } } break; case 4: { if (is_bool($pclValeur)) { $this->m_bSaisieAssisteSansCasse = (bool)$pclValeur; } else { $bErreurValeur = true; } } break; default: Fb9eb0792('ERR_BAD_CONSTANT', $nParametre); return; } if (false !== $bErreurValeur) { Fb9eb0792('ERR_BAD_CONSTANT_STR', 3, (string)$pclValeur); return; } Fd057c510($this, PROP_INVALID_MIN); } } class CVueChampSaisie_Web extends CVueChamp_Web { function CVueChampSaisie_Web (&$pclModele) { parent::CVueChamp_Web($pclModele); } function F1f68ed08($clPropCodeHTML,&$rclResultat,&$rpczResultatStatique) { switch ($clPropCodeHTML->Fc30871c3()) { case PARTIE_CODEHTML_SAISIEASSISTEE_CONTENU: { $pclModele =& $this->m_pclModele; $pclModele->Fdff5b8e3(); $nNbElements = $pclModele->F75f16a43(); if ($nNbElements===0) return true; $clParametres = new CJSOn(); $pclListe =& $pclModele->F4470825e(); if ($pclListe==null) return true; for($nElement=1; $nElement<=$nNbElements; ++$nElement) { $eDernier = ($nElement<$nNbElements) ? DERNIER_NON : DERNIER_OUI; $pclLigne =& $pclListe->GetValI($nElement); $clParametres->Fba367465(null, $eDernier, ENCODAGE_CHAINE_HTML, $pclLigne->GetValeur()); } $rclResultat = $clParametres->F8b686221(); return true; } case PARTIE_CODEHTML_SAISIEASSISTEE_PARAMETRES: $this->Fe301d84b($rclResultat); return true; default: return parent::F1f68ed08($clPropCodeHTML, $rclResultat, $rpczResultatStatique); } } function Fe301d84b(&$rstValeur) { $pclModele =& $this->m_pclModele; $rstValeur = ( '.data("saisieassistee-' . 'filtre' . '",' . ($pclModele->m_nSaisieAssisteFiltre == false ? '0' : $pclModele->m_nSaisieAssisteFiltre) . ')' . '.data("saisieassistee-' . 'ouvertureauto' . '",' . ($pclModele->m_bSaisieAssisteOuvertureAutomatique ? '1' : '0') . ')' . '.data("saisieassistee-' . 'taillemin' . '",' . ($pclModele->m_nSaisieAssisteTailleMin) . ')' . '.data("saisieassistee-' . 'delai' . '",' . ($pclModele->m_nSaisieAssisteDelai) . ')' . '.data("saisieassistee-' . 'sanscasse' . '",' . ($pclModele->m_bSaisieAssisteSansCasse ? '1' : '0') . ')'); } } class CSaisieFormat extends CSaisie { var $FormatMemorise; var $FormatDefaut; function CSaisieFormat() { parent::CSaisie(); $this->FormatMemorise=null; $this->FormatDefaut=null; } function Fb560a68a($dwFlags) { parent::Fb560a68a($dwFlags); if ($this->FormatMemorise === '' && $this->Masque != '') { $this->FormatMemorise = $this->Masque; } } function F16d5955d() { return $this->GetValeurHTML(); } function& GetFormatMemorise() { return $this->FormatMemorise; } function SetFormatMemorise($sValeur) { $this->FormatMemorise = $sValeur; } function Fb9088766($pszMemorise) { } function F3355e5f9($pszValeur) { } function F301cc296($pszValeur) { } function F6e84afe6($pszAffichee) { } function Ff11ff472($xValeurAffichee) { if ($xValeurAffichee==='') return ''; return $this->F3355e5f9($this->F6e84afe6($xValeurAffichee)); } function& GetValeurAffichee() { if ($this->Valeur==='') { $retour = ''; } else { if ($this->FormatMemorise == $this->Masque) { return $this->Valeur; } if ($this->Masque == szMASKDATEHEURE_DUREEERELATIVE) { $sFormatMem = $this->FormatMemorise; $this->FormatMemorise = 'AAAAMMJJHHmmSS'; } $retour = $this->F301cc296($this->Fb9088766( $this->Valeur ) ); if ($this->Masque == szMASKDATEHEURE_DUREEERELATIVE) { $this->FormatMemorise = $sFormatMem; } } return $retour; } function Fdc05d49f( $ValeurHTTP ) { $this->Valeur = ($ValeurHTTP=='') ? '' : $this->F6e84afe6( $ValeurHTTP ); $this->F21766077(); if ($this->Valeur!==null && $this->FormatMemorise != $this->FormatDefaut) $this->Valeur = $this->F3355e5f9( $this->Valeur ); } function SetValeur($sValeur) { parent::SetValeur($sValeur); $this->F21766077(); if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEURAFFICHEE); } } } class CSaisieDuree extends CSaisieFormat { var $Masque; function CSaisieDuree() { parent::CSaisieFormat(); $this->Masque = "+2J j HH:MM:SS:CC"; $this->FormatDefaut = "JHHMMSSLLL"; } function Fb9088766($pszMemorise) { $pclDuree = ChaineVersDuree( $pszMemorise, $this->FormatMemorise ); $sRetour = GetValeur($pclDuree); unset($pclDuree); return $sRetour; } function F3355e5f9($pszValeur) { return DureeVersChaine( $pszValeur, $this->FormatMemorise ); } function F301cc296($pszValeur) { return DureeVersChaine( $pszValeur, $this->Masque ); } function F6e84afe6($pszAffichee) { if ($this->GetValeurAffichee() !== $pszAffichee) { $pclDuree = ChaineVersDuree( $pszAffichee, $this->FormatMemorise ); $sRetour = GetValeur($pclDuree); unset($pclDuree); return $sRetour; } else { return $this->Fb9088766($this->Valeur); } } function& GetType() { return getRef(20006); } function& F1e21db15() { $t = TYPEWL_DUREE; return $t; } } class CSaisieRiche extends CSaisie { function CSaisieRiche() { parent::CSaisie(); } function Fd2c2cc01() { return true; } } ?>