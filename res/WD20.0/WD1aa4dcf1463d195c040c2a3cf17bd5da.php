<?php
//20.0.56.0 IHM/Champ/Calendrier/ChampCalendrier.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__FMK/Date/Duree.php')) { define('__INC__FMK/Date/Duree.php',true); include_once(WB_INCLUDE_PATH.'WD6d1d70fd32a89f3c5df66eb4471caef2.php'); } if (!defined('__INC__FMK/Date.php')) { define('__INC__FMK/Date.php',true); include_once(WB_INCLUDE_PATH.'WD97af71f4453b9d548e8ff90b4bbaba9f.php'); } define('CALLBACK_COMPARE_EVENEMENTS', 'F6d092d5d'); function IHM_Calendrier_VueChamp_SauveContexte(&$projet) { $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER'] = array(); global $CGenerationJours_ms_tabEtatStyle; $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['CGenerationJours_ms_tabEtatStyle'] = $CGenerationJours_ms_tabEtatStyle; global $CInterfEXE_ms_tabCadrageHorizontal; $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['CInterfEXE_ms_tabCadrageHorizontal'] = $CInterfEXE_ms_tabCadrageHorizontal; global $CInterfEXE_ms_tabCadrageVertical; $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['CInterfEXE_ms_tabCadrageVertical'] = $CInterfEXE_ms_tabCadrageVertical; global $clGetTableauJourFerie; $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['clTabJoursFeries'] = $clGetTableauJourFerie; } F0ce8ab0e('IHM_Calendrier_VueChamp_SauveContexte'); function IHM_Calendrier_VueChamp_RestaureContexte(&$projet) { if (isset($projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER'] )){ global $CGenerationJours_ms_tabEtatStyle; $CGenerationJours_ms_tabEtatStyle = $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['CGenerationJours_ms_tabEtatStyle']; global $CInterfEXE_ms_tabCadrageHorizontal; $CInterfEXE_ms_tabCadrageHorizontal = $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['CInterfEXE_ms_tabCadrageHorizontal']; global $CInterfEXE_ms_tabCadrageVertical; $CInterfEXE_ms_tabCadrageVertical = $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['CInterfEXE_ms_tabCadrageVertical']; global $clGetTableauJourFerie; $clGetTableauJourFerie = $projet->TabVarGlobaleInterneComposante['IHM_CHAMP_CALENDRIER']['clTabJoursFeries']; } } F493cdf66('IHM_Calendrier_VueChamp_RestaureContexte'); if (!defined('__INC__FMK/Date.php')) { define('__INC__FMK/Date.php',true); include_once(WB_INCLUDE_PATH.'WD97af71f4453b9d548e8ff90b4bbaba9f.php'); } if (!defined('__INC__FMK/Date/Duree.php')) { define('__INC__FMK/Date/Duree.php',true); include_once(WB_INCLUDE_PATH.'WD6d1d70fd32a89f3c5df66eb4471caef2.php'); } if (!defined('__INC__FMK/Compat/xsystem.php')) { define('__INC__FMK/Compat/xsystem.php',true); include_once(WB_INCLUDE_PATH.'WD14183cc5dbbd843da831afdd3bf106e4.php'); } if (!defined('__INC__FMK/Compat/winbase.php')) { define('__INC__FMK/Compat/winbase.php',true); include_once(WB_INCLUDE_PATH.'WD09f2bc3afcb1ee8c84caff6287ba9e87.php'); } if (!defined('__INC__IHM/Champ/Calendrier/DateTime.php')) { define('__INC__IHM/Champ/Calendrier/DateTime.php',true); include_once(WB_INCLUDE_PATH.'WD8a3f9ea956942dad24d3a1c8d98a8330.php'); } define('OPTIONCALENDRIER_MULTISELECTION', 0x00000001); define('OPTIONCALENDRIER_BTNAUJOURDHUI', 0x00000000); define('OPTIONCALENDRIER_DIMANCHEPREMIER', 0x00000004); define('OPTIONCALENDRIER_HORSMOISSELECT', 0x00000008); define('OPTIONCALENDRIER_HORSMOISSTYLE', 0x00000010); define('OPTIONCALENDRIER_HORSMOISMASQUE', 0x00000020); define('OPTIONCALENDRIER_PERIODE', 0x00000040); if (!defined('__INC__IHM/Champ/Champ.php')) { define('__INC__IHM/Champ/Champ.php',true); include_once(WB_INCLUDE_PATH.'WD7c939e6867492a5e5416bd4b4327fac0.php'); } if (!defined('__INC__IHM/Champ/Calendrier/DateCalendrier.php')) { define('__INC__IHM/Champ/Calendrier/DateCalendrier.php',true); include_once(WB_INCLUDE_PATH.'WD58850ba95413725990434524615e6324.php'); } if (!defined('__INC__IHM/Champ/Calendrier/StyleCalendrier.php')) { define('__INC__IHM/Champ/Calendrier/StyleCalendrier.php',true); include_once(WB_INCLUDE_PATH.'WD41cfbe1a285c20c7394586a4ea0efef5.php'); } if (!defined('__INC__IHM/Champ/Calendrier/IVueChampCalendrier.php')) { define('__INC__IHM/Champ/Calendrier/IVueChampCalendrier.php',true); include_once(WB_INCLUDE_PATH.'WD74ad99bc83a9d6ec7fe0b1f73a629e9a.php'); } define('OBJ_DESACTIVE_CALENDRIER_MULTISELECTION',true); define('OBJ_DESACTIVE_CALENDRIER_CHOIXMOIS',true); define('ETATJOUR_NORMAL', 0x00000000); define('ETATJOUR_LIGNEIMPAIRE', 0x00000001); define('ETATJOUR_LIGNEPAIRE', 0x00000002); define('ETATJOUR_HORSMOIS', 0x00000004); define('ETATJOUR_HORSBORNES', 0x00000008); define('ETATJOUR_DIMANCHE', 0x00000010); define('ETATJOUR_SAMEDI', 0x00000020); define('ETATJOUR_AUJOURDHUI', 0x00000040); define('ETATJOUR_SELECTION', 0x00000080); define('ETATJOUR_FERIE', 0x00000100); define('NBSEMAINES_MOIS_MAX', 6); define('NBJOURS_SEMAINE', 7); define('eCalAucuneZone' , 0); define('eCalBtnMoisPrecedent' , 1); define('eCalBtnMoisSuivant' , 2); define('eCalNomMois' , 3); define('eDateDuJour' , 4); define('eCalJour' , 5); define('eCalJourHorsBorne' , 6); define('eCalJourMoisSuivant' , 7); define('eCalJourMoisPrecedent' , 8); define('eCalBtnAujourdhui' , 9); define('eCalExterieur' , 10); if (!defined('OBJ_DESACTIVE_CALENDRIER_CHOIXMOIS')) { define('eCalAucuneZone' , 11); define('eCalAucuneZone' , 12); } define('nNUMJOUR_DIMANCHE', 0); define('nNUMJOUR_SAMEDI', 6); if (!defined('__INC__IHM/CompoObjConst.php')) { define('__INC__IHM/CompoObjConst.php',true); include_once(WB_INCLUDE_PATH.'WD491e0f4a2e48dd39cd8c7caa2a6eddf4.php'); } if (!defined('__INC__IHM/Champ/Calendrier/JourCalendrier.php')) { define('__INC__IHM/Champ/Calendrier/JourCalendrier.php',true); include_once(WB_INCLUDE_PATH.'WD5d79653321bdc15d8bd9d52759e1f00a.php'); } if (!defined('__INC__IHM/Champ/Calendrier/JourFerie.php')) { define('__INC__IHM/Champ/Calendrier/JourFerie.php',true); include_once(WB_INCLUDE_PATH.'WD1d1424df371535a642661fa2921b61c1.php'); } if (!defined('__INC__IHM/Champ/Calendrier/VueChampCalendrier_Web.php')) { define('__INC__IHM/Champ/Calendrier/VueChampCalendrier_Web.php',true); include_once(WB_INCLUDE_PATH.'WD7af4218739108935f33a95497319587a.php'); } if (!defined('__INC__IHM/Champ/Calendrier/ControleurChampCalendrier_Web.php')) { define('__INC__IHM/Champ/Calendrier/ControleurChampCalendrier_Web.php',true); include_once(WB_INCLUDE_PATH.'WDb7daa91ec22368985423be878e90f31c.php'); } define('nFLAGLIT_DEFAUT', 0); define('nFLAGLIT_NOREFRESH', 1); define('nFLAGLIT_POURTOUS', 2); class CAccesDirectGeneralise { var $m_piChampDest; var $m_bInitOK = false; var $m_pclIHFContext = null; var $nNbTotalEnreg = 0; function CAccesDirectGeneralise() { } function F0ba1fe8f(&$piChampDest, $nFlag, &$pclContexteHF) { $this->m_bInitOK = false; if (!$this->F28f23a53($piChampDest, $nFlag, $pclContexteHF )) { return false; } $this->m_bInitOK = true; if (!$this->F57b905e6()) { return false; } return true; } function F784b9d7b() { if ($this->m_piChampDest === null) return false; return $this->m_piChampDest->Fa1b569ab(); } function F9ad43ee4() { if ($this->m_piChampDest === null) return false; return !$this->m_piChampDest->Fa1b569ab(); } function F57b905e6() { if ($this->m_piChampDest === null) return false; if ($this->F784b9d7b()) { return true; } if ($this->F9ad43ee4()) { if ($this->m_pclIHFContext === null) return false; return $this->Fce6d4e97(nFLAGLIT_DEFAUT); } return false; } function Fce6d4e97($nFlagLit) { $nIndex = 0; $pclChampDest =& $this->m_piChampDest; $bAvecPCodeFiltre = (ExecuteTraitement($pclChampDest->m_sNomPHP,TRT_Filtre_Page,false,true)===true); $bAvecPCodeAffLigne = (ExecuteTraitement($pclChampDest->m_sNomPHP,trtAffichageLigne,false,true)===true); if( $bAvecPCodeFiltre || (!$pclChampDest->Fd4c80e66($nIndex) || !$pclChampDest->Fd4c80e66($nIndex+$pclChampDest->F7b66f7f8())) ) { if($bAvecPCodeFiltre || ($pclChampDest->nLastPosition == -1)) { $this->nNbTotalEnreg = $pclChampDest->FichierParcours->F7f79f122(0, $pclChampDest->sValeurRecherche, $pclChampDest->RubriqueParcours, true); if(!empty($pclChampDest->sValeurRecherche)) { $pclChampDest->FichierParcours->Fd7f91600($pclChampDest->RubriqueParcours, array($pclChampDest->sValeurRecherche)); } $this->nNbTotalEnreg = $pclChampDest->FichierParcours->F7f79f122(0, '', $pclChampDest->RubriqueParcours, true); $pclChampDest->FichierParcours->Fa84e48aa($pclChampDest->RubriqueParcours, $pclChampDest->bParcoursAsc, H_RESPECTE_FILTRE); $nNbEnregLu = 0; if ($bAvecPCodeFiltre) { while($pclChampDest->FichierParcours->bHTrouve) { if (!$pclChampDest->F689fe026() || ($bAvecPCodeFiltre&&($pclChampDest->Fb40d01a9($nIndex+$nNbEnregLu+1) != nFILTRE_OK) ) ) { --$this->nNbTotalEnreg; } $pclChampDest->FichierParcours->Fec3a1557($pclChampDest->RubriqueParcours, $pclChampDest->bParcoursAsc); ++$nNbEnregLu; } $nNbEnregLu = 0; $pclChampDest->FichierParcours->Fa84e48aa($pclChampDest->RubriqueParcours, $pclChampDest->bParcoursAsc, H_RESPECTE_FILTRE); } } else { Fe4e65a90($pclChampDest->nLastPosition,0); if($nIndex > $pclChampDest->nLastIndex) { $pclChampDest->FichierParcours->Fec3a1557($pclChampDest->RubriqueParcours, $pclChampDest->bParcoursAsc, $nIndex - $pclChampDest->nLastIndex); } else if($nIndex < $pclChampDest->nLastIndex) { $pclChampDest->FichierParcours->Fec3a1557($pclChampDest->RubriqueParcours, !$pclChampDest->bParcoursAsc, $pclChampDest->nLastIndex - $nIndex); } } $nNbEnregLu = 0; if($pclChampDest->FichierParcours->bHTrouve) { $pclChampDest->nLastPosition = $pclChampDest->FichierParcours->Fd172163b($pclChampDest->RubriqueParcours); $pclChampDest->nLastIndex = $pclChampDest->nFirstIndex; } $nIndiceLigne = $nIndex; $nNbEnregUtilises = 0; $nNbEnregPrecedent = 0; if (isset($pclChampDest->nLimiteChargementMemoire)) { $nMaxLignes = $pclChampDest->nLimiteChargementMemoire; } elseif (isset($pclChampDest->Reglette)) $nMaxLignes = $pclChampDest->nMaxLignePage; else $nMaxLignes = 0; while($pclChampDest->FichierParcours->bHTrouve && ($pclChampDest->nMaxLignePage == 0 || $nMaxLignes == 0 || $nNbEnregUtilises < $nMaxLignes)) { if ($pclChampDest->F689fe026()) { $nResFiltre = $bAvecPCodeFiltre ? $pclChampDest->Fb40d01a9($nIndex+$nNbEnregLu+1) : nFILTRE_OK; if ($nResFiltre == nFILTRE_FIN) { break; } elseif ($nResFiltre == nFILTRE_OK) { if ($bAvecPCodeFiltre && $nNbEnregPrecedent<$nIndex) { ++$nNbEnregPrecedent; } else { $nSauvePosition = $pclChampDest->FichierParcours->Fd172163b($pclChampDest->RubriqueParcours); $pclChampDest->TabPosition[$nIndiceLigne + 1] = $nSauvePosition; ++$nIndiceLigne; if (-1 !== $pclChampDest->F5ffae798($pclChampDest->F3de60b01($pclChampDest->FichierParcours),$nSauvePosition,-1)) { ++$nNbEnregUtilises; } if ($bAvecPCodeAffLigne)$pclChampDest->Fbe50ddf6($nIndiceLigne); } } } if ($nMaxLignes == 0 || $nNbEnregUtilises < $nMaxLignes) { $pclChampDest->FichierParcours->Fec3a1557($pclChampDest->RubriqueParcours, $pclChampDest->bParcoursAsc); ++$nNbEnregLu; } } if (isset($pclChampDest->nLimiteChargementMemoire)&&($nMaxLignes>0)) { $this->nNbTotalEnreg = min($nMaxLignes,$nNbEnregUtilises); } } if(isset($pclChampDest->TabPosition[$nIndex + 1])) { Fe4e65a90($pclChampDest->TabPosition[$nIndex + 1], H_RP_CONSERVE); } return true; } function F28f23a53(&$piChampDest, $nFlag, &$pclIHFContext) { $this->m_piChampDest =& $piChampDest; $this->m_pclIHFContext =& $pclIHFContext; $bSourceEstDino = $this->m_piChampDest->Fa1b569ab(); $this->F2ed4e73b(); if (($pclIHFContext===null) && !$bSourceEstDino) { return false; } if ($bSourceEstDino) { return false; } if(Feee3b2d5($this->m_piChampDest->FichierParcours)) { if(!$this->m_piChampDest->FichierParcours->bInit || Fdef56c7f($nFlag,8)) { global $sLastFunction; $sLastFunction = ""; $bInitOK = $this->m_piChampDest->FichierParcours->F08193936("",array()); } else { $bInitOK = true; } } else { $bInitOK = true; } if (!$bInitOK) { return false; } XVERIFY( $this->m_piChampDest->F7f821e68() ); $czNomFichier = is_object($this->m_piChampDest->FichierParcours) ? $this->m_piChampDest->FichierParcours->sNom : ''; $czRubTri = is_object($this->m_piChampDest->RubriqueParcours) ? $this->m_piChampDest->RubriqueParcours->sNom : ''; if ( ($czNomFichier === '') || ($czRubTri === '') ) { $this->m_bInitOK = false; return false; } if (!$this->m_piChampDest->FichierParcours->F33a5022b('')) { return false; } return true; } function F2ed4e73b() { $this->m_bInitOK = false; } function F9159144d($nNumElemToDel) { if ($nNumElemToDel<0) return; if (!$this->m_bInitOK) return; if ($this->m_piChampDest === null) return; if ( F5f7235e7( $this->m_piChampDest->m_nActionAutoriseeBase, nACTSRC_SUPPR )) return; if ($this->F9ad43ee4()) { $this->Fc8bfb7cd($nNumElemToDel); } } function Fc8bfb7cd($nNumElemModif) { if ($this->m_pclIHFContext === null) return false; $pclFichierParcourt =& $this->m_piChampDest->FichierParcours; $hPosElement = -1; $nStatusRP = $this->m_piChampDest->Fa96f8906( $nNumElemModif, $hPosElement ); switch ($nStatusRP) { case 0: return false; case 1: Fe4e65a90($hPosElement,H_RP_CONSERVE); $pclFichierParcourt->EnregCourant = array($this->m_piChampDest->RubriqueParcours->sNom => $pclFichierParcourt->EnregCourant[$this->m_piChampDest->RubriqueParcours->sNom]); break; case 2: break; default: return false; } if (!$pclFichierParcourt->F8ca9a29d(0)) { return false; } return true; } function F4cad654a($nNumElemModif) { if ($this->m_pclIHFContext === null) return false; $pszFichierParcourt = $this->m_piChampDest->FichierParcours->sNom; $hPosElement = -1; $nStatusRP = $this->m_piChampDest->Fa96f8906( $nNumElemModif, $hPosElement ); switch ($nStatusRP) { case 0: return false; case 1: Fe4e65a90($hPosElement, H_RP_CONSERVE); break; case 2: break; default: return false; } return true; } function F271fa184( $hPos ) { if ($hPos === -1) { return false; } if ($this->m_pclIHFContext === null) { return false; } $bRes = Fbd3b8aac($hPos); if (!$bRes) { } else { } return $bRes; } function F457f1b52($nNumElemNew) { if ($nNumElemNew<0) return true; if (!$this->m_bInitOK) return true; if ($this->m_piChampDest === null) return true; if ( F5f7235e7( $this->m_piChampDest->m_nActionAutoriseeBase , nACTSRC_AJOUT )) return true; if ($this->F9ad43ee4()) { return $this->Fcbcf2370($nNumElemNew); } return true; } function Fcbcf2370($nNumElemNew) { if ($this->m_pclIHFContext === null) return false; $pclFichierParcourt =& $this->m_piChampDest->FichierParcours; $this->m_piChampDest->F77cc9fa2( $nNumElemNew ); if (!$pclFichierParcourt->F08a30ecf(H_AFFECTE_PARCOURS)) { return false; } $clTabclVal = array(); $this->m_piChampDest->Fa87e84c7( $clTabclVal, null, 0); $hPos = $pclFichierParcourt->Fd172163b($this->m_piChampDest->RubriqueParcours); $bOkModif = $this->m_piChampDest->F8ec1b7af($nNumElemNew, $clTabclVal,null, $hPos, -1); return $bOkModif; } function F783c0b63($nNumElemModif) { if ($nNumElemModif<0) return false; if (!$this->m_bInitOK) return true; if ($this->m_piChampDest === null) return false; if ( F5f7235e7( $this->m_piChampDest->m_nActionAutoriseeBase, nACTSRC_MODIF )) return true; $bOK=false; if ($this->F9ad43ee4()) { $bOK=$this->F769452c9($nNumElemModif); } return $bOK; } function F769452c9($nNumElemModif) { if ($this->m_pclIHFContext === null) return false; $pclFichierParcourt =& $this->m_piChampDest->FichierParcours; $hPosElement = -1; $nStatusRP = $this->m_piChampDest->Fa96f8906( $nNumElemModif, $hPosElement ); switch ($nStatusRP) { case 0: return false; case 1: Fe4e65a90($hPosElement,H_RP_CONSERVE); break; case 2: break; default: return false; } $this->m_piChampDest->F77cc9fa2( $nNumElemModif); if (!$pclFichierParcourt->F3f143f5b(H_AFFECTE_PARCOURS)) { return false; } return true; } } define('CALENDRIER_BORNEMIN_MIN',"00010101"); define('CALENDRIER_BORNEMIN_MAX',"99991231"); define('cSEPARATEUR_LETTRE_JOUR',';'); define('cSEPARATEUR_MOIS',';'); define('szFORMATMEMCALENDRIER_DEFAUT','AAAAMMJJ'); function& F264709eb(&$_this,$MEMBRE) { return $_this->m_pclStyle->{$MEMBRE}; } function& F349cf082(&$_this,$MEMBRE) { return _clone( $_this->m_pclStyle->{$MEMBRE} ); } class stOPTIONSCOULEUR extends stSTRUCTURE { var $m_bPrincipale = false; var $m_bTransformeAutomatique = false; } class stINFOJOUR extends stSTRUCTURE { var $eEtat; var $nNumero; var $pclJour; var $szDate; } function Fad518364() { $tabInfoJours = array_fill(0,NBSEMAINES_MOIS_MAX * NBJOURS_SEMAINE,new stINFOJOUR()); if (PHPVERSION_5) $tabInfoJours = array_map('_clone',$tabInfoJours); return $tabInfoJours; } define('nNUMELEMENT_INVALIDE', ((int)-1)); define('nFROM_PROP', 0x00); define('nFROM_CONTROLEUR', 0x01); define('nFROM_DELSEL', 0x02); define('nFROM_ADDNEW', 0x03); define('nFROM_FONC', 0x04); class CGestMonoSelection extends CChamp { var $m_nElemSelect = nNUMELEMENT_INVALIDE; function Fc3b3ab43($nNumElemt, $nFlag, $pclElement) { if ($this->m_nElemSelect != nNUMELEMENT_INVALIDE) $this->Fd9e88f73( $this->m_nElemSelect, false ); $this->m_nElemSelect = $nNumElemt; if ($nNumElemt !== -1) $this->Fd9e88f73( $nNumElemt, true ); if ($nFlag === nFROM_CONTROLEUR) { $this->F325a961e(); } } function F5c14ecc7() {return $this->m_nElemSelect;} function F4e7e3d4a($nElement) { return ($this->m_nElemSelect!==nNUMELEMENT_INVALIDE) && ($nElement===$this->m_nElemSelect); } function Fd9e88f73($nNumElemt, $bSelection) { } function F325a961e() { } } class CChampCalendrier extends CGestMonoSelection { var $m_dwOptions; var $m_clBorneMin; var $m_clBorneMax; var $m_czFormatAffichageMois; var $m_czLettreJoursSemaine; var $m_czLibelleAujourdhui; var $m_clValeur; var $m_clJours; var $m_clMoisCourant; var $m_clAujourdhui; var $m_eModeAffichage; var $m_piInfoLangue; var $m_tabLettreJoursSemaine = array(); var $m_czImageFond; var $m_nNumJour1erCol; var $m_czFormatMemorise; var $m_clMoisCourantZR; function& Fca04e360() { return $this->m_nNumJour1erCol; } function F7e337dc2( $clDate, $nCauseMois) { $this->F8d64b6cf($clDate, CAUSE_CLIC, $nCauseMois); } function F817a2aae() { $new = new CDateCalendrier(); $this->F8d64b6cf($new, CAUSE_CLIC, nCHANGEMOIS_AUJOURDHUI); $this->Fc1a6d5f6( TRT_ClicBoutonCalendrier ); } function& Fe8ac5465() { return $this->m_czLibelleAujourdhui; } function Fe97bffda() { return $this->m_czLettreJoursSemaine; } function F0fd18d85( $pszLettres) { $this->m_czLettreJoursSemaine = $pszLettres; } function Fae9dac1d( $pszLibelle) { $this->m_czLibelleAujourdhui = $pszLibelle; } function Fc2b10dbe( &$pczResultat) { $pczResultat = ''; $this->F6df1f874($this->m_clMoisCourant, $this->m_czFormatAffichageMois, $pczResultat); } function Feb661866() { return ID_CALENDRIER; } function pszGetMoisCourant () { return $this->m_clMoisCourant->F09992612(); } function F2d291cd8() { $this->m_pclStyle = new CStyleCalendrier(); return isset($this->m_pclStyle) ? NOERROR : E_FAIL; } function CChampCalendrier() { parent::CChamp(); $this->m_dwOptions=0; $this->m_clBorneMin=new CDateCalendrier(""); $this->m_clBorneMax=new CDateCalendrier(""); $this->m_czFormatAffichageMois='MMMM AAAA'; $this->m_czLettreJoursSemaine= ''; $this->m_czLibelleAujourdhui=''; $this->m_clValeur = new CDateCalendrier(); $this->m_clJours=array(); $this->m_clMoisCourant= new CDateCalendrier(); $this->m_clAujourdhui= new CDateCalendrier(); $this->m_eModeAffichage=MODEAFFICHAGE_JOURS; $this->m_piInfoLangue=null; $this->m_nNumJour1erCol= 1; $this->m_czFormatMemorise=szFORMATMEMCALENDRIER_DEFAUT; $this->m_clMoisCourantZR = new CDateCalendrier(''); $this->m_tabLettreJoursSemaine=array_fill(0,NbJourParSemaine,"\0"); $this->m_clMoisCourant->F7b946724(1); $this->m_dwOptions = OPTIONCALENDRIER_HORSMOISSELECT | OPTIONCALENDRIER_BTNAUJOURDHUI; $this->F12f87182(); } function& vpclGetElementStyleCadreLibelle ( $eElement, $tabCouleurPrincipale = null ) { if (isset($tabCouleurPrincipale)) { $rstOptionsCouleur =& $tabCouleurPrincipale[0]; } else $rstOptionsCouleur=null; switch ($eElement) { case ELEMENTSTYLE_CALENDRIER_JOURBASE: if (isset($rstOptionsCouleur)) $rstOptionsCouleur->m_bPrincipale = true; return $this->m_pclStyle->m_clJourBase; case ELEMENTSTYLE_CALENDRIER_JOURSELECTION: return $this->m_pclStyle->m_clJourSelection; case ELEMENTSTYLE_CALENDRIER_JOURAUJOURDHUI: return $this->m_pclStyle->m_clJourAujourdhui; case ELEMENTSTYLE_CALENDRIER_JOURSAMEDI: return $this->m_pclStyle->m_clJourSamedi; case ELEMENTSTYLE_CALENDRIER_JOURDIMANCHE: return $this->m_pclStyle->m_clJourDimanche; case ELEMENTSTYLE_CALENDRIER_JOURHORSBORNES: return $this->m_pclStyle->m_clJourHorsBornes; case ELEMENTSTYLE_CALENDRIER_JOURHORSMOIS: return $this->m_pclStyle->m_clJourHorsMois; case ELEMENTSTYLE_CALENDRIER_JOURLIGNEPAIR: return $this->m_pclStyle->m_clJourLignePair; case ELEMENTSTYLE_CALENDRIER_JOURLIGNEIMPAIR: return $this->m_pclStyle->m_clJourLigneImpair; case ELEMENTSTYLE_CALENDRIER_JOURFERIE: return $this->m_pclStyle->m_clJourFerie; case ELEMENTSTYLE_CALENDRIER_BTNAUJOURDHUI: return $this->m_pclStyle->m_clBtnAujoudhui; case ELEMENTSTYLE_CALENDRIER_LIBJOURSEMAINE: return $this->m_pclStyle->m_clLibJoursDeLaSemaine; case ELEMENTSTYLE_CALENDRIER_BTNSUIVPREC: return $this->m_pclStyle->m_clBtnSuivanPrecedent; case ELEMENTSTYLE_CALENDRIER_LIBMOIS: return $this->m_pclStyle->m_clLibMois; default: return parent::vpclGetElementStyleCadreLibelle($eElement, $rstOptionsCouleur); } } function F1a3c1834() { foreach ($this->m_clJours as $Index => $pclDate) { $this->m_clJours[$Index] = null; } $this->m_clJours=array(); } function F06ce55c7( $dwOptions, $bEtat) { Ffe2e63ad($this->m_dwOptions, $dwOptions, $bEtat); } function Fd762c94a( $dwOptions) { return F44b84d9d($this->m_dwOptions, $dwOptions); } function Fb560a68a( $dwFlags) { $this->F3c0ec437(); parent::Fb560a68a($dwFlags); } function Fb3dcf02b( $dwFlags) { $this->m_clValeur->F7f6d730f(); CChamp::Fb3dcf02b($dwFlags); if ($this->m_clValeur->F2c185292() == false) { $clDateCourante = new CDateCalendrier(); $clValeur = $clDateCourante->F09992612(); $this->SetValeur($clValeur); } $bUpdateContenu = false; if (count($this->m_clJours,COUNT_NORMAL) == 0) { $this->F1a3c1834(); $bUpdateContenu = true; } if ($this->Fd7c1b120() != false) { $bUpdateContenu = true; } if ($this->m_eModeAffichage != MODEAFFICHAGE_JOURS) { $this->m_eModeAffichage = MODEAFFICHAGE_JOURS; $bUpdateContenu = true; } if ($bUpdateContenu != false) { $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } return true; } function F12f87182() { if (Fb9e14d9b(parent::F12f87182())) return E_FAIL; return NOERROR; } function F405f2daf( $nIndice, &$pclErreur) { $czDate = $nIndice . ''; $clDate = new CDateCalendrier( $czDate ); if ($clDate->F2c185292()) { $pclDate =& $this->F00139942( $czDate ); return $pclDate->Fe6ae3e7c(); } Fdd46bacf(Fc34ec142('ERR_DATE_INDICE')); return null; } function F30919d3e($pszName, $eTypeRech) { switch ($eTypeRech) { case RECH_CHILDDIRECT: { $pclDate =& $this->F00139942($pszName); if (isset($pclDate)) return $pclDate; } break; default: if ($this->F01181feb($pszName)) return $this; break; } return parent::F30919d3e($pszName, $eTypeRech); } function& F5e48655c() { $pclMaVue =& $this->Faee05823(); if (isset($pclMaVue)) { $piVueChamp =& $pclMaVue->Fe6f7fbc2(); if (isset($piVueChamp)) { return $piVueChamp->Fc12fc07f(); } } $null = null; return $null; } function F147854c1( $pszDate) { $clDate = new CDateCalendrier( $pszDate ); $nNumMois = $clDate->nGetMois(); $clNumMoisCourant = $this->Fed58e9ca(); $nNumMoisCourant = $clNumMoisCourant->nGetMois(); if ($nNumMois != $nNumMoisCourant) { return false; } return true; } function& Fed58e9ca() { return $this->m_clMoisCourant; } function& F5c059d5f() { $this->m_clAujourdhui->Ff04c7c3b(); return $this->m_clAujourdhui; } function& F933f08b4() { return $this->m_clBorneMin; } function& F6b05823e() { return $this->m_clBorneMax; } function bBoutonEstGrise( $eZone) { if ($eZone == eCalBtnMoisPrecedent) { $bPrecedentPossible = true; $clGetBorneMin =& $this->F933f08b4(); if ($clGetBorneMin->F2c185292()) { $clGetMoisCourant =& $this->Fed58e9ca(); $bPrecedentPossible = ($clGetMoisCourant->Ff5b208cb( $clGetBorneMin ) > 0); } return !$bPrecedentPossible; } else { $clMoisSuivant =& _clone( $this->Fed58e9ca() ); $clMoisSuivant->F828394a6(1); $bSuivantPossible = true; $clBorneMax =& $this->F6b05823e(); if ($clBorneMax->F2c185292()) $bSuivantPossible = ($clMoisSuivant->Ff5b208cb($clBorneMax) <= 0); return !$bSuivantPossible; } return false; } function Fe7b01919( $ePropriete, &$pclJour, $nParam=null) { $piVueCalendrier = $this->F5e48655c(); if (isset($piVueCalendrier)) { if ($this->F147854c1($pclJour->F09992612()) != false) { $piVueCalendrier->F45e104ce($ePropriete, $pclJour, $nParam); } } } function& F00139942( $pszDate) { $clDate = new CDateCalendrier($pszDate); if ($clDate->F2c185292() == false) return null; $pclJour = null; if ( ($key = array_search($clDate->F09992612(),$this->m_clJours)) !== false) { $pclJour =& $this->m_clJours[$key]; return $pclJour; } $pclJour = new CJourCalendrier(); $pclJour->Fa43dce56($this,$clDate); $this->m_clJours[$pclJour->F09992612()] =& $pclJour; return $pclJour; } function F12828e6d( $eTypeVue) { return $this->F0198de68('CVueChampCalendrier_Web',$eTypeVue); } function F56660bf0( $eTypeControleur) { return $this->Fea7a1f04('CControleurChampCalendrier_Web',$eTypeControleur); } function F58848eb2( $piInfoLangue) { if ($piInfoLangue != $this->m_piInfoLangue) { if (isset($this->m_piInfoLangue)) { } $this->m_piInfoLangue = $piInfoLangue; if (isset($this->m_piInfoLangue)) { } } } function Ffeba3ab7() { if (!isset($this->m_piInfoLangue)) return null; return $this->m_piInfoLangue; } function F0217da74($nRang, &$pclDate) { if ($nRang == 0) { $pclDate = $this->m_clValeur; return true; } return false; } function F282bf1c2( $nIndice) { if (!$this->m_clValeur->F2c185292()) return ""; return $this->m_clValeur->F09992612(); } function F2ff57b28() { if ($this->m_clValeur->F2c185292() == false) return 0; return 1; } function F8d64b6cf( &$clSelection, $nCause, $nCauseMois) { $this->m_clValeur->Fea34dd7d($clSelection); $this->Fd5256ded($clSelection, $nCause, $nCauseMois); } function Fa0bec7db() { } function Fd5256ded( &$clJour, $nCause, $nCauseMois) { $this->F836f402a(); if (Fa6be8d6f($nCause)) { $this->Fc1a6d5f6(TRT_SelectionJour); } if (Fa6be8d6f($nCause)) { $this->Fa0bec7db(); } $this->F2120308c($clJour, $nCauseMois); $this->F6fb6d0cf(PROP_INVALID_MIN); } function F2120308c( &$clDate, $nCause ) { if (!$this->m_clValeur->F2c185292()) return; $pclZR = null; $this->F6ce2b314($pclZR); if (isset($pclZR) && ($pclZR->m_nLigneAffichee > 0)) { return; } if ( ($this->m_clMoisCourant->nGetMois() != $clDate->nGetMois()) || ($this->m_clMoisCourant->nGetAnnee() != $clDate->nGetAnnee()) ) { $clMoisCourantAvant = _clone($this->m_clMoisCourant); $this->m_clMoisCourant = $clDate; $this->m_clMoisCourant->F7b946724(1); $this->Fe8472ccc($nCause, $clMoisCourantAvant, $this->m_clMoisCourant ); } if (isset($pclZR)) { $this->m_clMoisCourantZR = _clone($this->m_clMoisCourant); } } function Fc0c6509d( &$clJour) { if ($clJour->Ff5b208cb($this->m_clValeur) == 0) return true; return false; } function Fbe6dd7f7( $pszlJour) { if ($pszlJour == '') return false; $clDate = new CDateCalendrier( $pszlJour ); return $this->Fc0c6509d( $clDate ); } function Feb869ee3() { $clMoisCourantAvant = _clone($this->m_clMoisCourant); switch ($this->m_eModeAffichage) { case MODEAFFICHAGE_JOURS: $this->m_clMoisCourant->F828394a6(-1); break; default: } $this->Fe8472ccc(nCHANGEMOIS_PRECEDENTUSER, $clMoisCourantAvant, $this->m_clMoisCourant); } function F8e55546c() { $clMoisCourantAvant = _clone( $this->m_clMoisCourant ); switch ($this->m_eModeAffichage) { case MODEAFFICHAGE_JOURS: $this->m_clMoisCourant->F828394a6(+1); break; default: } $this->Fe8472ccc(nCHANGEMOIS_SUIVANTUSER, $clMoisCourantAvant, $this->m_clMoisCourant ); } function Ffee126a9( $nDecalage) { if (!$this->m_clValeur->F2c185292()) { if (!$this->m_clMoisCourant->F2c185292()) return; $this->F7e337dc2($this->m_clMoisCourant, nCHANGEMOIS_CHOIXMOIS); return; } $clDateNew = new CDateCalendrier( $this->m_clValeur ); $clDateNew->F820be7fb($nDecalage); $this->F7e337dc2($clDateNew, nCHANGEMOIS_CLAVIER); } function F573a60c8() { $this->Ffee126a9(1); } function F9d649b3b() { $this->Ffee126a9(-1); } function Fb9019c1c() { $this->Ffee126a9( NBJOURS_SEMAINE ); } function Fa532d160() { $this->Ffee126a9( -NBJOURS_SEMAINE ); } function Fe8472ccc( $nCause, $clMoisAvant, $clMoisApres ) { $this->Fd7c1b120(); switch ($nCause) { case nCHANGEMOIS_SUIVANTUSER: case nCHANGEMOIS_PRECEDENTUSER: case nCHANGEMOIS_AUJOURDHUI: case nCHANGEMOIS_CHOIXMOIS: case nCHANGEMOIS_CLAVIER: $this->Fc1a6d5f6(TRT_ChangementMois); break; } $this->Fc1a6d5f6(TRT_AffichageMois); $piVueCalendrier =& $this->F5e48655c(); if (isset($piVueCalendrier )) { $piVueCalendrier->Ff21e9a2d( $nCause, $clMoisAvant->F09992612() , $clMoisApres->F09992612() ); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function F43597a4b( $nJour) { if ($nJour < 0) return 0; if ($nJour >= NBJOURS_SEMAINE) return 0; return $this->m_tabLettreJoursSemaine[$nJour]; } function F6df1f874( &$clDate, $pszFormat, &$pczResultat) { $clMasqueDate = new CMasqueDateHeure($pszFormat,true); if (isset($this->m_piInfoLangue)) $clMasqueDate->F58848eb2($this->m_piInfoLangue); $clMasqueDate->F407a3c7c($clDate->F09992612(), $pczResultat); } function SetNum1erJourAffiche( $nNumJour) { if ($nNumJour<0) { $nNumJour = 0; } if ($nNumJour>6) { $nNumJour = 6; } $this->m_nNumJour1erCol = $nNumJour; $this->F3c0ec437(); $this->F3c2a17e3( VUEMODIF_UPDATECONTENU ); } function F6a7414dc( $pszJour) { $clJour = new CDateCalendrier($pszJour); $stInfoJour = new stINFOJOUR(); $stInfoJour->eEtat=ETATJOUR_NORMAL; $stInfoJour->nNumero=$clJour->nGetJour(); $pclMoisCourant =& $this->Fed58e9ca(); $nJourDebutMois = $pclMoisCourant->F4c110548(); $nNumJour1er = $this->Fca04e360(); $nJourDebutMois = F15c6af90( $nJourDebutMois, -$nNumJour1er ); if ($nJourDebutMois == 0) $nJourDebutMois = 7; $nSemaine = ($nJourDebutMois + $clJour->nGetJour() - 1) / NBJOURS_SEMAINE; if (($nSemaine % 2) == 0) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_LIGNEIMPAIRE); } else { F9c19fb37($stInfoJour->eEtat, ETATJOUR_LIGNEPAIRE); } if ($clJour->Ff5b208cb($pclMoisCourant) < 0) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_HORSMOIS); } else { $clMoisSuivant = _clone($pclMoisCourant); $clMoisSuivant->F828394a6(1); if ($clJour->Ff5b208cb($clMoisSuivant) >= 0) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_HORSMOIS); } } if (!$this->F55c117fc($clJour)) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_HORSBORNES); } switch ($clJour->F4c110548()) { case 0: F9c19fb37($stInfoJour->eEtat, ETATJOUR_DIMANCHE); break; case 6: F9c19fb37($stInfoJour->eEtat, ETATJOUR_SAMEDI); break; } $clAujourdui = _clone( $this->F5c059d5f() ); if ($clJour->Ff5b208cb($clAujourdui) == 0) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_AUJOURDHUI); } if ($this->Fc0c6509d($clJour)) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_SELECTION); } if ( $this->F1e306ff3($clJour->F09992612()) ) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_FERIE); } $stInfoJour->pclJour =& $this->F96c19afe( $clJour ); return $stInfoJour; } function Fee67e05f( $eZone, &$clJour) { if ($eZone == eCalJour) { $pclJour =& $this->F96c19afe($clJour); if ((isset($pclJour)) && ($pclJour->m_sBulle!='') ) { return $pclJour->m_sBulle; } } return $this->m_sBulle; } function F6ce2b314(&$pclZR) { $pclChampConteneur =& $this->m_pclChampConteneur; $pclChampParent =& $this->m_pclChampParent; $pclZR = null; if ( (isset($pclChampConteneur) && Fba68c6f1($pclChampConteneur)) ) { $pclZR = $pclChampConteneur; return false; } elseif (isset($pclChampParent) && ($pclChampParent->GetType() === 20002) && (isset($pclChampParent->m_pclChampConteneur)) && Fba68c6f1($pclChampParent->m_pclChampConteneur)) { $pclZR = $pclChampParent->m_pclChampConteneur; return true; } return null; } function F8b6fb5ae( $ePropriete, $nouvelle, $nLigneZR=null, $sNomAttributZR=null) { switch(utf8_strtoupper($ePropriete)) { case "VALEUR": { $pclZR = null; $this->F6ce2b314($pclZR); { if (isset($this->m_clMoisCourantZR) && ($this->m_clMoisCourantZR->F09992612()!='')) { $this->m_clMoisCourant = _clone($this->m_clMoisCourantZR); $nouvelle = $this->m_clMoisCourantZR->F09992612(); } if (isset($nLigneZR)) { $SCRIPT_PARAMS = F19b65b78(); $sAliasChampDuClic = isset($SCRIPT_PARAMS['WD_CONTEXTE_']) ? $SCRIPT_PARAMS['WD_CONTEXTE_'] : $SCRIPT_PARAMS['WD_BUTTON_CLICK_']; if ($sAliasChampDuClic == $this->Alias) { $nLigneDuClic = $SCRIPT_PARAMS[$pclZR->Alias]; if ($nLigneDuClic == $nLigneZR) { if (isset($SCRIPT_PARAMS['ACTIONCHAMP'])) $sAction=$SCRIPT_PARAMS['ACTIONCHAMP']; else $sAction = isset($SCRIPT_PARAMS['CLICCALENDRIER']) ? $SCRIPT_PARAMS['CLICCALENDRIER'] : $SCRIPT_PARAMS['WD_ACTION_']; $this->m_clMoisCourant->F43a2e5ec($pclZR->TabSauvegardeProp[$nLigneZR][$sNomAttributZR]->m_szDate); $this->m_pclVue->m_nBloqueUpdate = 1; switch ($sAction) { case 'CALENDRIERAUJO': $this->F817a2aae(); break; case 'CALENDRIERPREC'; $this->Feb869ee3(); break; case 'CALENDRIERSUIV': $this->F8e55546c(); break; default: $this->F7e337dc2(new CDateCalendrier($nouvelle), nCHANGEMOIS_SANSUSER); } $this->m_pclVue->m_nBloqueUpdate = 0; } } } $this->m_clMoisCourantZR = null; return _clone(new CDateCalendrier($nouvelle)); } } break; default: break; } } function Fbae54012($x, $ePropriete) { switch(utf8_strtoupper($ePropriete)) { case "VALEUR": $pclZR = null; $this->F6ce2b314($pclZR); { if (is_object($x)) { $this->m_clMoisCourant = new CDateCalendrier(utf8_substr($x->F09992612(),0,6) . '01' ); } else { $this->m_clMoisCourant = new CDateCalendrier(''); } } break; default: break; } } function F835e9af9( &$stInfoMois) { $nNumJour1er = $this->Fca04e360(); $nJourSamedi = F15c6af90( nNUMJOUR_SAMEDI, -$nNumJour1er); $nJourDimanche = F15c6af90(nNUMJOUR_DIMANCHE, -$nNumJour1er); $pclMoisCourant =& $this->Fed58e9ca(); $nPlacePremierMois = $pclMoisCourant->F4c110548(); $nPlacePremierMois = F15c6af90( $nPlacePremierMois, -$nNumJour1er); if ($nPlacePremierMois == 0) $nPlacePremierMois = 7; $nPlaceDernierMois = $nPlacePremierMois + $pclMoisCourant->F15ca4863() - 1; $nOffsetDebutPlage = $nPlacePremierMois - $pclMoisCourant->Fc734cbfe(); $nPlaceBorneMin = INT_MIN; $pclBorneMin =& $this->F933f08b4(); $pclBorneMax =& $this->F6b05823e(); if ($pclBorneMin->F2c185292()) $nPlaceBorneMin = $nOffsetDebutPlage + $pclBorneMin->Fc734cbfe(); $nPlaceBorneMax = INT_MAX; if ($pclBorneMax->F2c185292()) $nPlaceBorneMax = $nOffsetDebutPlage + $pclBorneMax->Fc734cbfe(); $pclAujh =& $this->F5c059d5f(); $nPlaceAujourdhui = $nOffsetDebutPlage + $pclAujh->Fc734cbfe(); $clMoisPrecedent = _clone( $pclMoisCourant ); $clMoisPrecedent->F828394a6(-1); $nOffSetJoursMoisPrecedent = $clMoisPrecedent->F15ca4863() - $nPlacePremierMois + 1; $clMoisSuivant = _clone( $pclMoisCourant ); $clMoisSuivant->F828394a6(1); for ($nSemaine = 0; $nSemaine < NBSEMAINES_MOIS_MAX; $nSemaine++) { $dwEtatSemaine = (($nSemaine % 2) == 0) ? ETATJOUR_LIGNEIMPAIRE : ETATJOUR_LIGNEPAIRE; for ($nJour = 0; $nJour < NBJOURS_SEMAINE; $nJour++) { $nNumJour = $nSemaine * NBJOURS_SEMAINE + $nJour; $stInfoJour =& $stInfoMois[$nNumJour]; $stInfoJour->eEtat = ETATJOUR_NORMAL; $stInfoJour->nNumero = -1; $stInfoJour->pclJour = null; $stInfoJour->szDate = ''; F9c19fb37($stInfoJour->eEtat, $dwEtatSemaine); if ($nJour == $nJourDimanche){ F9c19fb37($stInfoJour->eEtat, ETATJOUR_DIMANCHE); } else if ($nJour == $nJourSamedi) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_SAMEDI); } if ($nNumJour < $nPlacePremierMois) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_HORSMOIS); if ($this->Fd762c94a(OPTIONCALENDRIER_HORSMOISMASQUE) == false) { $stInfoJour->nNumero = $nOffSetJoursMoisPrecedent + $nNumJour; $clJour = _clone($clMoisPrecedent); $clJour->F7b946724($stInfoJour->nNumero); if ($this->Fd762c94a(OPTIONCALENDRIER_HORSMOISSELECT) != false) Fc5d10cc7($stInfoJour->szDate, $clJour->F09992612(), sizeof($stInfoJour->szDate)); if ($this->Fd762c94a(OPTIONCALENDRIER_HORSMOISSTYLE) != false) $stInfoJour->pclJour = $this->F96c19afe($clJour); } } else if ($nNumJour > $nPlaceDernierMois) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_HORSMOIS); if ($this->Fd762c94a(OPTIONCALENDRIER_HORSMOISMASQUE) == false) { $stInfoJour->nNumero = $nNumJour - $nPlaceDernierMois; $clJour = _clone($clMoisSuivant); $clJour->F7b946724($stInfoJour->nNumero); if ($this->Fd762c94a(OPTIONCALENDRIER_HORSMOISSELECT) != false) Fc5d10cc7($stInfoJour->szDate, $clJour->F09992612(), sizeof($stInfoJour->szDate)); if ($this->Fd762c94a(OPTIONCALENDRIER_HORSMOISSTYLE) != false) $stInfoJour->pclJour = $this->F96c19afe($clJour); } } else { $stInfoJour->nNumero = ($nNumJour - $nPlacePremierMois) + 1; $clJour = _clone( $pclMoisCourant); $clJour->F7b946724($stInfoJour->nNumero); Fc5d10cc7($stInfoJour->szDate, $clJour->F09992612(), sizeof($stInfoJour->szDate)); $stInfoJour->pclJour = $this->F96c19afe($clJour); } if (($nNumJour < $nPlaceBorneMin) || ($nNumJour > $nPlaceBorneMax)) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_HORSBORNES); $stInfoJour->szDate = ''; } if ($nNumJour == $nPlaceAujourdhui) F9c19fb37($stInfoJour->eEtat, ETATJOUR_AUJOURDHUI); if (F548dbb0a($stInfoJour->szDate)) { F9c19fb37($stInfoJour->eEtat, ETATJOUR_FERIE); } if ($this->Fcb3f463f() || $this->F15b7cc2d()) $stInfoJour->szDate = ''; } } $this->F0fdf739f($this->m_clValeur, $nOffsetDebutPlage, $stInfoMois); return NBSEMAINES_MOIS_MAX; } function& F96c19afe( &$clJour) { $pclJour = null; foreach ($this->m_clJours as $Key => $clItem){ if ($clJour->Ff5b208cb(getRef($clItem->F09992612()))==0){ $pclJour =& $this->m_clJours[$Key]; break; } } return $pclJour; } function F0fdf739f( $clJour, $nOffsetDebutPlage, &$stInfoMois) { $nPlaceJour = $nOffsetDebutPlage + $clJour->Fc734cbfe(); if (($nPlaceJour >= 0) && ($nPlaceJour < (NBSEMAINES_MOIS_MAX * NBJOURS_SEMAINE))) F9c19fb37($stInfoMois[$nPlaceJour]->eEtat, ETATJOUR_SELECTION); } function F17389cba( $clDate ) { $clDate1erJour = _clone($clDate); $clDate1erJour->F7b946724(1); if ($this->F55c117fc($clDate1erJour)) return false; $clDateDernierJour = _clone( $clDate ); $clDateDernierJour->F7b946724( $clDate->F15ca4863() ); if ($this->F55c117fc($clDateDernierJour)) return false; return true; } function F55c117fc( $clDate ) { if (XVER_DEBUG){ $clDateCopie = _clone($clDate); $bDateOK_DBG = !$clDateCopie->F9c5b5dfc( $this->F933f08b4(), $this->F6b05823e() ); } $pclBorneMin =& $this->F933f08b4(); $pclBorneMax =& $this->F6b05823e(); if ( ($pclBorneMin->F2c185292() && $clDate->Ff5b208cb($pclBorneMin) < 0) || ($pclBorneMax->F2c185292() && $clDate->Ff5b208cb($pclBorneMax) > 0)) { return false; } return true; } function F836f402a() { $bRes = false; if ($this->m_clValeur->F2c185292()) $bRes = $this->m_clValeur->F9c5b5dfc($this->F933f08b4(), $this->F6b05823e() ); return $bRes; } function Fd7c1b120() { $pclBorneMin =& $this->F933f08b4(); $pclBorneMax =& $this->F6b05823e(); if (!$pclBorneMin->F2c185292() && !$pclBorneMax->F2c185292()) { return false; } $clBorneMinMois = _clone( $pclBorneMin); if ($clBorneMinMois->m_szDate!='') $clBorneMinMois->F7b946724(1); $clBorneMaxMois = _clone( $pclBorneMax ); if ($clBorneMaxMois->m_szDate!='') $clBorneMaxMois->F7b946724(1); $bModif = $this->m_clMoisCourant->F9c5b5dfc($clBorneMinMois, $clBorneMaxMois); if ($this->m_clMoisCourant->nGetJour() != 1) { $this->m_clMoisCourant->F7b946724(1); $bModif = true; } return $bModif; } function F3c0ec437() { if (!empty($this->m_czLettreJoursSemaine)) { for ($i=0; $i<NBJOURS_SEMAINE; $i++){ $this->m_tabLettreJoursSemaine[$i] = utf8_substr($this->m_czLettreJoursSemaine,$i,1); } return; } $czNomJour = ''; $i = 0; $szChar = "\0"; $tabJoursSemaine = F7d16a969(); $sEnvJourSemaine = utf8_strtoupper(utf8_substr($tabJoursSemaine[6],0,1)) . utf8_strtoupper(utf8_substr($tabJoursSemaine[0],0,1)) . utf8_strtoupper(utf8_substr($tabJoursSemaine[1],0,1)) . utf8_strtoupper(utf8_substr($tabJoursSemaine[2],0,1)) . utf8_strtoupper(utf8_substr($tabJoursSemaine[3],0,1)) . utf8_strtoupper(utf8_substr($tabJoursSemaine[4],0,1)) . utf8_strtoupper(utf8_substr($tabJoursSemaine[5],0,1)); for ( $i = 0; $i < NBJOURS_SEMAINE; $i++) { if (!empty($sEnvJourSemaine)) { $this->m_tabLettreJoursSemaine[$i] = utf8_substr($sEnvJourSemaine,$i,1); $bLettreOK = true; } else { F204bf664($i, $this->m_piInfoLangue, $czNomJour); $bLettreOK = false; if (isset($this->m_piInfoLangue)) { global $MaPage; if (!$MaPage->bUTF8) { $szChar[0] = $czNomJour[0]; $szChar = strtoupper($szChar); $this->m_tabLettreJoursSemaine[$i] = $szChar[0]; $bLettreOK = true; } } } if (!$bLettreOK) { $this->m_tabLettreJoursSemaine[$i] = utf8_substr($czNomJour,0,1); } } $nNumJour1er = $this->Fca04e360(); for ( $i=0; $i<$nNumJour1er; $i++) { $cDimanche = $this->m_tabLettreJoursSemaine[0]; $this->m_tabLettreJoursSemaine = array_slice($this->m_tabLettreJoursSemaine,1); $this->m_tabLettreJoursSemaine[NBJOURS_SEMAINE - 1] = $cDimanche; } } function& F0001028f() { $pclStyleConst =& F349cf082($this,'m_clJourBase'); $clCoulBase = $pclStyleConst->F1034101c(); if ($clCoulBase->F38db1168() == false) return $clCoulBase; $pclJourLignePair =& F349cf082($this,'m_clJourLignePair'); $clCoulPair = $pclJourLignePair->F1034101c(); $pclJourLigneImpair =& F349cf082($this,'m_clJourLigneImpair'); $clCoulImpair = $pclJourLigneImpair->F1034101c(); if ( ($clCoulPair->m_dwColor == $clCoulImpair->m_dwColor) && ($clCoulPair->F38db1168() == false)) return $clCoulImpair; return F89c1612f(); } function F9158bf7f( $clCouleur) { $pclJourBase =& F264709eb($this,'m_clJourBase'); $pclJourBase->F140ec365($clCouleur); $pclJourLignePair =& F264709eb($this,'m_clJourLignePair'); $pclJourLignePair->F140ec365(dwCODETranparent); $pclJourLigneImpair =& F264709eb($this,'m_clJourLigneImpair'); $pclJourLigneImpair->F140ec365(dwCODETranparent); $pclLibNumeroSemaine =& F264709eb($this,'m_clLibNumeroSemaine'); $pclLibNumeroSemaine->F140ec365(dwCODETranparent); $pclLibNomMois =& F264709eb($this,'m_clLibNomMois'); $pclLibNomMois->F140ec365(dwCODETranparent); } function& F55933098() { $pclJourBase =& F349cf082($this,'m_clJourBase'); $clCoulBase = $pclJourBase->m_clFond; if ($clCoulBase->F38db1168() == false) return $clCoulBase; $pclJourLignePair =& F264709eb($this,'m_clJourLignePair'); $clCoulPair = $pclJourLignePair->m_clFond; $pclJourLigneImpair =& F264709eb($this,'m_clJourLigneImpair'); $clCoulImpair = $pclJourLigneImpair->m_clFond; if ( ($clCoulPair->m_dwColor == $clCoulImpair->m_dwColor) && ($clCoulPair->F38db1168() == false)) return $clCoulImpair; $return = F89c1612f(); return $return; } function Fded6de4e( $clCouleur) { $pclJourBase =& F349cf082($this,'m_clJourBase'); $pclJourBase->SetCouleurFond($clCouleur); $pclJourLignePair =& F264709eb($this,'m_clJourLignePair'); $pclJourLignePair->SetCouleurFond( dwCODETranparent ); $pclJourLigneImpair =& F264709eb($this,'m_clJourLigneImpair'); $pclJourLigneImpair->SetCouleurFond( dwCODETranparent ); } function SetValeur ( $clValeur) { $clDateValeur = new CDateCalendrier(); if ($this->Ff087e9e0($clValeur, $clDateValeur) == false) { return; } $this->F8d64b6cf($clDateValeur, CAUSE_CODE, nCHANGEMOIS_CODE); } function& GetValeur () { $pclVal = null; $this->F91d3b25f($this->m_clValeur, $pclVal); return $pclVal; } function& GetValI($sJour) { if (!isset($this->m_clJours[$sJour])) $this->F00139942($sJour); return $this->F96c19afe( new CDateCalendrier($sJour) ); } function SetValI($sJour, $Valeur) { $pclJour =& $this->F96c19afe( new CDateCalendrier($sJour) ); if (isset($pclJour)) { $pclJour->SetValeur($Valeur); } } function SetBorneMin ( $clValeur) { if (!$this->Ff087e9e0($clValeur, $this->m_clBorneMin)) { Fe81a7f9e('ERR_DATE_VALEUR'); } if ($this->F836f402a() != false) $this->F6fb6d0cf(VALEUR); if ($this->Fd7c1b120() != false) $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); $this->F6fb6d0cf(BORNEMIN_WEB); } function& GetBorneMin () { $pclVal=null; $this->F91d3b25f($this->m_clBorneMin, $pclVal); return $pclVal; } function SetBorneMax ( $clValeur) { if (!$this->Ff087e9e0($clValeur, $this->m_clBorneMax)) { Fe81a7f9e('ERR_DATE_VALEUR'); } if ($this->F836f402a() != false) $this->F6fb6d0cf(VALEUR); if ($this->Fd7c1b120() != false) $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); $this->F6fb6d0cf(BORNEMAX_WEB); } function& GetBorneMax () { $pclVal = null; $this->F91d3b25f($this->m_clBorneMax, $pclVal); return $pclVal; } function SetImage ($clValeur) { $this->m_czImageFond = VersChaine( $clValeur); $this->F6fb6d0cf( IMAGE_WEB ); } function& GetImage () { return $this->m_czImageFond; } function Ff087e9e0( &$clValeur, &$pclDate) { $pszDate=''; if (is_object($clValeur)) { $pszDate = VersChaine($clValeur); } else { $pszDate = VersChaine($clValeur); if (empty($pszDate)) { $pclDate->F43a2e5ec(''); return true; } $czDateAAAAMMJJ = ''; if (!($this->m_czFormatMemorise == '') && !($this->m_czFormatMemorise == szFORMATMEMCALENDRIER_DEFAUT)) { $clMasqueDate = new CMasqueDateHeure($this->m_czFormatMemorise, true); $clMasqueDate->F0a4d7e8c($pszDate, $czDateAAAAMMJJ, false ); $pszDate = $czDateAAAAMMJJ; } if ((utf8_strlen($pszDate) > LONGUEUR_DATE) || (F01dad99e($pszDate) == false)) { $clTmp=null; if (CreerType($clTmp,null,TYPEWL_DATE,$clValeur) == null) { return false; } $pszDate = $clTmp->Fc424b461(); if (F01dad99e($pszDate) == false) return false; } } $pclDate->Fea34dd7d($pszDate); return true; } function& Fb46a14c1() { return $this->m_clValeur; } function F91d3b25f( $clDate, &$pclVal) { if (!$clDate->F2c185292()) { $pclVal = ''; return; } $pszDateAAAAMMJJ = $clDate->F09992612(); if ( ($this->m_czFormatMemorise=='') || ($this->m_czFormatMemorise == szFORMATMEMCALENDRIER_DEFAUT)) { $pclVal = $pszDateAAAAMMJJ; } $clMasqueDate = new CMasqueDateHeure($this->m_czFormatMemorise, true); $czDateAvecFormatRetour = ''; $clMasqueDate->F407a3c7c( $pszDateAAAAMMJJ, $czDateAvecFormatRetour ); $pclVal = $czDateAvecFormatRetour; } function F267458f8( $rstLogFont, $clCouleurTxt,$pszTailleCSS, $pszPoliceCSS) { parent::F267458f8($$rstLogFont, $clCouleurTxt, $pszTailleCSS, $pszPoliceCSS); $pclJourBase =& F264709eb($this,'m_clJourBase'); $pclJourBase->F710f6f7f($rstLogFont, $pszTailleCSS, $pszPoliceCSS); if ($clCouleurTxt->Fd061cc94() != false) { $pclJourBase =& F264709eb($this,'m_clJourBase'); $pclJourBase->F140ec365($clCouleurTxt); } } function Fad0cf8ae( $pstLogFont, &$pczTailleCSS, &$pczPoliceCSS) { $pclJourBase =& F264709eb($this,'m_clJourBase'); $pclJourBase->F25bb2c10($pstLogFont, $pczTailleCSS, $pczPoliceCSS); } function SetFormatMemorise( $clValeur) { $pszVal = VersChaine( $clValeur ); $this->m_czFormatMemorise = $pszVal; } function& GetFormatMemorise() { return $this->m_czFormatMemorise; } function& GetType() { return getRef(ID_CALENDRIER); } function F4a917fa4() { return 47; } function SetCouleur( $dwCoul ) { if ($dwCoul == iCouleurDefaut) { $this->m_clCouleur->m_dwColor = $this->CouleurInitiale; } else { $this->m_clCouleur->m_dwColor = $dwCoul; } if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_COULEUR); } } function& GetCouleur() { return $this->m_clCouleur->m_dwColor; } function SetCouleurFond( $dwCoul ) { if ($dwCoul == iCouleurDefaut) { $this->m_clCouleurFond->m_dwColor = $this->CouleurFondInitiale; } else { $this->m_clCouleurFond->m_dwColor = $dwCoul; } if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_COULEURFOND); } } function& GetCouleurFond() { return $this->m_clCouleurFond->m_dwColor ; } function& Fa303780a() { return $this->Fca04e360(); } function F0c012649( $n ) { $this->SetNum1erJourAffiche($n); } function pszGetContenuHTML() { $pclZR = null; $this->F6ce2b314($pclZR); if (!isset($pclZR)) { $sCodeHTML = call_user_func('construireCalendrier__' . $this->F960e3ffe(),1); return $sCodeHTML; } $sCodeHTML = call_user_func('construireCalendrier__' . $this->F960e3ffe(),$pclZR->m_nLigneAffichee); return $sCodeHTML; } function pszGetLettreJourSemaineHTML($IemeJour) { $pclResultat = null; $pclResultatStats = null; $this->m_pclVue->F1f68ed08( new CPropCodeHTML(szPROP_CODEHTML . cPROP_CODEHTML_SEPARATEUR . PARTIE_CODEHTML_CALENDRIER_NOMJOUR . cPROP_CODEHTML_SEPARATEUR . $IemeJour), $pclResultat, $pclResultatStats ); return (isset($pclResultat)) ? $pclResultat : $pclResultatStats; } function pszGetMoisCourantHTML() { $pclResultat = null; $pclResultatStats = null; $this->m_pclVue->F1f68ed08( new CPropCodeHTML(szPROP_CODEHTML . cPROP_CODEHTML_SEPARATEUR . PARTIE_CODEHTML_CALENDRIER_NOMMOIS), $pclResultat, $pclResultatStats ); return (isset($pclResultat)) ? $pclResultat : $pclResultatStats; } function pszGetJoursHTML() { $pclResultat = null; $pclResultatStats = null; $this->m_pclVue->F1f68ed08( new CPropCodeHTML(szPROP_CODEHTML . cPROP_CODEHTML_SEPARATEUR . PARTIE_CODEHTML_CALENDRIER_JOURS), $pclResultat, $pclResultatStats ); return (isset($pclResultat)) ? $pclResultat : $pclResultatStats; } function pszGetLibelleAujourdhuiHTML() { $pclResultat = null; $pclResultatStats = null; $this->m_pclVue->F1f68ed08( new CPropCodeHTML(szPROP_CODEHTML . cPROP_CODEHTML_SEPARATEUR . PARTIE_CODEHTML_CALENDRIER_AUJOURDHUI), $pclResultat, $pclResultatStats ); return (isset($pclResultat)) ? $pclResultat : $pclResultatStats; } function Fdc05d49f( $ValeurHTTP ) { $pclZR = null; $this->F6ce2b314($pclZR); if (isset($pclZR)) $this->SetValeur( $ValeurHTTP ); } } function F15c6af90( $nNumJour, $nDecalage) { $nNumJourOUT = ($nNumJour + $nDecalage) % NBJOURS_SEMAINE; if ($nNumJourOUT < 0) $nNumJourOUT += NBJOURS_SEMAINE; return $nNumJourOUT; } function F548dbb0a( $pszDate) { $pclTabJoursFeries =& Fc01a25d5(); return $pclTabJoursFeries->F1e306ff3($pszDate); } $gbInitMasque = false; define('szDEFRETFORMATDATE',"AAAAMMJJ"); define('szDEFRETFORMATHEURE',"HHMMSS"); class CMasque { var $m_piInfoLangue = null; function F58848eb2( &$piInfoLangue, $bEuro, $bForceMonetaire ) { $this->m_piInfoLangue =& $piInfoLangue; } } class CMasqueDateHeure extends CMasque { var $m_clMasqueDate; var $m_bDate; var $m_nYearMin; var $m_nYearMax; var $m_clFormatRetour; var $m_clMasqueDateInitial; function CMasqueDateHeure( $pszMask, $bDate, $pszFormatRetour = null) { global $gbInitMasque; $this->m_bDate = $bDate; $this->m_clMasqueDate = $pszMask; $this->m_clMasqueDateInitial = $pszMask; $this->m_nYearMin = 1900; $this->m_nYearMax = 2089; if (!$gbInitMasque) { F51e43d21(); } if (isset($pszFormatRetour)) { $this->m_clFormatRetour = $pszFormatRetour; } else { if ($this->m_bDate) { $this->m_clFormatRetour = szDEFRETFORMATDATE; } else { $this->m_clFormatRetour = szDEFRETFORMATHEURE; } } if (utf8_strcasecmp($this->m_clMasqueDate,szMASKDATEHEURE_SYTEME)==0) { } } function F58848eb2( &$piInfoLangue, $bEuro, $bForceMonetaire) { parent::F58848eb2($piInfoLangue, $bEuro, $bForceMonetaire); if (utf8_strcasecmp($this->m_clMasqueDateInitial , szMASKDATEHEURE_SYTEME )==0 ) { } } function F407a3c7c( $pszDate, &$pclResult) { $stDate = new SYSTEMTIME(); $pszFormatDate = $this->m_clFormatRetour; if ($this->m_clFormatRetour == '' ) { $pszFormatDate = $this->m_clMasqueDate; } if (empty($pszDate)||ord($pszDate[0]==0)) { $pclResult=''; return; } $clDate = new FMK_Date($pszDate,$pszFormatDate); $TimeStamp = $clDate->F778c5667(); $stDate->wDay = date('d',$TimeStamp); $stDate->wDayOfWeek = date('w',$TimeStamp); if ($stDate->wDayOfWeek==0) $stDate->wDayOfWeek = 7; $stDate->wHour = date('h',$TimeStamp); $stDate->wMilliseconds= $clDate->getMilliseconde(); $stDate->wMinute = intval(date('i',$TimeStamp)); $stDate->wMonth = date('n',$TimeStamp); $stDate->wSecond = intval(date('s',$TimeStamp)); $stDate->wYear = date('Y',$TimeStamp); FMK_Charge('WL/STD/Std.php',false); $pclResult = DateVersChaine($clDate->Fe8fc8ad8(),$this->m_clMasqueDate); } function F0a4d7e8c( $psz, &$pclResult, $bEnSaisie, $pszFormatRetour = null) { if ( !isset($pszFormatRetour)) { $pszFormatRetour = $this->m_clFormatRetour; } FMK_Charge('WL/STD/Std.php',false); $pclResult = DateVersChaine(ChaineVersDate($psz,$this->m_clMasqueDate),$pszFormatRetour); } } function F51e43d21() { global $gbInitMasque; $gbInitMasque = true; } class IVisiteurEvenement { function F7bb302c8($pclEvenement) { Fa79fbf41('PURE'); } }; class CVisteurMaxSuperposition extends IVisiteurEvenement { var $m_nMaxSuperposion; function CVisteurMaxSuperposition() { $this->m_nMaxSuperposion = 0; } function F7bb302c8( $pclEvenement ) { if (!$pclEvenement->m_bJourneeEntiere) return true; $nNbSuperposition = $pclEvenement->m_nNbMaxSuperpositon + 1; if ($nNbSuperposition > $this->m_nMaxSuperposion) $this->m_nMaxSuperposion = $nNbSuperposition; return true; } }; class CChampAgenda extends CChampCalendrier { var $m_eModesuperposition; var $m_bRedimEvenementParUser; var $m_bDeplaceEvenementParUser; var $m_bSelectPeriodeParUser; var $m_bEditInPlaceInterdit; var $m_clDateDebutAff = null; var $m_eModeZoom = eZoomSemaine; var $m_clHeureOuvrableMin; var $m_clHeureOuvrableMax; var $m_clHeureDebutAff; var $m_clHeureFinAff; var $m_nHauteur1Heure; var $m_clTabEvenement; var $m_czMasqueHeure = ''; var $m_czMasqueHeureForce = ''; var $Masque = ''; var $m_nGranulariteRDV_Deplacement; var $m_nGranulariteRDV_Redim; var $m_pclEveSelection = null; var $m_pclEveSurvol = null; var $m_bEnCreationNouveauRDV = false; var $m_bInAjouteRDVFromUser = false; var $m_bAfficheNumeroDeSemaine; var $m_nNbJourModeSemaine; var $m_bAvecBoutonChangePeriode = true; var $m_tabInfosContenu = null; var $m_bInPCodeChangementDePeriode=false; var $m_bSupportJourneeEntiere = false; var $m_nNbMaxRDVALaJOurneSuperpose = 0; var $m_nHauteurZoneJourneeCompleteEd = -1; var $m_bAccesAuxHeuresNonAffichees=true; var $m_bAjoutMoisDansPremierLibelle=true; var $m_bAfficherTitreRendezVous=true; var $m_nLargeurZoneHeure = 48; var $m_nHauteurTitreUneLigne = 20; function CChampAgenda() { parent::CChampCalendrier(); $this->m_clDateDebutAff = new CDateAgenda(); $this->m_clHeureOuvrableMin = new CDateAgenda(); $this->m_clHeureOuvrableMax = new CDateAgenda(); $this->m_clHeureDebutAff = new CDateAgenda(); $this->m_clHeureFinAff = new CDateAgenda(); $this->m_nHauteur1Heure = 48; $this->m_clTabEvenement = array(); $this->m_czMasqueHeure ='H:MM'; $this->m_nGranulariteRDV_Deplacement = 30; $this->m_nGranulariteRDV_Redim = 30; $this->m_clDateDebutAff->Ff04c7c3b(); $this->Fbd897cbd(); XVERIFY( $this->bSetPlageHoraireVisible('07','20') ); XVERIFY( $this->bSetPlageHoraireOuvrables('08','18') ); $this->m_bAfficheNumeroDeSemaine = true; $this->m_nNbJourModeSemaine = 5; $this->m_clGestFichierParcouru = new CAccesDirectGeneralise(); } function Feb661866() { return ID_AGENDA; } function F4a917fa4() { return 76; } function F12828e6d( $eTypeVue) { return $this->F0198de68('CVueChampAgenda_Web',$eTypeVue); } function F56660bf0( $eTypeControleur) { return $this->Fea7a1f04('CControleurChampAgenda_Web',$eTypeControleur); } function Fb560a68a($dwFlags) { parent::Fb560a68a($dwFlags); $this->Fd756fa39(); } function Fdc05d49f( $ValeurHTTP ) { } function F2d291cd8() { $this->m_pclStyle = new CStyleChampAgenda(); return isset($this->m_pclStyle) ? NOERROR : E_FAIL; } function& GetType() { return getRef(ID_AGENDA); } function& GetNouveau() { return $this->m_bEnCreationNouveauRDV; } function& GetMasqueTitreDate() {return $this->Masque;} function SetMasqueTitreDate($czMasqueTitreDate) {$this->Masque = $czMasqueTitreDate; $this->F6fb6d0cf(MASQUETITREDATE);} function& GetGranulariteRendezVous () {return $this->m_nGranulariteRDV_Deplacement;} function SetGranulariteRendezVous ($n ) { $this->F1bd63df7( $n, 1 | 2 ); } function SetGranulariteDeplacement($n) {$this->F1bd63df7( $n, 2 ); } function& GetGranulariteDeplacement() {return $this->m_nGranulariteRDV_Deplacement;} function SetGranulariteDuree($n) {$this->F1bd63df7( $n, 1 ); } function& GetGranulariteDuree() { if ($this->Ff44acd3b() && $this->m_nGranulariteRDV_Redim < 1440) { return 1440; } if ($this->F0c6ce572() && $this->m_nGranulariteRDV_Redim < 720) { return 720; } return $this->m_nGranulariteRDV_Redim; } function& GetValeur() { $retour = $this->F5c14ecc7() + 1; return $retour; } function SetValeur($nIndiceWL) { $nIndice = $nIndiceWL-1; if (!$this->Fd4c80e66($nIndice)) { return; } $pclEvenement =& $this->Faa22a1bf($nIndice); $this->F55d8e854( $pclEvenement, $nIndice, nFROM_FONC ); } function& GetSelectionPeriode() { $retour = $this->m_bSelectPeriodeParUser; return $retour; } function SetSelectionPeriode($b) { $this->m_bSelectPeriodeParUser = (bool)$b; } function& GetDeplacementRDV() {return $this->m_bDeplaceEvenementParUser;} function SetDeplacementRDV($b) {$this->m_bDeplaceEvenementParUser = $b;} function& GetModificationDureeRDV() {return $this->m_bRedimEvenementParUser;} function SetModificationDureeRDV($b) {$this->m_bRedimEvenementParUser = $b;} function& GetSaisieDirecteRDV() {return $this->m_bEditInPlaceInterdit;} function SetSaisieDirecteRDV($b) {$this->m_bEditInPlaceInterdit = $b;} function AgendaVaPeriodePrecedente() { $this->Fa0a598d8(); } function AgendaVaPeriodeSuivante() { $this->F4ba4e322(); } function AgendaSelectPlus($nIndiceWL) { $this->F7501c398(intval($nIndiceWL)); } function AgendaSelectMoins($nIndiceWL=-1) { $this->F577dd737(intval($nIndiceWL)); } function AgendaAffiche() { $this->SetFirstIndex(0, 1 | 8); } function AgendaAjouteRendezVous_Syntaxe1 ($pszTitre, $clDateDebut ) { $clDateFin = new CDateTime($rclDateDebut); $clDateFin->bDecaleHeure(1); return $this->AgendaAjouteRendezVous_Syntaxe1_Version2( $pclChamp, $pszTitre, $clDateDebut, $clDateFin); } function AgendaAjouteRendezVous_Syntaxe1_Version2 ($pszTitre, $clDateDebut, $clDateFin, $pszCategorie=null ) { $clAny_Debut = new CDateTime($clDateDebut); $clAny_Fin = new CDateTime($clDateFin); return $this->F2e660529(null, $pszTitre, $clAny_Debut, $clAny_Fin, $pszCategorie); } function AgendaAjouteRendezVous_Syntaxe2 (&$piRendezVousVM ) { return $this->F4d0beb83(F3df01b28($piRendezVousVM)); } function AgendaChangeZoom ($nZoom , $nNbJour=-1 ) { switch ($nZoom) { case 0: $this->F5c84377e(eZoomJournee); break; case 1: if ($nNbJour === -1) { $nNbJour = 7; } else { if (($nNbJour<2) || ($nNbJour>7)) { Fb9eb0792('ERR_BAD_CONSTANT', $nNbJour ); return; } } $this->F6d7986f6( eZoomSemaine, $nNbJour ); break; case 2: $this->F6d7986f6( eZoomSemaine, 5 ); break; case 3: $this->F5c84377e( eZoomMois); break; default: Fb9eb0792('ERR_BAD_CONSTANT', $nZoom) ; } } function AgendaZoom() { $eZoom = $this->m_eModeZoom; switch ($eZoom) { case eZoomJournee: return 0; case eZoomSemaine: if ($this->m_nNbJourModeSemaine === 7 ) return 1; if ($this->m_nNbJourModeSemaine === 5 ) return 2; return 1; case eZoomMois: return 3; default: return 1; } } function AgendaListeRendezVous_Syntaxe1_Version1() { return $this->F17a206d4(null, false); } function AgendaListeRendezVous_Syntaxe1_Version2 ($clDateMin ) { $clDateMinAny = new CDateTime($clDateMin); $clDateMax=null; $this->F47935dca( $clDateMinAny, $clDateMax ); return $this->F3eaa0a03(null, $clDateMinAny, $clDateMax, false); } function AgendaListeRendezVous_Syntaxe1_Version3 ($clDateMin, $clDateMax ) { $clDateMinAny = new CDateAgenda($clDateMin); $clDateMaxAny = new CDateAgenda($clDateMax); return $this->F3eaa0a03(null, $clDateMinAny, $clDateMaxAny, false); } function AgendaListeRendezVous_Syntaxe2 ($nFlag ) { return $this->F1f247568($nFlag,false); } function AgendaSupprimeRendezVous_Syntaxe1() { $this->F703e1262(); } function AgendaSupprimeRendezVous_Syntaxe2 ($nIndiceWL ) { $this->F2e0b26af($nIndiceWL); } function AgendaSupprimeTout() { $this->F9d324b29(); } function AgendaHeureAffichee ($pszHeureMin, $pszHeureMax ) { $this->Ffa9ba7ec($pszHeureMin, $pszHeureMax); } function AgendaPosition ($pszDate) { $this->F4a47f5ce($pszDate); } function AgendaPosition_Syntaxe2($nOption) { return $this->F47da19e2($nOption); } function pszGetContenuHTML() { return F42d47045($this,false); } function F98c69881() { if (0 < $this->m_nLargeurZoneHeure) { return $this->m_nLargeurZoneHeure; } else { $pszMasqueHeure = $this->Fb6247526(); if (!empty($pszMasqueHeure) && F31cca71c($pszMasqueHeure)) { return 60; } return 48; } } function F919da3cf() { if (0 < $this->m_nHauteurTitreUneLigne) { return $this->m_nHauteurTitreUneLigne; } else { return F2e6b777b($this); } } function Ff44acd3b() {return false;} function F0c6ce572() {return false;} function Fc0755c6a() { return false; } function F47da19e2($nOption) { switch ($nOption) { case nagDateDebut: { $clDateDebut = new CDateAgenda(); $clDateFin = new CDateAgenda(); $this->F7d08dde4( $clDateDebut, $clDateFin); $clDateDebut->Fadb98d95(); return $clDateDebut->F09992612(); } case eagDateFin: { $clDateFin = new CDateAgenda(); $this->F229e02d8( $clDateFin ); return $clDateFin->F09992612(); } case nagMoisEnCours: { $clMoiscourant =& $this->m_clMoisCourant; return $clMoiscourant->F09992612(); } default: Fb9eb0792('ERR_BAD_CONSTANT', $nOption); return ''; } } function F4a47f5ce($pszDate) { $clDateDebut = new CDateAgenda(); if (!$clDateDebut->F5c6d1692( $pszDate )) { Fb9eb0792('ERR_BAD_FORMATDATEAGENDA', $pszDate); return; } if(strlen($pszDate)>LONGUEUR_DATE) { if (!$clDateDebut->Fdacc3087( substr($pszDate , LONGUEUR_DATE ))) { Fb9eb0792('ERR_BAD_FORMATDATEAGENDA', $pszDate); return; } } $this->Feca5376f( $clDateDebut, 1 + 0x80000000); } function Ffa9ba7ec($pszHeureMin, $pszHeureMax) { if (!$this->Fc30394fa($pszHeureMin)) { Fb9eb0792('ERR_BAD_FORMATHEUREAGENDA', $pszHeureMin); return; } if (!$this->Fc30394fa($pszHeureMax)) { Fb9eb0792('ERR_BAD_FORMATHEUREAGENDA', $pszHeureMax); return; } XVERIFY($this->bSetPlageHoraireVisible($pszHeureMin, $pszHeureMax)); } function Fc30394fa($pszHeure) { $nLen = strlen($pszHeure); if (($nLen != 2) && ($nLen != 4) && ($nLen != 6) && ($nLen != 8)) return FALSE; $szHeure = substr(str_pad($pszHeure,8,'0'),0,8); $tmp = new CDateTime(); return $tmp->Fdacc3087($szHeure); } function F9d324b29() { $this->F6325d676(); } function F2e0b26af($nIndiceWL) { $nIndice = $nIndiceWL-1; if (!$this->Fd4c80e66($nIndice)) { return; } $this->Fc39f8252($nIndice, 1); } function F703e1262() { $pclEvtSelection =& $this->m_pclEveSelection; if($pclEvtSelection==null) { return; } $nIndice = $this->F6e4a8c18($pclEvtSelection); $this->Fc39f8252($nIndice, 1); } function F47935dca( &$clDateDebutWL, &$pclDateFinAny ) { $clCopie = _clone($clDateDebutWL); { $clDateMax = new CDateTime(); $clDateMax->F5d5b7869( 2050,1,1,1,0,0,0); $pclDateFinAny = _clone( $clDateMax ); return; } $pclDateFinAny = 10000000; } function Fc61a843e($pszRessource, &$pclTabEvenement ) { $nNbEvenemenet = count($this->m_clTabEvenement,COUNT_NORMAL); for ($i=0;$i<$nNbEvenemenet;++$i) { $pclEvenement =& $this->m_clTabEvenement[$i]; if ( (''!==$pszRessource) && !$pclEvenement->Fb8d1ae4b($pszRessource)) continue; $pclTabEvenement[] = _clone($pclEvenement); } } function F17a206d4($pszRessource,$bPourTimeLine) { $clTabEvenement = array(); $this->Fc61a843e((string)$pszRessource, $clTabEvenement); return $clTabEvenement; } function& F3eaa0a03($pszRessource, $clDateMin, $clDateMax, $bPourTimeLine) { $clDateAgdMin = new CDateAgenda($clDateMin); $clDateAgdMax = new CDateAgenda($clDateMax); if ($clDateAgdMax->F55439573() == 0) { XVERIFY( $clDateAgdMax->F35ed58e9() ); } $clTabEvenementAff = array(); $this->F2a8e6b09((string)$pszRessource, $clDateAgdMin, $clDateAgdMax, $clTabEvenementAff, 1| 4); return $clTabEvenementAff; } function F1f247568($eFlag,$bPourTimeLine) { $pclEveAgenda=null; switch ($eFlag) { case LISTERENDEZVOUS_SELECTIONNE: $pclEveAgenda =& $this->F30c4a4e3(); break; case LISTERENDEZVOUS_SURVOLE: $pclEveAgenda =& $this->F5d0f7bd5(); break; default: Fb9eb0792( 'ERR_BAD_CONSTANT', $eFlag ); break; } if ($pclEveAgenda !== null) { return array(&$pclEveAgenda); } return array(); } function F6d7986f6($eNewZoom, $nNewNbJourModeSemaine) { if(($this->m_nNbJourModeSemaine != $nNewNbJourModeSemaine) || ($this->m_eModeZoom != $eNewZoom)) { $nOldNbJourModeSemaine = $this->m_nNbJourModeSemaine; $eOldZoom = $this->m_eModeZoom; $this->m_eModeZoom = $eNewZoom; if ($nNewNbJourModeSemaine == -1 ) { $nNewNbJourModeSemaine = $this->m_nNbJourModeSemaine; } else { $this->m_nNbJourModeSemaine = $nNewNbJourModeSemaine; } $this->F22ca6d30($eOldZoom, $nOldNbJourModeSemaine, $eNewZoom, $nNewNbJourModeSemaine); } } function F5c84377e($eMode) { if($this->m_eModeZoom !== $eMode) { $eOldZoom = $this->m_eModeZoom; $this->m_eModeZoom = $eMode; $this->F22ca6d30($eOldZoom, $this->m_nNbJourModeSemaine, $eMode, $this->m_nNbJourModeSemaine); } } function F22ca6d30($eOldModeZoom, $nOldNbJourModeSemaine, $eNewModeZoom, $nNewNbJourModeSemaine) { $piVue = $this->m_pclVue; $clDateMaintenant = new CDateAgenda(); $clDateMaintenant->Ff04c7c3b(); if ( ($eNewModeZoom == eZoomJournee) && ($eOldModeZoom !== eZoomJournee) && (($piVue !== null) && $piVue->Fd83eab1c($clDateMaintenant, 1, 3)) ) { $this->Feca5376f( $clDateMaintenant, 2 ); } if ($piVue !== null) { $piVue->F9f6a2f18( $eOldModeZoom,$nOldNbJourModeSemaine, $eNewModeZoom , $nNewNbJourModeSemaine); } $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); if (!$this->F0ccaaf2b() ) { return; } } function Fdbe16bf0() { if ($this->m_eModeZoom === eZoomMois) return false; if (!$this->F302508e9()) return false; return $this->m_bSupportJourneeEntiere; } function F2e660529($pszRessource, $pszTitre,$clDateDebut, $clDateFin, $pszCategorie) { $nResCmp = $clDateDebut->Ff5b208cb($clDateFin); if ( $nResCmp === 1 ) { Fb9eb0792( 'ERR_DATEFINAPRESDEBUT' ); return -1; } $nIndiceC = $this->F135a0611($pszTitre, $clDateDebut, $clDateFin, null, $pszCategorie, $pszRessource); if ($nIndiceC === -1) return -1; return $nIndiceC+1; } function F4d0beb83(&$pclRendezVous) { if ( $pclRendezVous->m_clDateDebut->Ff5b208cb($pclRendezVous->m_clDateFin) === 1 ) { Fb9eb0792( 'ERR_DATEFINAPRESDEBUT' ); return -1; } $nIndiceC = $this->Fa5831e6d( $pclRendezVous ); if ($nIndiceC === -1) return -1; return $nIndiceC+1; } function Fc05cf6e6() { if ($this->m_eModeZoom === eZoomMois) return false; return true; } function Fb1e154f7() { if (!$this->m_bSupportJourneeEntiere) return true; if ($this->m_eModeZoom === eZoomMois) return true; return false; } function F544438e0( $piVisiteurEvenement, &$clDateDebut, &$clDateFin ) { } function Ffc2d7564() { $clDateDebut = new CDateAgenda(); $clDateFin = new CDateAgenda(); $this->F7d08dde4( $clDateDebut, $clDateFin ); $clVisteur = new CVisteurMaxSuperposition();; $this->F544438e0( $clVisteur, $clDateDebut, $clDateFin ); return $clVisteur->m_nMaxSuperposion; } function Fb366a777() { if ($this->Fdbe16bf0()) { $this->m_nNbMaxRDVALaJOurneSuperpose = $this->Ffc2d7564(); } } function Fc49677c2(&$pclEvenement, $clDate, $pszRessourceSiPlanning ) { if ($pclEvenement === null) return; $pclEvenementBase=null; if ($pclEvenement->F29893c95( $pclEvenementBase )) { $this->Fc49677c2($pclEvenementBase, $clDate, '' ); return; } $clDateMin = new CDateAgenda(); $clDateMax = new CDateAgenda(); $pclEvenement->F2bc4c738( $clDateMin, $clDateMax ); if ($clDate->F0ee5647e($clDateMin)) return; $nDureeEve = 0; XVERIFY( F0744b8b4($clDateMax , $clDateMin, $nDureeEve) == WLO_OK ); $clDateMaxApres = new CDateAgenda(); $clDateMaxApres->F278c4330($clDate); $clDateMaxApres->F2bc25f7f($nDureeEve); $pclEvenement->F41dfd0d7( $clDate, $clDateMaxApres ); $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); $this->Fb366a777(); $nNumEve = $this->F5c14ecc7(); if (!$this->Fc9faed17(TRT_DeplacementRdvAgenda, 0 | 1, $nNumEve)) { $pclEvenement->F41dfd0d7( $clDateMin, $clDateMax ); return; } $this->m_clGestFichierParcouru->F783c0b63( $nNumEve ); } function SetFirstIndex($nIndex, $dwFlags = 0) { if (!$this->F48dce54a()) { return true; } $this->F6325d676(); if (!$this->F457574ac()) return false; $gclContextHF =& FMK_ContextHF(); return $this->m_clGestFichierParcouru->F0ba1fe8f($this, $dwFlags, $gclContextHF); } function F577dd737($nIndiceWL) { $nIndice = 0; if ($nIndiceWL === -1) { $nIndice = $this->F5c14ecc7(); if ($nIndice === nNUMELEMENT_INVALIDE) return; } else { $nIndice = $nIndiceWL - 1; } if (!$this->Fd4c80e66($nIndice, true)) { return; } $pclEvenement = $this->Faa22a1bf($nIndice); $this->F357784ea( $pclEvenement, $nIndice, nFROM_FONC ); } function F7501c398($nIndiceWL) { $nIndice = $nIndiceWL-1; if (!$this->Fd4c80e66($nIndice,true)) { return; } $pclEvenement = $this->Faa22a1bf($nIndice); $this->F55d8e854( $pclEvenement, $nIndice, nFROM_FONC ); } function Fa0a598d8() { $clDateDebutAvant = new CDateAgenda(); $this->F696236c4( $clDateDebutAvant ); $clDateDebutApres = new CDateAgenda(); $this->Fc9d0a157( $clDateDebutApres ); $this->Feca5376f( $clDateDebutApres, 1 ); $piVue =& $this->m_pclVue; if (isset($piVue)) { $piVue->Fb9c6a718( $clDateDebutAvant, $clDateDebutApres ); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function F4ba4e322( ) { $clDateDebutAvant = new CDateAgenda(); $this->F696236c4( $clDateDebutAvant ); $clDateDebutApres = new CDateAgenda(); $this->Fa46249be( $clDateDebutApres ); $this->Feca5376f( $clDateDebutApres, 1 ); $piVue =& $this->m_pclVue; if (isset($piVue)) { $piVue->Fb9c6a718( $clDateDebutAvant, $clDateDebutApres ); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function Fe356061f() { $this->F8b19dbb0(); } function F6325d676() { if ($this->F5c14ecc7() !== nNUMELEMENT_INVALIDE) { $this->F55d8e854(getRef(null), nNUMELEMENT_INVALIDE, nFROM_DELSEL); } $this->Fe4bcb035( getRef(null) ); $this->Fd3a7c1a8(); $i=0; while(isset($this->m_clTabEvenement[$i])) unset($this->m_clTabEvenement[$i++]); unset($this->m_clTabEvenement); $this->m_clTabEvenement = array(); $this->Fe356061f(); } function F8b19dbb0() { $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function Fccf0f863( $pclTabVal, &$pclRendezVous ) { foreach ($this->m_tabInfosContenu as $sTypeLiaison => $sRubriqueLiaison) { $sSep = strpos($sRubriqueLiaison,':')!==false ? ':' : "\t"; if (utf8_strpos($sRubriqueLiaison,$sSep)!==false) { $sRubriqueLiaison = utf8_substr(utf8_strrchr($sRubriqueLiaison,'.'),1); } if (!array_key_exists($sRubriqueLiaison,$pclTabVal)) { continue; } $xValeur = $pclTabVal[$sRubriqueLiaison]; switch ($sTypeLiaison) { case eAgLien_Titre: $pclRendezVous->m_sTitre = $xValeur; break; case eAgLien_Id: $pclRendezVous->m_sID = $xValeur; break; case eAgLien_CouleurFond: $pclRendezVous->m_clCouleur->m_dwColor = intval($xValeur); break; case eAgLien_DateDebut: $pclRendezVous->m_clDateDebut->F5b57114d($xValeur); break; case eAgLien_DateFin: $pclRendezVous->m_clDateFin->F5b57114d($xValeur); break; case eAgLien_Contenu: $pclRendezVous->m_sContenu = $xValeur; break; case eAgLien_Auteur: $pclRendezVous->m_sAuteur = $xValeur; break; case eAgLien_Lieu: $pclRendezVous->m_sLieu = $xValeur; break; case eAgLien_Invite: $pclRendezVous->m_sInvite = $xValeur; break; case eAgLien_Categorie: $pclRendezVous->m_sCategorie = $xValeur; break; case eAgLien_Importance: $pclRendezVous->m_nImportance = intval($xValeur); break; case eAgLien_Note: $pclRendezVous->m_sNote = $xValeur; break; case eAgLien_Image: $pclRendezVous->m_sImage = $xValeur; break; case eAgLien_Bulle: $pclRendezVous->m_sBulle = $xValeur; break; case eAgLien_Ressource: $pclRendezVous->m_sRessource = $xValeur; break; case eAgLien_JourneeComplete: $pclRendezVous->m_bJourneeEntiere = (bool)$xValeur; break; default: break; } } } function Fa96f8906($nNumElemModif, &$phPosElement) { $pclEvenement =& $this->Faa22a1bf((int)$nNumElemModif); if ($pclEvenement === null) { return 0; } $hPos = $pclEvenement->m_hPositionHF; if ($hPos === -1) { return 0; } $phPosElement = $hPos; return 1; } function F3ee935df(&$pclEvenement) { $bLibere = false; $hPos = $pclEvenement->m_hPositionHF; if ($hPos !== -1) { $this->m_clGestFichierParcouru->F271fa184( $hPos ); $bLibere = true; } if ($bLibere) { $pclEvenement->F2afa79e5( -1, -1 ); } } function Fd3a7c1a8() { $nNbEvenemenet = count($this->m_clTabEvenement,COUNT_NORMAL); for ($i=0;$i<$nNbEvenemenet;++$i) { $this->F3ee935df($this->m_clTabEvenement[$i]); } $this->TabPosition = array(); $this->nLastPosition = -1; } function F77cc9fa2($nNumElemModif) { $pclRendezVous =& $this->Faa22a1bf($nNumElemModif); if (!isset($pclRendezVous)) { return; } foreach ($this->m_tabInfosContenu as $sTypeLiaison => $sRubriqueLiaison) { switch ($sTypeLiaison) { case eAgLien_Titre: $xValeur = $pclRendezVous->m_sTitre; break; case eAgLien_Id: $xValeur = $pclRendezVous->m_sID; break; case eAgLien_CouleurFond: $xValeur = $pclRendezVous->m_clCouleur->m_dwColor; break; case eAgLien_DateDebut: $xValeur = $pclRendezVous->m_clDateDebut->VersChaine(); break; case eAgLien_DateFin: $xValeur = $pclRendezVous->m_clDateFin->VersChaine(); break; case eAgLien_Contenu: $xValeur = $pclRendezVous->m_sContenu; break; case eAgLien_Auteur: $xValeur = $pclRendezVous->m_sAuteur; break; case eAgLien_Lieu: $xValeur = $pclRendezVous->m_sLieu; break; case eAgLien_Invite: $xValeur = $pclRendezVous->m_sInvite; break; case eAgLien_Categorie: $xValeur = $pclRendezVous->m_sCategorie; break; case eAgLien_Importance: $xValeur = $pclRendezVous->m_nImportance; break; case eAgLien_Note: $xValeur = $pclRendezVous->m_sNote; break; case eAgLien_Image: $xValeur = $pclRendezVous->m_sImage; break; case eAgLien_Bulle: $xValeur = $pclRendezVous->m_sBulle; break; case eAgLien_Ressource: $xValeur = $pclRendezVous->m_sRessource; break; case eAgLien_JourneeComplete: $xValeur = $pclRendezVous->m_bJourneeEntiere; break; default: $xValeur = ''; break; } $pclRubrique =& F2b6640f3($this->FichierParcours,$sRubriqueLiaison); if(!isset($pclRubrique)) continue; $pclRubrique->SetValeur($xValeur); } } function Fa87e84c7(&$pclTabVal, $nNbValeur, $nFlag = 0) { foreach ($this->m_tabInfosContenu as $sTypeLiaison => $sRubriqueLiaison) { $pclRubrique =& F2b6640f3($this->FichierParcours,$sRubriqueLiaison); if(!isset($pclRubrique)) continue; $pclTabVal[$sRubriqueLiaison] = $pclRubrique->GetValeur(); } } function SetSourceRemplissage($sFichierParcours, $tabDonneesDuRdv) { F01ae1302(); $this->FichierParcours = &Fbad7a601($sFichierParcours); $this->m_tabInfosContenu = $tabDonneesDuRdv; ksort($this->m_tabInfosContenu); } function InitRemplissage() { $this->SetFirstIndex(0); } function F7f821e68() { if (!$this->F48dce54a()) { return false; } if(isset($this->m_clGestFichierParcouru) && $this->m_clGestFichierParcouru->m_bInitOK) { return false; } if(!isset($this->RubriqueParcours)) { if(!isset($this->FichierParcours->BestRub)) { $this->FichierParcours->Fad8a73f6(); } $this->RubriqueParcours = &$this->FichierParcours->BestRub; } else if(is_string($this->RubriqueParcours)) { $this->RubriqueParcours = &$this->FichierParcours->F133178d5($this->RubriqueParcours); } return true; } function F457574ac() { if (!isset($this->m_tabInfosContenu[eAgLien_DateDebut]) || !isset($this->m_tabInfosContenu[eAgLien_DateFin]) ) { Fe81a7f9e('ERR_AGENDA_LIENDATE',$this->Fd464306b(),$this->FichierParcours->sNom); return false; } return true; } function F5ffae798($pclTabValeur,$hPosHF,$hPosDINO) { if (!is_array($pclTabValeur)) return -1; $pclRendezVous = new CDinoRendezVous(); $this->Fccf0f863($pclTabValeur,$pclRendezVous); $nNouveauDRV = $this->Fe616e2e1( $pclRendezVous,0 ); $pclEveAgenda =& $this->Faa22a1bf($nNouveauDRV); $pclEveAgenda->F2afa79e5($hPosHF,$hPosDINO); return $nNouveauDRV; } function F8ec1b7af($nNumElemModif,&$pclTabValeur, $nNbValeur, $hPositionHF, $hPosDino) { if ($nNumElemModif===-1) return false; $pclRendezVous =& $this->Faa22a1bf($nNumElemModif); $this->Fccf0f863( $pclTabValeur, $pclRendezVous ); $pclRendezVous->F2afa79e5($hPositionHF, $hPosDino ); return true; } function F3de60b01(&$pclFichierParcours) { $tabEnregCourant = array(); foreach ($this->m_tabInfosContenu as $sTypeLiaison => $sRubriqueLiaison) { $sSep = strpos($sRubriqueLiaison,':')!==false ? ':' : "\t"; if (false === utf8_strpos($sRubriqueLiaison,$sSep)) { $tabEnregCourant[$sRubriqueLiaison] = $pclFichierParcours->EnregCourant[$sRubriqueLiaison]; } else { $sRubriqueAffichee = utf8_substr(utf8_strrchr($sRubriqueLiaison,'.'),1); $tabInfoChainette = utf8_explode($sSep,utf8_substr($sRubriqueLiaison,0,utf8_strlen($sRubriqueLiaison)-utf8_strlen($sRubriqueAffichee)-1)); $nNbInfo = count($tabInfoChainette,COUNT_NORMAL); switch ($nNbInfo) { case 2: { list( $this->sFichierBase , $this->sRubriqueBase ) = utf8_explode('.',$tabInfoChainette[0]); list( $this->sFichierAffiche , $this->sRubriqueReliee ) = utf8_explode('.',$tabInfoChainette[1]); $this->sRubriqueAffichee = $sRubriqueAffichee; $Rubrique =& Rubrique($this->sFichierAffiche,$this->sRubriqueAffichee); } break; case 3: { list( $this->sFichierBase , $this->sRubriqueBase ) = utf8_explode('.',$tabInfoChainette[0]); list( $sFichierAffiche1 , $sRubriqueReliee1, $sRubriqueAffichee1 ) = utf8_explode('.',$tabInfoChainette[1]); list( $sFichierAffiche2 , $sRubriqueReliee2) = utf8_explode('.',$tabInfoChainette[2]); $this->sRubriqueReliee = array($sRubriqueReliee1 , $sRubriqueReliee2); $this->sFichierAffiche = array($sFichierAffiche1 , $sFichierAffiche2); $this->sRubriqueAffichee = array($sRubriqueAffichee1 , $sRubriqueAffichee); $Rubrique =& Rubrique($sFichierAffiche2,$sRubriqueAffichee); } break; default: } $nResultQuery = $pclFichierParcours->F1b8fc945($this); if ( ($nResultQuery !== false) && (($nResult = $pclFichierParcours->F91276a4c($nResultQuery)) != 0) && (isset($nResult)) ) { $tabEnregCourant[$sRubriqueAffichee] = ((!isset($Rubrique)) ? $nResult[0] : $Rubrique->F48bb09ec($nResult[0])); } } } return $tabEnregCourant; } function Feca5376f(&$clDateHeure,$nFlag=2) { if ($this->m_clDateDebutAff->F0ee5647e($clDateHeure)) return; $this->m_clDateDebutAff->F278c4330( $clDateHeure ); $nNumJourSem = $this->m_clDateDebutAff->F4c110548(); $nDecalePourBon1erJour = $this->m_nNumJour1erCol-$nNumJourSem; if ($nNumJourSem < $this->m_nNumJour1erCol) $nDecalePourBon1erJour -= 7; if ($this->m_eModeZoom !== eZoomJournee ) $this->m_clDateDebutAff->Fee154cfe( $nDecalePourBon1erJour ); $this->m_clDateDebutAff->Fadb98d95(); $this->Fbd897cbd(); $this->Fb479e1ee($nFlag); } function Fb479e1ee($nFlag) { $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); if (Fdef56c7f($nFlag,1073741824)) return; if (!$this->F0ccaaf2b() ) { return; } } function F0ccaaf2b() { if ($this->m_bInPCodeChangementDePeriode) return true; $this->m_bInPCodeChangementDePeriode = true; $bOK = $this->Fc9faed17(TRT_AffichagePeriodeAgenda, 0); $this->m_bInPCodeChangementDePeriode = false; return $bOK; } function F2a8e6b09($pszRessource, $clDateDebut, $clDateFin, &$pclTabEvenement, $nFlag ) { $nNbEvenemenet = count($this->m_clTabEvenement,COUNT_NORMAL); for ($i=0;$i<$nNbEvenemenet;++$i) { $pclEvenement =& $this->m_clTabEvenement[$i]; if (!isset($pclEvenement)) continue; if ((''!==$pszRessource) && !$pclEvenement->Fb8d1ae4b($pszRessource)) continue; if ($pclEvenement->F35877954($clDateDebut,$clDateFin,$nFlag )) { if ( Fdef56c7f($nFlag,4) && $pclEvenement->Fd1226579() ) { $pclNewEveRepete = _clone($pclEvenement); $pclNewEveRepete->m_bEstUnCInstEvenementAgendaRepete = true; $clDateMin = new CDateAgenda(); $clDateMax = new CDateAgenda(); $pclEvenement->F2bc4c738( $clDateMin, $clDateMax ); $pclNewEveRepete->F41dfd0d7( $clDateMin, $clDateMax ); $pclTabEvenement[] =& $pclNewEveRepete; } else { if ( Fdef56c7f($nFlag, 2) && $pclEvenement->F1cb01ddc() && F5f7235e7($nFlag, ($pclEvenement->m_bJourneeEntiere ? 8 : 16))) { $this->Fea02aa3b( $pclEvenement, $pclTabEvenement, $clDateDebut, $clDateFin ); } else { $pclTabEvenement[] =& $pclEvenement; } } } if ( $pclEvenement->m_clPeriodicite->m_bAvecRepetition && Fdef56c7f($nFlag, 1)) { $clDateDebutIter= new CDateAgenda($pclEvenement->m_clDateFin); $nIndiceRepetition = 1; $pclRepetitionPrec = null; while ($clDateDebutIter->F874b87d7($clDateFin) ) { $pclRepetitionEve =& $pclEvenement->Fb27fa891($pclRepetitionPrec, $clDateDebutIter,$clDateFin, $nIndiceRepetition ); if ($pclRepetitionEve === null) break; $pclTabEvenement[] =& $pclRepetitionEve; $clDateDebutIterNew = new CDateAgenda($pclRepetitionEve->m_clDateFin); if ($clDateDebutIterNew->F874b87d7($clDateDebutIter)) { break; } $clDateDebutIter->F278c4330($clDateDebutIterNew); $pclRepetitionPrec =& $pclRepetitionEve; ++$nIndiceRepetition; } } } } function Fa46249be( &$pclDateSuiv ) { $clDateRes = new CDateAgenda(); $this->F696236c4( $clDateRes ); switch ( $this->m_eModeZoom ) { case eZoomJournee: $clDateRes->Fee154cfe(1); while ($this->F5dc125fb($clDateRes)) { $clDateRes->Fee154cfe(1); } break; case eZoomSemaine: $clDateRes->Fee154cfe(7); break; case eZoomMois: $clDateRes->F8d78b591( $this->m_clMoisCourant->F09992612() ); $clDateRes->F328928c5(1); break; case eZoomAnnee: $clDateRes->F8d78b591( $this->m_clMoisCourant->F09992612() ); $clDateRes->F7fae8dcf(1); break; default: break; } $pclDateSuiv->F278c4330( $clDateRes ); } function F5dc125fb(&$clData ) { if ($this->m_nNbJourModeSemaine === 7) return false; $nNumJourSem = $clData->F4c110548(); if ($nNumJourSem === 0 ) return true; if ($nNumJourSem === 6 ) return true; return false; } function Fc9d0a157( &$pclDatePrev ) { $clDateRes = new CDateAgenda(); $this->F696236c4( $clDateRes ); switch ( $this->m_eModeZoom ) { case eZoomJournee: $clDateRes->Fee154cfe(-1); while ($this->F5dc125fb($clDateRes)) { $clDateRes->Fee154cfe(-1); } break; case eZoomSemaine: $clDateRes->Fee154cfe(-7); break; case eZoomMois: $clDateRes->F8d78b591( $this->m_clMoisCourant->F09992612() ); $clDateRes->F328928c5(-1); break; case eZoomAnnee: $clDateRes->F8d78b591( $this->m_clMoisCourant->F09992612() ); $clDateRes->F7fae8dcf(-1); break; default: break; } $pclDatePrev->F278c4330($clDateRes); } function Fcb923550() {return $this->m_bAvecBoutonChangePeriode;} function F7d08dde4( &$rclDateMin, &$rclDateMax) { $this->F3d183ecf( $rclDateMin, $rclDateMax, $this->m_eModeZoom, $this->m_nNbJourModeSemaine); } function F5058013e($nNumJourSemaine) { $nNumJourOUT = ($nNumJourSemaine - $this->m_nNumJour1erCol) % NBJOURS_SEMAINE; if ($nNumJourOUT < 0) $nNumJourOUT += NBJOURS_SEMAINE; return $nNumJourOUT; } function F696236c4(&$pclDateHeure) { if (($this->m_eModeZoom === eZoomMois) || ($this->m_eModeZoom === eZoomAnnee)) { $cl1erJour = new CDateAgenda(); $nJourDebutMois = $this->m_clMoisCourant->F4c110548(); $nColDebutMois = $this->F5058013e( $nJourDebutMois ); $nNumJour0 = 1 - $nColDebutMois; if ($nNumJour0 === 1) $nNumJour0 -= NBJOURS_SEMAINE; $cl1erJour->F3d039ca0($this->m_clMoisCourant->F09992612()); $cl1erJour->Fee154cfe( $nNumJour0-1 ); $pclDateHeure->F11eb7106( $cl1erJour->F88619f97(), $cl1erJour->Fb8def891(), $cl1erJour->F2c61a952() ); $pclDateHeure->Fadb98d95(); } else { $pclDateHeure = _clone( $this->m_clDateDebutAff ); } } function F3d183ecf( &$pclDateMin, &$pclDateMax, $eModeZoom, $nNbJourModeSemaine ) { $this->F696236c4( $pclDateMin ); $pclDateMax->F5d5b7869($pclDateMin); $pclDateMin->m_dwHeure = $this->m_clHeureDebutAff->m_dwHeure; $pclDateMax->m_dwHeure = $this->m_clHeureFinAff->m_dwHeure; $nNumJourSem = $this->m_clDateDebutAff->F4c110548(); $nDecalePourBon1erJour = $this->m_nNumJour1erCol-$nNumJourSem; if ($nNumJourSem < $this->m_nNumJour1erCol) $nDecalePourBon1erJour -= 7; switch ( $eModeZoom ) { case eZoomJournee: break ; case eZoomSemaine: $pclDateMin->Fee154cfe( $nDecalePourBon1erJour) ; $pclDateMax->Fee154cfe( $nDecalePourBon1erJour + $nNbJourModeSemaine-1); break; case eZoomMois: $pclDateMin->Fadb98d95(); $pclDateMax->F5d5b7869( $pclDateMin ); $pclDateMax->Fee154cfe( 6 * 7 - 1); break; case eZoomAnnee: $pclDateMax->F7fae8dcf(1); break; default: return; } } function Fb6247526() { return $this->m_czMasqueHeureForce == '' ? $this->m_czMasqueHeure : $this->m_czMasqueHeureForce; } function F0a0e8cf9() { $this->m_czMasqueHeure = 'H:MM'; } function Fd92b80d4( &$pclEvenement ) { if ($pclEvenement === null) return false; if ($this->m_pclEveSurvol === null) return false; if (serialize($pclEvenement) === serialize($this->m_pclEveSurvol)) return true; $pclEvenementGenerateur = null; if ($this->m_pclEveSurvol->F9f43fae3( $pclEvenementGenerateur )) { if (serialize($pclEvenement) === serialize($pclEvenementGenerateur)) return true; } return false; } function F55d8e854(&$pclEvenement , $nNumElemt, $nFlag ) { $this->F4bacaed9( $pclEvenement ); parent::Fc3b3ab43( $nNumElemt, $nFlag, $pclEvenement ); if ($nFlag == nFROM_FONC) { $this->F725996f1( $pclEvenement ); } } function F725996f1( &$pclEvenement ) { UNUSED($pclEvenement); } function Fd9e88f73($nNumElemt, $bSelection) { if ($nNumElemt<0) return; if ($this->m_pclVue !== null) { if (($this->m_pclEveSelection !== null) && $this->m_pclEveSelection->F9f43fae3(getRef(null))) $this->m_pclVue->F013adc8c( $this->m_pclEveSelection ); $this->m_pclVue->F013adc8c($this->m_clTabEvenement[$nNumElemt]); } } function F325a961e() { $nIndiceEvenement = $this->F5c14ecc7(); if ($this->m_clGestFichierParcouru->F9ad43ee4()) { $this->m_clGestFichierParcouru->F4cad654a( $nIndiceEvenement ); } } function Fc39f8252( $nIndice, $dwFlags ) { $pclEvt =& $this->Faa22a1bf($nIndice); if ($this->F4e7e3d4a($nIndice)) { $null = null; $this->F55d8e854($null, nNUMELEMENT_INVALIDE, nFROM_DELSEL); unset($null); } if ( $this->Fd92b80d4( $this->m_clTabEvenement[$nIndice]) ) { $null = null; $this->m_pclEveSurvol =& $null; unset($null); } $this->F3ee935df($this->m_clTabEvenement[$nIndice]); $this->F78abe36d($nIndice, $dwFlags); } function F78abe36d($nIndice, $dwFlags) { if(!$this->Fd4c80e66($nIndice)) return; $pclEvtSuppr =& $this->m_clTabEvenement[$nIndice]; $this->Faee5970a($pclEvtSuppr, $nIndice, $dwFlags); unset($this->m_clTabEvenement[$nIndice]); if (array_key_exists($nIndice+1,$this->m_clTabEvenement)) { $this->m_clTabEvenement = array_values($this->m_clTabEvenement); } } function Faee5970a($pclEvtSuppr,$nIndiceSuppression,$dwFlags) { if(Fdef56c7f($dwFlags, 1)) { $this->m_clGestFichierParcouru->F9159144d( $nIndiceSuppression ); } $this->F8b19dbb0(); } function F11450529( $nIndiceC ) { $this->Fc39f8252( $nIndiceC,1 ); } function Ff27b0340( $nIndice ) { $this->Fc39f8252( $nIndice,0 ); } function F357784ea($pclEvenement , $nNumElemt, $nFlag ) { if (parent::F4e7e3d4a($nNumElemt)) { $this->F55d8e854(getRef(null), nNUMELEMENT_INVALIDE, nFROM_DELSEL); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function Fd4c80e66( $nIndiceC, $bAvecErreur=false ) { $nMax = count($this->m_clTabEvenement,COUNT_NORMAL); if (($nIndiceC<0) || ($nIndiceC >= $nMax) ) { if ($bAvecErreur) { F67cfd262(); Fdd46bacf(FMK_ChaineConstruit(Fc34ec142('ERR_OUTOFBOUND'),$nIndiceC+1,$this->Fd464306b(),$nMax)); } return false; } return true; } function F9ab17b6e(&$pclEvenement) { if (!$this->Fa76a5a57($pclEvenement)) return false; return $this->m_bDeplaceEvenementParUser; } function Fedf458ec(&$pclEvenement) { if (!$this->Fa76a5a57($pclEvenement)) return false; return !$this->m_bEditInPlaceInterdit; } function F74df5824($pclEvenement) { if (!$this->Fa76a5a57($pclEvenement)) return false; if ($this->m_eModeZoom === eZoomMois) return false; return $this->m_bRedimEvenementParUser; } function F0851fca1(&$pclEvenement, &$clDateMin, &$clDateMax ) { if ($pclEvenement === null) return; $pclEvenementBase=null; if ($pclEvenement->F29893c95( $pclEvenementBase )) { $clDateMinBaseCur = new CDateAgenda(); $clDateMaxBaseCur = new CDateAgenda(); $pclEvenementBase->F2bc4c738( $clDateMinBaseCur, $clDateMaxBaseCur ); if ($clDateMinBaseCur->F07546576($clDateMin)) { $this->F0851fca1($pclEvenementBase, $clDateMin, $clDateMaxBaseCur); } else { $this->F0851fca1($pclEvenementBase, $clDateMinBaseCur, $clDateMax); } return; } $clDateMinCur = new CDateAgenda(); $clDateMaxCur = new CDateAgenda(); $pclEvenement->F2bc4c738( $clDateMinCur, $clDateMaxCur ); if ( $clDateMin->F0ee5647e($clDateMinCur) && $clDateMax->F0ee5647e($clDateMaxCur) ) { return; } $pclEvenement->F41dfd0d7( $clDateMin, $clDateMax ); $piVue =& $this->m_pclVue; if (isset($piVue)) { $piVue->F013adc8c($pclEvenement); } $nNumEve = $this->F5c14ecc7(); $this->Fc9faed17(TRT_RedimRdvAgenda, 0, $nNumEve); $this->m_clGestFichierParcouru->F783c0b63( $nNumEve ); } function F6e4a8c18(&$pclEvenement) { foreach ($this->m_clTabEvenement as $nIndice => $pclEveCourant) { if ($pclEveCourant->m_dwIDUnique===$pclEvenement->m_dwIDUnique) return $nIndice; } } function F83a3eb72() { if (!$this->Fd359811d()) { return; } $nItemSelectAvant = $this->F5c14ecc7(); if ( $nItemSelectAvant === nNUMELEMENT_INVALIDE) return; if (!$this->Fc9faed17(TRT_SupprimeRdvAgenda, 1 | 2, $nItemSelectAvant) ) { return; } $nItemSelect = $this->F5c14ecc7(); if ( $nItemSelect === nNUMELEMENT_INVALIDE) return; if ( $nItemSelectAvant !== $nItemSelect) return; $this->m_clGestFichierParcouru->F9159144d( $nItemSelect ); $this->Ff27b0340( $nItemSelect ); } function Fd359811d() { return (Fdef56c7f($this->m_nActionAutoriseeBase,nACTSRC_SUPPR) || !$this->F48dce54a()); } function Fa76a5a57(&$pclEvenement) { return ( ($pclEvenement !== null) && ($pclEvenement->F9f43fae3(getRef(null)) === false) && $this->Etat===0); } function F1184b744($pszSaisieInitiale, $pszTitre, &$rclDateDebut, &$rclDateFin, $clCouleur, $pszCategorie, $pszRessource, $nZone) { $nNewEve = $this->Fb450beda($pszTitre, $rclDateDebut, $rclDateFin, $clCouleur, $pszCategorie, $pszRessource); if ($nNewEve === -1) return; $pclNewEve =& $this->Faa22a1bf( $nNewEve ); if ($pclNewEve === null) return; if ( $nZone === 2) { $pclNewEve->SetJourneeEntiere( true ); $clDateDebutJE = new CDateAgenda($rclDateDebut); $clDateDebutJE->Fadb98d95(); $clDateFinJE = new CDateAgenda($rclDateFin); $clDateFinJE->Fadb98d95(); $pclNewEve->F41dfd0d7($clDateDebutJE, $clDateFinJE); $this->Fb366a777(); } $this->F55d8e854($pclNewEve, $nNewEve, nFROM_ADDNEW ); $this->m_bEnCreationNouveauRDV = true; if (!$this->Fc9faed17(TRT_AjouteRdvAgenda, 1 | 2, $nNewEve) ) { $pclEveASupprime =& $this->Faa22a1bf( $nNewEve ); if (($pclEveASupprime !== null) && (serialize($pclEveASupprime) === serialize($pclNewEve))) { $this->Ff27b0340( $nNewEve ); } $this->m_bEnCreationNouveauRDV = false; return; } if (!$this->Fd4c80e66($nNewEve)) return; $this->m_bInAjouteRDVFromUser = true; $bOKEdit = $this->F5d130629( $pclNewEve, $nNewEve, $pszSaisieInitiale ); $this->m_bInAjouteRDVFromUser = false; if (!$bOKEdit) { $this->Ff27b0340($nNewEve); $this->m_bEnCreationNouveauRDV = false; return; } if (false === $this->m_clGestFichierParcouru->F457f1b52( $nNewEve )) { } $this->m_bEnCreationNouveauRDV = false; } function F5d130629(&$pclNewEve,$nNewEve, $pszSaisieInitiale ) { if ($pclNewEve === null) return false; if ($this->m_bEditInPlaceInterdit) return true; return $this->m_pclVue->Fe5801fdf($pclNewEve, $nNewEve, $pszSaisieInitiale); } function F4ed1c0b0(&$pclNewEve, $nNewEve, $pszNouveauTitre, $pbRepriseSaisieThis = null) { if (false !== utf8_strpos($pszNouveauTitre,"\n")) { $pszNouveauTitre = utf8_str_replace("\n"," ",utf8_str_replace("\r\n"," ",$pszNouveauTitre)); } $cszNouveauContenu=''; if (false === $this->m_bAfficherTitreRendezVous) { $cszNouveauContenu = $pszNouveauTitre; $pszNouveauTitre = ''; } $pclNewEve->SetTitre($pszNouveauTitre); if ('' != $cszNouveauContenu) { $pclNewEve->SetContenu($cszNouveauContenu); } $this->m_pclVue->F013adc8c($pclNewEve); if (!$this->Fc9faed17(TRT_ModifTitreRdvAgenda, 0, $nNewEve, array(&$pbRepriseSaisieThis))) return false; $this->m_clGestFichierParcouru->F783c0b63( $nNewEve ); return true; } function& Faa22a1bf($nIndex) {return $this->m_clTabEvenement[$nIndex];} function& operateurSub( $clIndice ) { $nIndice = F075ca95b($clIndice) - 1; if (isset($this->m_clTabEvenement[$nIndice])) return $this->m_clTabEvenement[$nIndice]; return Fe81a7f9e('ERR_INDICE_TABLEAU',count($this->m_clTabEvenement,COUNT_NORMAL),$nIndice,''); } function& Fc91f0eb7( $clEvenement, $clIndice ) { $nIndice = F075ca95b($clIndice) - 1; if (!isset($this->m_clTabEvenement[$nIndice])) return Fe81a7f9e('ERR_INDICE_TABLEAU',count($this->m_clTabEvenement,COUNT_NORMAL),$nIndice,''); return $this->m_clTabEvenement[$nIndice]->Fcc4f5b5d($clEvenement); } function Fd756fa39() { $this->m_czMasqueHeure = EnvGet('FORMATHEURESYSTEME'); if (empty($this->m_czMasqueHeure))$this->m_czMasqueHeure = 'H:MM'; else { $this->m_czMasqueHeure = utf8_str_replace(':SS','',utf8_str_replace('HH','H',$this->m_czMasqueHeure)); } } function F302508e9() { return true; } function Fd5c0247a() { return false; } function& F30c4a4e3() { return $this->m_pclEveSelection; } function& F5d0f7bd5() { return $this->m_pclEveSurvol; } function& Febbdb070($dwIDUnique,&$rnIndice) { $rnIndice = 0; $nNbEvts = count($this->m_clTabEvenement,COUNT_NORMAL); for ($nEvenement = 0; $nEvenement < $nNbEvts; ++$nEvenement) { if ($dwIDUnique === $this->m_clTabEvenement[$nEvenement]->m_dwIDUnique) { $rnIndice = $nEvenement; return $this->m_clTabEvenement[$nEvenement]; } } return getRef(null); } function Fe4bcb035( &$pclEveSurvolNew ) { if (serialize($this->m_pclEveSurvol) === serialize($pclEveSurvolNew) ) return; $this->m_pclEveSurvol =& $pclEveSurvolNew; } function F4bacaed9( &$pclEveSelNew ) { if (serialize($this->m_pclEveSelection) === serialize($pclEveSelNew) ) return; $this->m_pclEveSelection =& $pclEveSelNew; } function Fbd897cbd() { $clDateDebutMois = new CDateAgenda($this->m_clDateDebutAff); if (($this->m_eModeZoom === eZoomMois) || ($this->m_eModeZoom === eZoomAnnee)) { $clDateDebutMois->Fee154cfe(7); } $clDateDebutMois->Fadb98d95(); $clDateDebutMois->Fee154cfe( - $clDateDebutMois->nGetJour()+1 ); $this->m_clMoisCourant->Fea34dd7d( $clDateDebutMois->F09992612() ); } function F229e02d8(&$pclDateHeure) { $clDateDebut = new CDateAgenda(); $this->F7d08dde4( $clDateDebut, $pclDateHeure ); } function F315ddf5b($pszHeure, &$pclHeure ) { if ($pszHeure === null) return false; if (!Fd3b5396b($pszHeure)) return false; $pclHeure->Raz(); $pclHeure->Fadf0ba4c( F04e7ba0d($pszHeure,8,true,-1) ); return true; } function bSetPlageHoraireVisible($pszHeureMin, $pszHeureMax) { $eFlag = 0; if (!empty($pszHeureMin)) { if (!$this->F315ddf5b($pszHeureMin, $this->m_clHeureDebutAff)) return false; $eFlag |= 1; } if (!empty($pszHeureMax)) { if (!$this->F315ddf5b($pszHeureMax, $this->m_clHeureFinAff)) return false; $eFlag |= 2; } if ( !$this->m_clHeureFinAff->Fa68634db($this->m_clHeureDebutAff) ) { if ($this->m_clHeureDebutAff->nGetHeure() > 22) $this->m_clHeureDebutAff->Fadf0ba4c('220000'); $this->m_clHeureFinAff = $this->m_clHeureDebutAff; $this->m_clHeureFinAff->bDecaleHeure(1); return false; } $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); return true; } function bSetPlageHoraireOuvrables( $pszHeureMin, $pszHeureMax ) { if (!F315ddf5b($pszHeureMin, $this->m_clHeureOuvrableMin)) return false; if (!F315ddf5b($pszHeureMax, $this->m_clHeureOuvrableMax)) return false; $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); return true; } function F6da3b7d3() { if ($this->m_clDateDebutAff->F0ee5647e($this->m_clHeureFinAff)) return; if ($this->m_nHauteur === 0) return; $nDureeAff = 0; $clDateMinPourDuree = new CDateAgenda($this->m_clDateDebutAff); $clDateMinPourDuree->Facd8fefd($this->m_clHeureDebutAff); $clDateMaxPourDuree = new CDateAgenda($this->m_clDateDebutAff); $clDateMaxPourDuree->Facd8fefd( $this->m_clHeureFinAff ); XVERIFY( F0744b8b4( $clDateMaxPourDuree, $clDateMinPourDuree, $nDureeAff ) === WLO_OK ); $clDureeAff = new FMK_Date_Duree(F04e7ba0d($nDureeAff,utf8_strlen('JHHMMSSLLL'),true),'JHHMMSSLLL'); $dDureeEnHeure = $clDureeAff->F031293c7(); unset($clDureeAff); if ($dDureeEnHeure <= 0) return; if ($dDureeEnHeure > 24) $dDureeEnHeure = 24; $this->m_nHauteur1Heure = (int)floor((int)$this->m_nHauteur / $dDureeEnHeure); } function Fc9faed17( $eIdTraitement, $nFlag, $nIndiceEvenement = -1, $rtabRepriseSaisieThis = null ) { if ($rtabRepriseSaisieThis !== null) { $pbRepriseSaisieThis =& $rtabRepriseSaisieThis[0]; } $pbRepriseSaisieThis = false; global $MaPage; if ($MaPage === null) { return false; } if (-1 !== $nIndiceEvenement) { $pclEvenement =& $this->m_clTabEvenement[$nIndiceEvenement]; if (!isset($pclEvenement)) return Fe81a7f9e('ERR_INDICE_TABLEAU',count($this->m_clTabEvenement,COUNT_NORMAL),$nIndiceEvenement,''); $clRetVal = $this->Fc1a6d5f6($eIdTraitement, array(&$pclEvenement)); } else { $clRetVal = $this->Fc1a6d5f6($eIdTraitement); } if (headers_sent()) return false; if (Fdef56c7f($nFlag, 1)) { if (isset($clRetVal)) { return VersBooleen($clRetVal); } } return true; } function F07803e95($nFlag) { $this->Fbd897cbd(); $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); if (!$this->Fc9faed17(TRT_AffichagePeriodeAgenda, 0) ) { return; } } function F76763e0b(&$pclResolution, $eTypeResolution ) { $pclResolution->Raz(); switch ($this->m_eModeZoom) { case eZoomJournee: case eZoomSemaine: { switch ($eTypeResolution) { case 0: case 2: $pclResolution->setMinute($this->m_nGranulariteRDV_Deplacement); break; case 1: if ($this->Ff44acd3b() && $this->m_nGranulariteRDV_Redim < 1440) { $pclResolution->setMinute( 1440 ); return; } $pclResolution->setMinute($this->m_nGranulariteRDV_Redim); break; case 3: { $nResMin = min($this->m_nGranulariteRDV_Redim, $this->m_nGranulariteRDV_Deplacement); $pclResolution->setMinute($nResMin); } break; default: break; } } break; case eZoomMois: case eZoomAnnee: $pclResolution->setJour(1); break; default: $pclResolution->setJour(1); break; } } function F135a0611($pszTitre, $clDateDebut, $clDateFin, $clCouleur, $pszCategorie, $pszRessource ) { $nNumAjoute = $this->Fb450beda( $pszTitre , $clDateDebut, $clDateFin, $clCouleur, $pszCategorie, $pszRessource ); if ($nNumAjoute==-1) return -1; if (false === $this->m_clGestFichierParcouru->F457f1b52( $nNumAjoute )) { return -1; } return $nNumAjoute; } function Fa5831e6d( &$pclRdvDino ) { $nNumAjoute = $this->Fe616e2e1( $pclRdvDino,1 ); if ($nNumAjoute===-1) return -1; if (false === $this->m_clGestFichierParcouru->F457f1b52( $nNumAjoute )) { return -1; } return $nNumAjoute; } function F249afae0(&$pclEvt, $dwFlags) { if($pclEvt === null) return -1; $this->m_clTabEvenement[] =& $pclEvt; $nIndiceAjout = count($this->m_clTabEvenement,COUNT_NORMAL)-1; $this->F89cfb107($pclEvt, $nIndiceAjout, $dwFlags); return $nIndiceAjout; } function Fb450beda( $pszTitre, $clDateDebut, $clDateFin, $clCouleur, $pszCategorie, $pszRessource, $dwFlags=0) { $pclEvenementNew = new CDinoRendezVous(); $pclEvenementNew->SetTitre( $pszTitre ); $pclEvenementNew->F41dfd0d7( $clDateDebut, $clDateFin ); if ($pszCategorie !== '')$pclEvenementNew->SetCategorie( $pszCategorie ); $clCouleurFond = ($this->Fd625faec($pclEvenementNew, false, $clCouleur)); $pclEvenementNew->m_nCouleurFond = $clCouleurFond->m_dwColor; if (F8b98af41($pszRessource)) { $pclEvenementNew->SetRessource($pszRessource); } $this->F249afae0($pclEvenementNew,$dwFlags); $this->F8b19dbb0(); return (count($this->m_clTabEvenement,COUNT_NORMAL)-1); } function F89cfb107($clEvtAjoute, $nIndiceAjout, $dwFlags) { if(Fdef56c7f($dwFlags, 1)) { if (!$this->m_clGestFichierParcouru->F457f1b52( $nIndiceAjout )) { } } $clCouleur =& $clEvtAjoute->m_clCouleur; if ($this->Ffa0a9b1c($clCouleur)) { $pclEvenementNew =& $this->Faa22a1bf($nIndiceAjout); $clCouleurEffective = $this->Fd625faec($pclEvenementNew, false); $pclEvenementNew->m_clCouleur->m_dwColor = $clCouleurEffective->m_dwColor; } $this->F8b19dbb0(); } function Fd625faec( $pclEvenement, $bSelected=null, $clCouleur=null ) { if (!isset($bSelected)) $bSelected = $this->F4e7e3d4a($pclEvenement); if (!isset($clCouleur)) $clCouleur =& $pclEvenement->m_clCouleur; if ($this->Ffa0a9b1c($clCouleur)) { return $this->F63561223($pclEvenement, $bSelected); } else { return $clCouleur; } } function F4e7e3d4a($pclEvenementRech) { if (!is_object($pclEvenementRech)) return parent::F4e7e3d4a($pclEvenementRech); if ($this->F5c14ecc7() === nNUMELEMENT_INVALIDE) return false; if ($this->m_pclEveSelection === null) return false; if (!$this->Fd4c80e66($this->F5c14ecc7())) return false; $pclEveSelect =& $this->m_pclEveSelection; $pclEvenementOrig = null; $pclEvenementOrigRech = null; if ( $this->m_pclEveSelection->F9f43fae3($pclEvenementOrig) && $pclEvenementRech->F9f43fae3($pclEvenementOrigRech) ) { return ($pclEvenementOrig->m_dwIDUnique === $pclEvenementOrigRech->m_dwIDUnique) && ($this->m_pclEveSelection->F16b970ec($pclEvenementRech)); } if ($pclEvenementRech->F29893c95($pclEvenementOrig)) { return $pclEveSelect->m_dwIDUnique == $pclEvenementOrig->m_dwIDUnique; } return $pclEveSelect->m_dwIDUnique === $pclEvenementRech->m_dwIDUnique; } function F63561223( $pclEvenement, $bSelected ) { if ($bSelected) { $pclCadreEvtSelect =& F264709eb($this,'m_clCadreEvementSelect'); $clCouleurFondStyle =& $pclCadreEvtSelect->m_clFond; if ($clCouleurFondStyle->F01589132()) return $clCouleurFondStyle; } $pclCadreEvement =& F264709eb($this,'m_clCadreEvement'); $clCouleurFondStyle =& $pclCadreEvement->m_clFond; if ($clCouleurFondStyle->F01589132()) return $clCouleurFondStyle; return new CCouleur(F6fa4e776($pclEvenement->GetCategorie())); } function Ffa0a9b1c($clCouleur) { return !isset($clCouleur) || ($clCouleur->m_dwColor === dwCODEAutomatique); } function Fe616e2e1( &$pclRdvDino, $dwFlags ) { $clCouleurEffective = $this->Fd625faec($pclRdvDino, false); $pclEvenementNew = new CDinoRendezVous($pclRdvDino); if(isset($clCouleurEffective)) { $pclEvenementNew->m_clCouleur->m_dwColor = $clCouleurEffective->m_dwColor; } return $this->F249afae0($pclEvenementNew,$dwFlags); } function F7cccecd5($pclPeriodeRech ) { $nNbEve = count($this->m_clTabEvenement,COUNT_NORMAL); for ($i=0;$i<$nNbEve;++$i) { $pclEvenement =& $this->m_clTabEvenement[$i]; if (serialize($pclEvenement->m_clPeriodicite) === serialize($pclPeriodeRech) ) { return $i; } } return -1; } function Fea02aa3b($pclEvenement, &$pclTabEvenement, $pclDateDebut, $pclDateFin) { $clDateMin = new CDateAgenda(); $clDateMax = new CDateAgenda(); $pclEvenement->F2bc4c738( $clDateMin, $clDateMax ); if ($this->F0c6ce572() && $clDateMax->Fa68634db($clDateMin)) $clDateMax->F5c1f4197(); if ($clDateMin->m_dwDate === 0) return; if ($clDateMax->m_dwDate === 0) return; $pclDateMinDecoupe =& $this->m_clHeureOuvrableMin; $pclDateMaxDecoupe =& $this->m_clHeureOuvrableMax; if ($this->Fc0755c6a()) { $pclDateMinDecoupe =& $this->m_clHeureDebutAff ; $pclDateMaxDecoupe =& $this->m_clHeureFinAff ; } $clDateCourante = new CDateAgenda($clDateMin); $clDateCourante->Facd8fefd( $pclDateMaxDecoupe ); if ( $clDateMin->Fa68634db($clDateCourante) ) $clDateCourante->F35ed58e9(); $this->F936225ba($pclEvenement,$pclTabEvenement, $clDateMin, $clDateCourante, $pclDateDebut, $pclDateFin ); $clDateCourante->Facd8fefd( $pclDateMinDecoupe ); if (!$this->F302508e9()) $clDateCourante->Fadb98d95(); $clDateCourante->Fee154cfe(1); while ( !$clDateCourante->F07546576($clDateMax) && $clDateCourante->Ffe96069b($clDateMax) ) { $clDateCouranteMax = new CDateAgenda($clDateCourante); $clDateCouranteMax->Facd8fefd( $pclDateMaxDecoupe ); if (!$this->F302508e9()) $clDateCouranteMax->F35ed58e9(); $this->F936225ba($pclEvenement,$pclTabEvenement, $clDateCourante, $clDateCouranteMax, $pclDateDebut, $pclDateFin ); $clDateCourante->Fee154cfe(1); } if ( $clDateMax->Ffe96069b($clDateCourante) ) { $clDateCourante->Fadb98d95(); if ($clDateCourante->F0ee5647e($clDateMax) ) return; } $this->F936225ba($pclEvenement,$pclTabEvenement, $clDateCourante, $clDateMax, $pclDateDebut, $pclDateFin ); } function F7593ffad($dwFlags) { $this->F857e9259(); parent::F7593ffad($dwFlags); } function F936225ba( $pclEvenement, &$pclTabEvenement, $clDateMin, $clDateMax, $pclDateBorneMin=null, $pclDateBorneMax=null) { if ( ( ($pclDateBorneMax === null) || !$pclDateBorneMax->Ffe96069b($clDateMin)) && ( ($pclDateBorneMin == null) || !$pclDateBorneMin->Fa68634db($clDateMax))) { $pclEvenementNew = _clone($pclEvenement); $pclEvenementNew->m_pclCInstEvenementMultiJourSur1Jour =& $pclEvenement; $pclEvenementNew->F41dfd0d7( $clDateMin, $clDateMax ); $pclTabEvenement[] =& $pclEvenementNew; } } function& vpclGetElementStyleCadreLibelle ($eElement, $tabCouleurPrincipale = null) { if (isset($tabCouleurPrincipale)) { $rstOptionsCouleur =& $tabCouleurPrincipale[0]; } switch ($eElement) { case ELEMENTSTYLE_AGENDA_LIBHEURE: return $this->m_pclStyle->m_clLibHeure; case ELEMENTSTYLE_AGENDA_RENDEZVOUS: if (isset($rstOptionsCouleur)) $rstOptionsCouleur->m_bTransformeAutomatique = true; return $this->m_pclStyle->m_clCadreEvement; case ELEMENTSTYLE_AGENDA_RENDEZVOUSSELECT: if (isset($rstOptionsCouleur)) $rstOptionsCouleur->m_bTransformeAutomatique = true; return $this->m_pclStyle->m_clCadreEvementSelect; case ELEMENTSTYLE_AGENDA_LIBCONTENU: return $this->m_pclStyle->m_clLibContenu; case ELEMENTSTYLE_AGENDA_LIBCONTENUSELECT: return $this->m_pclStyle->m_clLibContenuSelect; case ELEMENTSTYLE_AGENDA_LIBNUMEROSEMAINE: return $this->m_pclStyle->m_clLibNumeroSemaine; case ELEMENTSTYLE_AGENDA_LIBNOMMOIS: return $this->m_pclStyle->m_clLibNomMois; case ELEMENTSTYLE_AGENDA_JOURNEECOMPLETE: return $this->m_pclStyle->m_clCadreJourneeComplete; default: return parent::vpclGetElementStyleCadreLibelle($eElement, $tabCouleurPrincipale); } } function Fcb7727d8() { if (!$this->m_bAfficheNumeroDeSemaine) return false; $eNewModeZoom = $this->m_eModeZoom; if (($eNewModeZoom === eZoomMois) || ($eNewModeZoom === eZoomAnnee )) return false; return true; } function F0ceb67f5($clDate, &$pczNumSemaineAff) { $sChaine=''; $clDate->Fc6436172($sChaine); $pczNumSemaineAff = FMK_ChaineConstruit(empty($this->m_cszMasqueNumeroSemaine) ? F1ac3f040('IDS_NUMEROSEMAINE') : $this->m_cszMasqueNumeroSemaine,F6226d5b6($sChaine)); return true; } } function Fea383df3(&$tabRendezVous) { Ff3c49668($tabRendezVous,TT_FONCTION_INTERNE,array(CALLBACK_COMPARE_EVENEMENTS,1 | 8 | 32 | 64)); } function F04b3504c(&$tabRendezVous) { Ff3c49668($tabRendezVous,TT_FONCTION_INTERNE,array(CALLBACK_COMPARE_EVENEMENTS,1)); } function Fd430a9de(&$tabRendezVous) { Ff3c49668($tabRendezVous,TT_FONCTION_INTERNE,array(CALLBACK_COMPARE_EVENEMENTS,1 | 4 | 8 | 32 | 64)); } function F16dfe7a6(&$tabRendezVous) { Ff3c49668($tabRendezVous,TT_FONCTION_INTERNE,array(CALLBACK_COMPARE_EVENEMENTS,0)); } function F87538880(&$tabRendezVous) { Ff3c49668($tabRendezVous,TT_FONCTION_INTERNE,array(CALLBACK_COMPARE_EVENEMENTS,4 | 64)); } function F6d092d5d(&$pclEve1,&$pclEve2) { $dwOptionsTri = isset($GLOBALS['usort_options']) ? $GLOBALS['usort_options'][0] : 0; if (F5f7235e7($dwOptionsTri, 1)) { $pszRessource1 = $pclEve1->m_sRessource; $pszRessource2 = $pclEve2->m_sRessource; $sValeurMemorisee = ''; $sValeurAffichee = ''; $bPossedeGARecuperer = false; $clGLien = null; $bGLien = false; XVERIFY( F159221ea($pszRessource1,$bGLien,$bPossedeGARecuperer,$clGLien,$sValeurAffichee) ); if ($bGLien) { $pszRessource1 = $clGLien; } $bGLien = false; XVERIFY( F159221ea($pszRessource2,$bGLien,$bPossedeGARecuperer,$clGLien,$sValeurAffichee) ); if ($bGLien) { $pszRessource2 = $clGLien; } $nRes = utf8_strcasecmp( $pszRessource1, $pszRessource2 ); if ($nRes !== 0) return $nRes; } $rclDateDebut1 = new CDateAgenda(); $rclDateFin1 = new CDateAgenda(); $rclDateDebut2 = new CDateAgenda(); $rclDateFin2 = new CDateAgenda(); $pclEve1->F2bc4c738($rclDateDebut1,$rclDateFin1); $pclEve2->F2bc4c738($rclDateDebut2,$rclDateFin2); if (F5f7235e7($dwOptionsTri, 2)) { $nRes = $rclDateDebut1->Ff5b208cb($rclDateDebut2); if (0 !== $nRes) return $nRes; } if (F5f7235e7($dwOptionsTri, 4)) { if ( $pclEve1->m_bJourneeEntiere !== $pclEve2->m_bJourneeEntiere ) { return $pclEve1->m_bJourneeEntiere ? -1 : 1; } } if (F5f7235e7($dwOptionsTri, 8)) { $pclEvenementBase1=null; $pclEve1->F29893c95($pclEvenementBase1); $rclDateDebutBase1 = new CDateAgenda(($pclEvenementBase1 === null) ? $rclDateDebut1 : $pclEvenementBase1->m_clDateDebut); $pclEvenementBase2=null; $pclEve2->F29893c95($pclEvenementBase2); $rclDateDebutBase2 = new CDateAgenda(($pclEvenementBase2 === null) ? $rclDateDebut2 : $pclEvenementBase2->m_clDateDebut); $nRes = $rclDateDebutBase1->Ff5b208cb($rclDateDebutBase2); if ($nRes !== 0) return $nRes; } if (F5f7235e7($dwOptionsTri, 16)) { $nRes = $rclDateFin2->Ff5b208cb($rclDateFin1); if ($nRes !== 0) return $nRes; } if (F5f7235e7($dwOptionsTri, 64)) { $pclEvenementBase1=null; $pclEve1->F29893c95($pclEvenementBase1); $rclDateFinBase1 = new CDateAgenda(($pclEvenementBase1 === null) ? $rclDateFin1 : $pclEvenementBase1->m_clDateFin); $pclEvenementBase2=null; $pclEve2->F29893c95($pclEvenementBase2); $rclDateFinBase2 = new CDateAgenda(($pclEvenementBase2 === null) ? $rclDateFin2 : $pclEvenementBase2->m_clDateFin); $nRes = $rclDateFinBase2->Ff5b208cb($rclDateFinBase1); if ($nRes !== 0) return $nRes; } if (F5f7235e7($dwOptionsTri, 32)) { return strcmp( $pclEve1->m_sTitre, $pclEve2->m_sTitre ); } else { return 0; } } function Fd3b5396b($pszHeure) { $nLen = utf8_strlen($pszHeure); if (($nLen != 2) && ($nLen != 4) && ($nLen != 6) && ($nLen != 8)) return false; $clDateHeure = new CDateTime(); if (!$clDateHeure->Fadf0ba4c( F04e7ba0d($pszHeure,8,true,-1) )) return false; return true; } function F315ddf5b( $pszHeure, &$pclHeure ) { if ($pszHeure == null) return false; if (!Fd3b5396b($pszHeure)) return false; $pclHeure->Raz(); if (!$pclHeure->Fadf0ba4c( F04e7ba0d($pszHeure,8,true,-1) )) return false; return true; } class CChampPlanning extends CChampAgenda { var $m_tabRessources = array(); var $m_pclRessources = null; var $m_nHauteurRuptureJour; var $m_nLargeurOuHauteurMinRessource; var $m_nGraduationLargeurOuHauteurPixel; var $m_nNbJourZoomLibre; var $m_bLargeurZoneRessourceAuto = false; var $m_eModeAffichagePlanning; var $m_eZoomNbJourPlanning; var $m_nLargeurZoneRessourceInitiale; var $m_nOffsetDateHeure1erLigneVisiblePixel; var $m_clDateHeure1erLigneVisible = null; var $m_clDateHeurePremierRDV; var $m_clDateHeureDernierRDV; var $m_bDateHeure1erLigneVisibleParProgrammation = false; var $m_n1erRessourceVisibleParProgrammation = -1; function CChampPlanning() { parent::CChampAgenda(); $this->m_pclRessources = new CDinoPlanningRessources(); $this->m_eModeAffichagePlanning = eModeAffPl_RessourceEnColonne; $this->m_bLargeurZoneRessourceAuto = true; $this->m_nLargeurZoneRessourceInitiale = 80; $this->m_eZoomNbJourPlanning = eZoomPl_LibreEnJour; $this->m_nNbJourZoomLibre = 3 ; $this->m_nGraduationLargeurOuHauteurPixel = 20; $this->m_nHauteurRuptureJour = 20; $this->m_nLargeurOuHauteurMinRessource = 80; $this->m_nOffsetDateHeure1erLigneVisiblePixel = 0; $this->m_clDateHeure1erLigneVisible = new CDateAgenda($this->m_clDateDebutAff); $this->m_clDateHeurePremierRDV = new CDateAgenda(); $this->m_clDateHeureDernierRDV = new CDateAgenda(); } function lierVM($sNomVM, $sNomWL, $sNomPHP) { parent::lierVM($sNomVM, $sNomWL, $sNomPHP); $this->m_pclRessources->m_pclPlanning =& $this; } function Feb661866() { return ID_PLANNING; } function F2d291cd8() { $this->m_pclStyle = new CStyleChampPlanning($this->m_piInfoLangue); return isset($this->m_pclStyle) ? NOERROR : E_FAIL; } function F4a917fa4() { return 80; } function F12828e6d( $eTypeVue) { return $this->F0198de68('CVueChampPlanning_Web',$eTypeVue); } function F56660bf0( $eTypeControleur) { return $this->Fea7a1f04('CControleurChampPlanning_Web',$eTypeControleur); } function Fb560a68a($dwFlags) { $this->Fc440ec80(); parent::Fb560a68a( $dwFlags); } function Fdc05d49f( $ValeurHTTP ) { } function& GetType() { return getRef(ID_PLANNING); } function& GetVertical() {return $this->m_eModeAffichagePlanning === eModeAffPl_RessourceEnColonne;} function SetVertical($bVertical) { $eModeAffichagePlanningNew = $bVertical ? eModeAffPl_RessourceEnColonne : eModeAffPl_RessourceEnLigne; if ($this->m_eModeAffichagePlanning === $eModeAffichagePlanningNew) return; $this->m_eModeAffichagePlanning = $eModeAffichagePlanningNew; $this->Fef796f1d(); $this->F6fb6d0cf( VERTICAL ); } function& GetRessource() {return $this->m_pclRessources;} function SetRessource($pclRessource) { Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_RESSOURCE"),F3b9ec4ca($this)); } function& GetHeureOuvrableDebut() {$return = $this->m_clHeureOuvrableMin->F2f635908(); return $return;} function SetHeureOuvrableDebut($pszHeure) { if (!$this->F315ddf5b($pszHeure,$this->m_clHeureOuvrableMin)) return; $this->F6fb6d0cf( HEUREOUVRABLEDEBUT ); } function& GetHeureOuvrableFin() {$return = $this->m_clHeureOuvrableMax->F2f635908(); return $return;} function SetHeureOuvrableFin($sHeureOuvrableFin) { if (!$this->F315ddf5b($sHeureOuvrableFin,$this->m_clHeureOuvrableMax)) return; $this->F6fb6d0cf( HEUREOUVRABLEFIN ); } function Fb1e154f7() { if (!$this->m_bSupportJourneeEntiere) return true; if (!$this->Ff44acd3b()) return false; return true; } function Fc05cf6e6() {return !$this->F10489c4e();} function Fe19d5a0a() { $nEvenementMin = $nEvenementMax = 0; if (!$this->F36829d4f($this->m_clTabEvenement,$nEvenementMin, $nEvenementMax )) { $this->m_clDateHeurePremierRDV->Ff04c7c3b(); $this->m_clDateHeureDernierRDV->Ff04c7c3b(); $this->Fd2210678(); return true; } $pclEvenementMin =& $this->m_clTabEvenement[$nEvenementMin]; $pclEvenementMax =& $this->m_clTabEvenement[$nEvenementMax]; $bModif = false; if (!$this->m_clDateHeurePremierRDV->F0ee5647e($pclEvenementMin->m_clDateDebut )) { $this->m_clDateHeurePremierRDV->F278c4330($pclEvenementMin->m_clDateDebut); $bModif = true; } if (!$this->m_clDateHeureDernierRDV->F0ee5647e($pclEvenementMax->m_clDateFin )) { $this->m_clDateHeureDernierRDV->F278c4330($pclEvenementMax->m_clDateFin); $bModif = true; } if($bModif) $this->Fd2210678(); return $bModif; } function F1bd63df7($clValeur, $nOption) { $nVal = intval($clValeur); if ($nVal <= 1) $nVal = 1; if ($nVal >= 7*MINUTE_PAR_JOUR) $nVal = 7*MINUTE_PAR_JOUR; if ($nVal > 60) { $nVal = $nVal - ($nVal % 60); } if ($nVal > MINUTE_PAR_JOUR) { $nVal = $nVal - ($nVal % MINUTE_PAR_JOUR); } if (($nVal < 60) && ($nVal > 1)) { $nModulo = 60 % $nVal; while ($nModulo!=0) { --$nVal; $nModulo = 60 % $nVal; } } if (Fdef56c7f($nOption,1)) $this->m_nGranulariteRDV_Redim = $nVal; if (Fdef56c7f($nOption,2)) $this->m_nGranulariteRDV_Deplacement = $nVal; $this->F6fb6d0cf( GRANULARITERENDEZVOUS ); } function F302508e9() { if ($this->Ff44acd3b()) { return false; } return true; } function Fd5c0247a() { if ($this->Ff44acd3b()) return true; if ($this->F0c6ce572()) return true; if ($this->m_clHeureDebutAff->m_dwHeure != 0) return false; if ($this->m_clHeureFinAff->m_dwHeure < 86340000 ) return false; return true; } function Ff44acd3b() { return ($this->m_nGranulariteRDV_Deplacement >= 1440 ); } function F0c6ce572() { if ($this->m_nGranulariteRDV_Deplacement === 720) { return true; } return false; } function Fc0755c6a() { return eModeAffPl_RessourceEnColonne == $this->m_eModeAffichagePlanning; } function Fc440ec80() { $clDateMin = new CDateAgenda(); $clDateMax = new CDateAgenda(); $this->F7d08dde4( $clDateMin, $clDateMax ); $clDateMaintenant = new CDateAgenda(); $clDateMaintenant->Ff04c7c3b(); $clDateMaintenant->Facd8fefd( $clDateMin ); if (!$this->F7a84789a( $clDateMaintenant)) { $this->Feca5376f( $clDateMaintenant ); } $this->Fb1c46213( $clDateMaintenant, 1 ); $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); } function F857e9259() { $this->Fe19d5a0a(); $this->m_clDateDebutAff->Ff04c7c3b(); $this->Fd2210678(); $this->Fbd897cbd(); } function F895745ea() { return count($this->m_tabRessources,COUNT_NORMAL); } function F802c4b0b() { return $this->F895745ea(); } function F75cd9976($nRessource) { return ((0 <= $nRessource) && ($this->F895745ea() > $nRessource)); } function& Fcb6e6668($nRessource) { return $this->m_tabRessources[$nRessource]; } function F2b322ae7($sNom,$eTypeNom) { $nNbRessource = $this->F895745ea(); for($i=0; $i<$nNbRessource; ++$i) { if (F6b6a70c8($sNom, $this->Fc42dd8d7($i, $eTypeNom), $eTypeNom)) return $i; } return -1; } function Fc42dd8d7($nRessource, $eRessourceNom) { $pclRessource =& $this->Fcb6e6668($nRessource); return $pclRessource->F1e31ec87($eRessourceNom); } function Fdbe16bf0() { return parent::Fdbe16bf0(); } function F696236c4(&$pclDateHeure) { $clDateMax = new CDateAgenda(); $this->F7d08dde4( $pclDateHeure, $clDateMax ); } function Fc9d0a157( &$pclDatePrev ) { $clDateRes = new CDateAgenda(); $this->F696236c4( $clDateRes ); switch ( $this->m_eZoomNbJourPlanning ) { case eZoomPl_Journee: $clDateRes->Fee154cfe(-1); break; case eZoomPl_Semaine5: case eZoomPl_Semaine7: $clDateRes->Fee154cfe(-7); break; case eZoomPl_Mois: $clDateRes->F328928c5(-1); break; case eZoomPl_MaxRdv: $clDateRes->Fee154cfe( - $this->F2ea494e1() ); break; case eZoomPl_LibreEnJour: if ($this->m_nNbJourZoomLibre<=0) break; $clDateRes->Fee154cfe( - $this->m_nNbJourZoomLibre); break; default: break; } $pclDatePrev->F278c4330($clDateRes); } function Fa46249be(&$pclDatePrev ) { $clDateRes = new CDateAgenda(); $this->F696236c4( $clDateRes ); switch ( $this->m_eZoomNbJourPlanning ) { case eZoomPl_Journee: $clDateRes->Fee154cfe(1); break; case eZoomPl_Semaine5: case eZoomPl_Semaine7: $clDateRes->Fee154cfe(7); break; case eZoomPl_Mois: $clDateRes->F328928c5(1); break; case eZoomPl_MaxRdv: $clDateRes->Fee154cfe( $this->F2ea494e1() ); break; case eZoomPl_LibreEnJour: if ($this->m_nNbJourZoomLibre<=0) break; $clDateRes->Fee154cfe( $this->m_nNbJourZoomLibre); break; default: break; } $pclDatePrev->F278c4330( $clDateRes ); } function Fb1c46213(&$clDateHeure, $nFlag ) { $this->m_clDateHeure1erLigneVisible->F278c4330($clDateHeure); if (Fdef56c7f($nFlag, 2147483648)) $this->m_bDateHeure1erLigneVisibleParProgrammation = true; } function Fc49677c2(&$pclEvenement, $clDate, $pszRessourceSiAgenda ) { if ($pclEvenement === null) return; $pclEvenementBase=null; if (!$this->Fd5c0247a() && $pclEvenement->F29893c95( $pclEvenementBase )) { $this->Fc49677c2($pclEvenementBase, $clDate, $pszRessourceSiAgenda ); return; } $clDateMin = new CDateAgenda(); $clDateMax = new CDateAgenda(); $pclEvenement->F2bc4c738( $clDateMin, $clDateMax ); if ($clDate->F0ee5647e($clDateMin) && $pclEvenement->Fb8d1ae4b($pszRessourceSiAgenda)) return; $clDureeEve = 0; XVERIFY( F0744b8b4( $clDateMax , $clDateMin, $clDureeEve ) === WLO_OK ); $clDateMaxApres = new CDateAgenda(); $clDateMaxApres->F278c4330( $clDate ); $clDateMaxApres->F2bc25f7f($clDureeEve); $pclEvenement->F41dfd0d7( $clDate, $clDateMaxApres ); $nNumEve = $this->F5c14ecc7(); if (!$pclEvenement->Fb8d1ae4b($pszRessourceSiAgenda)) { $sValeurMemorisee = ''; $sValeurAffichee = ''; $bPossedeGARecuperer = false; $clGLien = null; $bGLien = false; XVERIFY( F159221ea($pszRessourceSiAgenda,$bGLien,$bPossedeGARecuperer,$clGLien,$sValeurAffichee) ); if ($bGLien) { $pclEvenement->SetRessource( $clGLien ); } else { $pclEvenement->SetRessource( $pszRessourceSiAgenda ); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); if (!$this->Fc9faed17(TRT_DeplacementRessourceRdvPlanning, 0, $nNumEve)) { return; } } else { $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } $this->Fc9faed17(TRT_DeplacementRdvAgenda, 0 | 1, $nNumEve); XVERIFY( $this->m_clGestFichierParcouru->F783c0b63( $nNumEve ) ); } function F07803e95($nFlag) { $this->Fb1c46213( $this->m_clDateDebutAff, $nFlag ); parent::F07803e95($nFlag); } function Feca5376f(&$rclDateHeure,$nFlag=2) { $this->m_clDateDebutAff->F278c4330($rclDateHeure); $this->Fd2210678(); $this->Fbd897cbd(); $this->Fb479e1ee($nFlag); } function Fb479e1ee($nFlag) { $clDateDebutAff =new CDateAgenda(); $this->F696236c4($clDateDebutAff); $this->Fb1c46213( $clDateDebutAff, $nFlag ); parent::Fb479e1ee($nFlag); } function Fcb923550() { if ($this->m_eZoomNbJourPlanning === eZoomPl_MaxRdv ) return false; return $this->m_bAvecBoutonChangePeriode; } function F8ed1e18f($nNbJour) { $this->m_nNbJourZoomLibre = $nNbJour; $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET, nOMM_CHANGEASCENCEUR); } function SetModeNbJourPlanning($e) { if ($this->m_eZoomNbJourPlanning === $e) return; $clDate1erVisibleSauve = new CDateAgenda($this->m_clDateHeure1erLigneVisible); $bMidiEtaitVisible = false; $piVue =& $this->m_pclVue; if ($piVue !== null) { $clDate1erAMidi = new CDateAgenda($this->m_clDateHeure1erLigneVisible); $clDate1erAMidi->Fadb98d95(); $clDate1erAMidi->bDecaleHeure(12); $bMidiEtaitVisible = $piVue->Fd83eab1c($clDate1erAMidi,0, 3); } $this->m_eZoomNbJourPlanning = $e; if ($e == eZoomPl_MaxRdv) $this->Fe19d5a0a(); $this->m_clDateDebutAff->F278c4330($clDate1erVisibleSauve); $this->m_clDateDebutAff->Fadb98d95(); $this->Fd2210678(); $this->Fbd897cbd(); $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET, nOMM_CHANGEASCENCEUR); if ($this->m_eZoomNbJourPlanning===eZoomPl_Journee) { if (!$bMidiEtaitVisible) { $clDate1erVisibleSauve->Fee154cfe(1); } } $bChangeHeure1erVisible = true; if (!$this->F7a84789a( $clDate1erVisibleSauve)) { if ($this->m_eZoomNbJourPlanning === eZoomPl_MaxRdv) { $bChangeHeure1erVisible = false; } $this->Feca5376f( $clDate1erVisibleSauve, 1073741824 | 2 ); } if ($bChangeHeure1erVisible) $this->Fb1c46213( $clDate1erVisibleSauve, 1 ); $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); $this->F0a0e8cf9(); $this->F0ccaaf2b(); } function Fef796f1d() { $clDateMinAboslue = new CDateAgenda(); $clDateMax = new CDateAgenda(); $this->F7d08dde4( $clDateMinAboslue, $clDateMax ); $this->Fb1c46213($clDateMinAboslue, 1); } function SetModeAffichagePlanning($eModeAffichagePlanningNew) { if ($eModeAffichagePlanningNew === $this->m_eModeAffichagePlanning) return; $this->m_eModeAffichagePlanning = $eModeAffichagePlanningNew; $this->Fef796f1d(); $this->F6fb6d0cf( VERTICAL ); } function F36829d4f( $rclTabEve, &$nMin, &$nMax) { $nNbElements = count($rclTabEve,COUNT_NORMAL); if ($nNbElements=== 0) return false; $nMin = $nMax = 0; $bTrouve = false; for ($i=0;$i<$nNbElements;++$i) { $pclEveI =& $rclTabEve[$i]; if ($pclEveI->m_clDateDebut->m_dwDate === 0) continue; if (false===$bTrouve) { $nMin = $i; $nMax = $i; $bTrouve=true; } if ( $pclEveI->m_clDateDebut->Ffe96069b($rclTabEve[$nMin]->m_clDateDebut) ) $nMin = $i; if ( $pclEveI->m_clDateFin->Fa68634db($rclTabEve[$nMax]->m_clDateFin) ) $nMax = $i; } return $bTrouve; } function Fd2210678() { switch ($this->m_eZoomNbJourPlanning) { case eZoomPl_Journee: break; case eZoomPl_Semaine5: case eZoomPl_Semaine7: { $nNumJourSem = $this->m_clDateDebutAff->F4c110548(); $nNum1erJourAffiche = $this->m_nNumJour1erCol; if (($nNumJourSem===0) && ($nNum1erJourAffiche!==0)) $nNumJourSem=7; $this->m_clDateDebutAff->Fee154cfe( 1- $nNumJourSem + ($nNum1erJourAffiche-1) ); } break; case eZoomPl_Mois: { $nNumJourDuMois = $this->m_clDateDebutAff->nGetJour(); $this->m_clDateDebutAff->Fee154cfe( -($nNumJourDuMois-1) ); $this->m_clDateDebutAff->Fadb98d95(); } break; case eZoomPl_MaxRdv: $this->m_clDateDebutAff->F278c4330($this->m_clDateHeurePremierRDV); $this->m_clDateDebutAff->Fadb98d95(); break; case eZoomPl_LibreEnJour: break; default: break; } $this->Fb479e1ee(4096); } function F7a84789a( $clDate ) { $clDateMin = new CDateAgenda(); $clDateMax = new CDateAgenda(); $this->F7d08dde4( $clDateMin, $clDateMax ); if ($clDate->Ffe96069b($clDateMin)) return false; if ($clDate->F2d31d251($clDateMax)) return false; return true; } function F2ea494e1() { $nNumJourMin = $this->m_clDateHeurePremierRDV->Fc734cbfe(); $nNumJourMax = $this->m_clDateHeureDernierRDV->Fc734cbfe(); $nNbJour = ($nNumJourMax-$nNumJourMin)+1; if ($nNbJour<0) return 1; return $nNbJour; } function Fab248067() { switch ($this->m_eZoomNbJourPlanning) { case eZoomPl_Journee: return 1; case eZoomPl_Semaine5: return 5; case eZoomPl_Semaine7: return 7; case eZoomPl_Mois: return $this->m_clMoisCourant->F15ca4863(); case eZoomPl_MaxRdv: if (count($this->m_clTabEvenement,COUNT_NORMAL)===0) return 1; return $this->F2ea494e1(); case eZoomPl_LibreEnJour: if ($this->m_nNbJourZoomLibre<=0) return 1; return $this->m_nNbJourZoomLibre; default: return 1; } } function F996f596b() { return $this->Fab248067(); } function F7d08dde4( &$rclDateMin, &$rclDateMax) { $rclDateMin->F278c4330($this->m_clDateDebutAff); $rclDateMin->Facd8fefd( $this->m_clHeureDebutAff ); if (!$this->F302508e9() || $this->F0c6ce572()) $rclDateMin->Fadb98d95(); $rclDateMax->F278c4330($rclDateMin); $rclDateMax->Facd8fefd( $this->m_clHeureFinAff ); $nDecalePourBon1erJour = 0; if (($this->m_eZoomNbJourPlanning === eZoomPl_Semaine5) || ($this->m_eZoomNbJourPlanning === eZoomPl_Semaine7)) { $nNumJourSem = $this->m_clDateDebutAff->F4c110548(); $nDecalePourBon1erJour = $this->m_nNumJour1erCol-$nNumJourSem; if ($nNumJourSem < $this->m_nNumJour1erCol) $nDecalePourBon1erJour -= 7; $rclDateMin->Fee154cfe( $nDecalePourBon1erJour) ; } $nNbJour = $this->F996f596b(); $rclDateMax->Fee154cfe( $nDecalePourBon1erJour + $nNbJour -1); if (!$this->F302508e9() || $this->F0c6ce572()) { if ($rclDateMax->F55439573()>0) { $rclDateMax->F35ed58e9(); } } } function Ff73c76ba($nRessource, $eRessourceNom) { $pclRessource =& $this->Fcb6e6668($nRessource); if ($pclRessource === null) return null; return $pclRessource->F1e31ec87($eRessourceNom); } function Fb450beda($pszTitre, $clDateDebut, $clDateFin, $clCouleur, $pszCategorie, $pszRessource, $dwFlags=0) { $this->Fd1f90000($pszRessource); return parent::Fb450beda($pszTitre, $clDateDebut, $clDateFin, $clCouleur, $pszCategorie, $pszRessource); } function F8b19dbb0() { if ($this->m_eZoomNbJourPlanning === eZoomPl_MaxRdv) { $bModif = $this->Fe19d5a0a(); if ($bModif) { $this->Fb1c46213( $this->m_clDateHeure1erLigneVisible, 1 ); $this->Fd2210678(); $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); } } parent::F8b19dbb0(); } function Fe616e2e1(&$pclRdvDino, $dwFlag) { $pszRessource = $pclRdvDino->m_sRessource; $this->Fd1f90000($pszRessource); return parent::Fe616e2e1($pclRdvDino, $dwFlag); } function Fd1f90000($pszRessource) { if ($pszRessource === null) return; if (-1 !== $this->Fec8ca0d4($pszRessource)) { return; } $this->Fc250a849($pszRessource, -1); } function Fc250a849($pszNomRessource, $nPosition) { if ((-1 == $nPosition) || ($this->F895745ea() < $nPosition)) { $nPosition = $this->F895745ea(); } $pclRessource = new CDinoRessource($pszNomRessource); $this->m_tabRessources[$nPosition] =& $pclRessource; $this->F3c3b666f(); return $nPosition; } function F10489c4e() { return (eModeAffPl_RessourceEnColonne === $this->m_eModeAffichagePlanning); } function F3175ad2d($nRessource) { unset($this->m_tabRessources[$nRessource]); if (array_key_exists($nRessource+1,$this->m_tabRessources)) { $this->m_tabRessources = array_values($this->m_tabRessources); } $this->F3c3b666f(); } function Fcf07ace1() { $i=0; while(isset($this->m_tabRessources[$i])) unset($this->m_tabRessources[$i++]); unset($this->m_tabRessources); $this->m_tabRessources = array(); $this->F3c3b666f(); } function F3c3b666f() { if ($this->m_eModeAffichagePlanning !== eModeAffPl_RessourceEnColonne && $this->m_bLargeurZoneRessourceAuto) { $this->F6fb6d0cf(RESSOURCE); } $this->F3c2a17e3(VUEMODIF_UPDATECOMPLET); } function Fec8ca0d4($pclRendezVous) { return $this->Fad1d8649(is_object($pclRendezVous) ? $pclRendezVous->m_sRessource : $pclRendezVous); } function Fad1d8649($pszRessource) { $nRessource = $this->F2b322ae7($pszRessource, 2); if (-1 !== $nRessource) return $nRessource; $nRessource = $this->F2b322ae7($pszRessource, 0); return $nRessource; } function F703e1262($nIndiceWL = null) { if (!isset($nIndiceWL)) { $nItemSelect = $this->F5c14ecc7(); if ($nItemSelect === -1) return; } else { $nItemSelect = $nIndiceWL-1; } if (!$this->Fd4c80e66($nItemSelect)) { return; } $this->F11450529($nItemSelect); } function Fa0a598d8() { $clDateDebutAvant = new CDateAgenda(); $this->F696236c4( $clDateDebutAvant ); $clDateDebutApres = new CDateAgenda(); $this->Fc9d0a157( $clDateDebutApres ); $this->Feca5376f( $clDateDebutApres, 1 ); $piVue =& $this->m_pclVue; if ($piVue !== null) { $piVue->Fb9c6a718( $clDateDebutAvant, $clDateDebutApres ); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function F4ba4e322() { $clDateDebutAvant = new CDateAgenda(); $this->F696236c4( $clDateDebutAvant ); $clDateDebutApres = new CDateAgenda(); $this->Fa46249be( $clDateDebutApres ); $this->Feca5376f( $clDateDebutApres, 1 ); $piVue =& $this->m_pclVue; if ($piVue !== null) { $piVue->Fb9c6a718( $clDateDebutAvant, $clDateDebutApres ); } $this->F3c2a17e3(VUEMODIF_UPDATECONTENU); } function F47da19e2($nOption) { switch ($nOption) { case nagDateDebut: { $clDateDebut = new CDateAgenda(); $clDateFin = new CDateAgenda(); $this->F7d08dde4( $clDateDebut, $clDateFin); $clDateDebut->Fadb98d95(); return $clDateDebut->F09992612(); } case eagDateFin: { $clDateFin = new CDateAgenda(); $this->F229e02d8( $clDateFin ); return $clDateFin->F09992612(); } case nagMoisEnCours: { return $this->m_clMoisCourant->F09992612(); } default: Fb9eb0792( 'ERR_BAD_CONSTANT', $nOption) ; return ''; } } function F7501c398($nIndiceWL) { $nIndice = $nIndiceWL-1; if (!$this->Fd4c80e66($nIndice)) { return; } $pclEvenement =& $this->Faa22a1bf($nIndice); $this->F55d8e854( $pclEvenement, $nIndice, nFROM_FONC ); } function F577dd737($nIndiceWL) { $nIndice = 0; if ($nIndiceWL === -1) { $nIndice = $this->F5c14ecc7(); if ($nIndice === nNUMELEMENT_INVALIDE) return; } else { $nIndice = $nIndiceWL - 1; } if (!$this->Fd4c80e66($nIndice)) { return; } $pclEvenement =& $this->Faa22a1bf($nIndice); $this->F357784ea( $pclEvenement, $nIndice, nFROM_FONC ); } function Ffa9ba7ec($pszHeureMin, $pszHeureMax) { if (!Fd3b5396b($pszHeureMin)) { Fb9eb0792( 'ERR_BAD_FORMATHEUREAGENDA', $pszHeureMin); return; } if (!Fd3b5396b($pszHeureMax)) { Fb9eb0792( 'ERR_BAD_FORMATHEUREAGENDA', $pszHeureMax); return; } XVERIFY($this->bSetPlageHoraireVisible($pszHeureMin, $pszHeureMax)); } function F725996f1( &$pclEvenement ) { $this->m_n1erRessourceVisibleParProgrammation = $this->Fec8ca0d4($pclEvenement); } function Fc5715ace() { return -1 != $this->m_n1erRessourceVisibleParProgrammation; } function Fbdf53127() { $nTemp = $this->m_n1erRessourceVisibleParProgrammation; $this->m_n1erRessourceVisibleParProgrammation = -1; return $nTemp; } function F249afae0(&$pclEvt, $dwFlags) { $pszNomRessource = $pclEvt->m_sRessource; if($pszNomRessource!==null) { $bRessourceExisteDeja = ($this->Fec8ca0d4($pszNomRessource) !== -1); if(!$bRessourceExisteDeja) { $nPosition = count($this->m_tabRessources,COUNT_NORMAL); $pclRessource = new CDinoRessource($pszNomRessource); $this->m_tabRessources[$nPosition] =& $pclRessource; $this->F3c3b666f(); } } return parent::F249afae0($pclEvt, $dwFlags); } function PlanningAjouteRendezVous_Syntaxe1($pszRessource, $pszTitre, $rclDateDebut) { $clDateFin = new CDateTime($rclDateDebut); $clDateFin->bDecaleHeure(1); return $this->PlanningAjouteRendezVous_Syntaxe1_Version2($pszRessource, $pszTitre, $rclDateDebut, $clDateFin); } function PlanningAjouteRendezVous_Syntaxe1_Version2($pszRessource, $pszTitre, $rclDateDebut, $rclDateFin, $pszCategorie='' ) { $clDateDebut = new CDateTime($rclDateDebut); if (!is_object($rclDateFin)) { $clDateFin = new CDateTime($rclDateFin); } else { $clDateFin =& $rclDateFin; } return $this->F2e660529($pszRessource, $pszTitre, $clDateDebut, $clDateFin, $pszCategorie); } function PlanningAjouteRendezVous_Syntaxe2(&$piRendezVousVM) { return $this->F4d0beb83(F3df01b28($piRendezVousVM)); } function PlanningListeRendezVous_Syntaxe1_Version1($pszRessource) { return $this->F17a206d4($pszRessource,false); } function PlanningListeRendezVous_Syntaxe1_Version2($pszRessource,$rclDateMin) { $clDateMax = new CDateTime(); $clDateMax->F5d5b7869(2050,1,1,1,0,0,0); return $this->PlanningListeRendezVous_Syntaxe1_Version3($pszRessource, $rclDateMin, $clDateMax); } function PlanningListeRendezVous_Syntaxe1_Version3($pszRessource,$rclDateMin,$rclDateMax) { return $this->F3eaa0a03($pszRessource, $rclDateMin, $rclDateMax,false); } function PlanningListeRendezVous_Syntaxe2($nFlag) { return $this->F1f247568($nFlag,false); } function PlanningListeRendezVous_Syntaxe3() { return $this->F17a206d4(null,false); } function PlanningSupprimeRendezVous_Syntaxe1() { $this->F703e1262(); } function PlanningSupprimeRendezVous_Syntaxe2($nIndiceWL) { $this->F703e1262($nIndiceWL); } function PlanningSupprimeTout() { $this->F6325d676(); $this->Fcf07ace1(); } function PlanningHeureAffichee($pszHeureMin, $pszHeureMax) { $this->Ffa9ba7ec($pszHeureMin, $pszHeureMax); } function PlanningPosition($pszDate) { $clDateDebut = new CDateAgenda(); if (!$clDateDebut->F5c6d1692( $pszDate )) { Fb9eb0792( 'ERR_BAD_FORMATDATEAGENDA', $pszDate ); return; } $this->Feca5376f( $clDateDebut, 1 ); $this->Fb1c46213( $clDateDebut, 1 ); } function PlanningPosition_Syntaxe2($nOption=0) { return $this->F47da19e2($nOption); } function PlanningSelectPlus($nIndiceWL) { $this->F7501c398($nIndiceWL); } function PlanningSelectMoins($nIndiceWL=-1) { $this->F577dd737($nIndiceWL); } function PlanningAjouteRessource($pszRessource, $pszImageFondTitre='') { if (-1 !== $this->F2b322ae7($pszRessource, 0)) { Fb9eb0792('ERR_PLANNING_RESSOURCE_EXISTE', $pszRessource, $this->Fd464306b()); return -1; } $nIndiceRessource = $this->Fc250a849($pszRessource, -1); if ($nIndiceRessource === -1) { return -1; } { $pclRessourceI =& $this->Fcb6e6668( $nIndiceRessource ); $pclRessourceI->m_czNomImageFondTitre = (string)$pszImageFondTitre; } return $nIndiceRessource + 1; } function PlanningSupprimeRessource($pszRessource) { $nRessourcePosition = $this->F2b322ae7($pszRessource, 2); if (-1 === $nRessourcePosition) { Fb9eb0792('ERR_PLANNING_RESSOURCE_INEXISTANTE', $pszRessource, $this->Fd464306b()); return false; } $this->F3175ad2d($nRessourcePosition); return true; } function PlanningAffiche($pszOption) { $nOption = F166fddb3(1 , 8); if ($pszOption === '-HER') { F27efdc07($nOption , 8); } $this->F6325d676(); XVERIFY( $this->SetFirstIndex(0, $nOption) ); } function PlanningChangeMode($nMode, $nNbJour=-1 ) { $nNbJour = intval($nNbJour); $eModeZoom = eZoomPl_Journee; switch ($nMode) { case 100 : $eModeZoom = eZoomPl_Journee; break; case 101 : if ($nNbJour === 5) { $eModeZoom = eZoomPl_Semaine5; } else if (($nNbJour === 7) || ($nNbJour===-1)) { $eModeZoom = eZoomPl_Semaine7; } else { Fb9eb0792( 'ERR_BAD_CONSTANT', $nNbJour); return; } break; case 102: $eModeZoom = eZoomPl_Mois; break; case 103: $eModeZoom = eZoomPl_MaxRdv; break; case 104 : $eModeZoom = eZoomPl_LibreEnJour; break; default: Fb9eb0792( 'ERR_BAD_CONSTANT', $nMode); return; } if ((($nNbJour !==-1) && (($eModeZoom !== eZoomPl_LibreEnJour) && ($nMode !== 101) )) ) { Fb9eb0792( 'ERR_BAD_CONSTANT', $nNbJour); return; } $this->SetModeNbJourPlanning( $eModeZoom ); if (($nNbJour!==-1) && ($eModeZoom === eZoomPl_LibreEnJour)) $this->F8ed1e18f($nNbJour); } function PlanningAffichePeriodePrecedente() { $this->Fa0a598d8(); } function PlanningAffichePeriodeSuivante() { $this->F4ba4e322(); } } ?>