<?php
//20.0.56.0 WL/PAGE/Page.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__FMK/PostGet.php')) { define('__INC__FMK/PostGet.php',true); include_once(WB_INCLUDE_PATH.'WDfe3218b8c0e7e274335f3617fe996545.php'); } if (!defined('__INC__FMK/Dessin/Couleur.php')) { define('__INC__FMK/Dessin/Couleur.php',true); include_once(WB_INCLUDE_PATH.'WD2521e084cbaf10ef8d5f4ede4dc6baa2.php'); } if (!defined('__INC__FMK/Disque.php')) { define('__INC__FMK/Disque.php',true); include_once(WB_INCLUDE_PATH.'WD99bd5984d9c78e9239c729a52b83e562.php'); } if (!defined('__INC__FMK/Date.php')) { define('__INC__FMK/Date.php',true); include_once(WB_INCLUDE_PATH.'WD97af71f4453b9d548e8ff90b4bbaba9f.php'); } if (!defined('__INC__FMK/Chaine.php')) { define('__INC__FMK/Chaine.php',true); include_once(WB_INCLUDE_PATH.'WD55acb2e708e26f23cb8956cd93e98123.php'); } if (!defined('__INC__FMK/Dependance.php')) { define('__INC__FMK/Dependance.php',true); include_once(WB_INCLUDE_PATH.'WDb98029e1a3f05e7ed504ba0a18a9dea8.php'); } if (!defined('__INC__FMK/Environnement.php')) { define('__INC__FMK/Environnement.php',true); include_once(WB_INCLUDE_PATH.'WD62c1fcbeb97cd284448bd7a6ec627839.php'); } if (!defined('__INC__FMK/Disque/Fichier.php')) { define('__INC__FMK/Disque/Fichier.php',true); include_once(WB_INCLUDE_PATH.'WD5e394596c6434eec95aa14dd761a6e59.php'); } $TabVariableGlobalePAGE = array(); function PAGE_SauveVariableGlobaleInterne(&$pclPage) { global $TabVariableGlobalePAGE; $pclPage->TabVarGlobaleInterneComposante['PAGE'] = $TabVariableGlobalePAGE; } function PAGE_RestaureVariableGlobaleInterne(&$pclPage) { global $TabVariableGlobalePAGE; if (!isset($pclPage->TabVarGlobaleInterneComposante['PAGE'])) return; $TabVariableGlobalePAGE = $pclPage->TabVarGlobaleInterneComposante['PAGE']; } function F65c1519c( $Date , $Format ) { FMK_Charge('WL/STD/Std.php',false); return ChaineVersDate($Date , $Format); } function Ff1212ddc( $nNumMois,$bCourt = false) { $i = $nNumMois - 1; $szNomMois = Fc34ec142("MOIS$i"); if ($bCourt) $szNomMois = utf8_substr($szNomMois,0, nLENABBREGE); return $szNomMois ; } function Fb25ca315( $nNumJour, $bCourt = false ) { $i = $nNumJour - 1; $tabJoursSemaine = F7d16a969(); $szNomJour = $tabJoursSemaine[$i]; if ($bCourt) $szNomJour = utf8_substr($szNomJour,0, nLENABBREGE); return $szNomJour; } function Ff7b89aba( $szDate ) { $nNumJour = Ffec7ff1b( $szDate ) + 1; return $nNumJour%7 + 1; } function F8212ac28( $szDate , $szFormat ) { FMK_Charge('WL/STD/Std.php',false); return DateVersChaine( $szDate , $szFormat ); } function F7819245b( $Heure, $Format) { if($Heure=='') return ''; $res = $Format; $j =utf8_strpos( $Format, 'HH'); if(is_integer($j)) $res = utf8_substr($res,0, $j) . utf8_substr($Heure,0,2) . utf8_substr($res, $j+2 ); $j =utf8_strpos( $Format, 'mm'); if(!is_integer($j)) $j = utf8_strpos( $Format, 'MM'); if(is_integer($j)) $res = utf8_substr($res,0, $j) . utf8_substr($Heure,2,2) . utf8_substr($res, $j+2 ); $j =utf8_strpos( $Format, 'SS'); if(is_integer($j)) $res = utf8_substr($res,0, $j) . utf8_substr($Heure,4,2) . utf8_substr($res, $j+2 ); $j =utf8_strpos( $Format, 'CC'); if(is_integer($j)) { $res = utf8_substr($res,0, $j) . utf8_substr($Heure,6,2) . utf8_substr($res, $j+2 ); if ( (utf8_strpos( $Format, 'CCC') === $j) && isset($res[$j+2]) && ($res[$j+2]==='C') ) { $res[$j+2] = (isset($Heure[8])) ? $Heure[8] : '0'; } } return $res; } function F0feb2aff( $Heure, $Format) { if($Heure=='') return ''; $p =utf8_strpos( $Format, 'HH'); if(!is_integer($p)) return ''; $HH =utf8_substr( $Heure, $p, 2); $p = utf8_strpos( $Format, 'mm'); if(!is_integer($p)) $p = utf8_strpos( $Format, 'MM'); if(!is_integer($p)) return ''; $MM =utf8_substr( $Heure, $p, 2); $p =utf8_strpos( $Format, 'SS'); $SS = '00'; if(is_integer($p)) $SS =utf8_substr( $Heure, $p, 2); $p =utf8_strpos( $Format, 'CC'); $CC = '00'; if(is_integer($p)) $CC =utf8_substr( $Heure, $p, 2); return $HH.$MM.$SS.$CC; } function F3f15405d( $StrNombre, $Format, $sForceSeparateurDecimal=null ) { global $_gszSEPDEC, $_gszSEPMIL; if (!isset($sForceSeparateurDecimal)) $sForceSeparateurDecimal = $_gszSEPDEC; $Buf = utf8_str_replace($sForceSeparateurDecimal, '.', $StrNombre ); $Buf = utf8_str_replace($_gszSEPMIL, '', $Buf ); $Buf = (double)$Buf; if ( utf8_strpos($Format, ',')===false) $Buf = (int)$Buf; if ( (utf8_strpos($Format,'%')!==false)&&(utf8_strpos($Format,'%%')===false)&&(utf8_strpos($StrNombre,'%')===false) ) { if ( ($Buf>-1)&&($Buf<1) ) { $Buf*=100; } } return $Buf; } function ImageZone() { return F4e7f6fae('ZONE'); } function ImagePosX() { $sValeurISMAP = F4e7f6fae("ISMAP"); if (empty($sValeurISMAP)) return 0; $nPosSeparateur = utf8_strpos($sValeurISMAP,'?'); return intval(utf8_substr($sValeurISMAP,$nPosSeparateur+1,utf8_strpos($sValeurISMAP,',')-$nPosSeparateur)); } function ImagePosY() { $sValeurISMAP = F4e7f6fae("ISMAP"); if (empty($sValeurISMAP)) return 0; $nPosSeparateur = utf8_strpos($sValeurISMAP,','); return intval(utf8_substr($sValeurISMAP,$nPosSeparateur+1)); } function ChaineAffiche( $Chaine, $TypeMime="", $NomNavigateur="" ) { if(Feef890d7()) { Erreur('ErreurWL_1_Param',"ErreurFonctionInterditeAjax", Fc34ec142("FCT_CHAINE_AFFICHE")); } if ($TypeMime != "") { header("Content-type: ".$TypeMime ); } if (utf8_strlen($NomNavigateur) > 0) { header('Content-Disposition: attachment; filename='.$NomNavigateur); } echo $Chaine; F962be4d3(); } function FichierAffiche( $NomFichier, $TypeMime="", $NomNavigateur="" ) { if(Feef890d7()) { Erreur('ErreurWL_1_Param',"ErreurFonctionInterditeAjax", Fc34ec142("FCT_FICHIER_AFFICHE")); } if ($TypeMime != "") { header("Content-type: ".$TypeMime ); } $bInline = false; if ($NomNavigateur == "") { $NomNavigateur = basename ($NomFichier); if ($TypeMime != "") { $bInline = true; } } header('Content-Disposition: ' . (($bInline) ? 'inline' : 'attachment') . '; filename=' . $NomNavigateur); readfile(F9486bf1a($NomFichier)); F962be4d3(); } function ScriptAffiche( $Url, $MoreHeader = "" , $bRedirectionPermanente = false ) { F6e3689dc($Url, $MoreHeader, $bRedirectionPermanente); } function ScriptExecute($sUrl, $sQueryString = '', $bParPost = false) { FMK_Charge('WL/COM/Com.php',false); if ($bParPost) { HTTPRequete($sUrl,'','',$sQueryString,'','','',2); } else { $sURLComplete = ($sQueryString !== '') ? $sUrl . '?' . $sQueryString : $sUrl; HTTPRequete($sURLComplete); } return HTTPDonneResultat(); } function WL_URLDecode($sChaine) { return Fcab655af($sChaine,true); } function WL_URLEncode($sChaine) { return F828b8ca2($sChaine); } function F912371e6() { global $MonProjet; if (isset( $MonProjet)) $MonProjet->F4d351a8f(); if (isset( $MonProjet)) { $clContexte =& F4a1887ce(); $clContexte->F4c8f9bd4(VM_MONPROJET,$MonProjet); } } function PageAdresse( $NomPage="", $nOptions=0 ) { global $gszURL; if ($NomPage == '') { $NomFichier = $gszURL; } else { $NomFichier = $NomPage.'.php'; } return F13caba43($NomFichier,$nOptions); } function SiteAdresse($sNom=null) { if (!isset($sNom)) { global $MonProjet; if (is_object($MonProjet)) $sNom = $MonProjet->m_szNomProjet; } return 'http' . (((isset($_SERVER['HTTPS'])) && ( ($_SERVER['HTTPS']=='1') || (strtolower($_SERVER['HTTPS'])=='on') )) ? 's' : '') .'://' . Faee3f2e8('HTTP_HOST') . '/' . XVER_PREFIX .'AWP/' . XVER_PREFIX .'AWP.EXE/CONNECT/' . $sNom; } function PageAffiche( $VariablePage ) { if(Feef890d7()) { Erreur('ErreurWL_1_Param',"ErreurFonctionInterditeAjax", Fc34ec142("FCT_PAGE_AFFICHE")); } $NomPage = $VariablePage; global $MonProjet; global $MaPage; global $gtabCheminPage; global $gszCheminPageInverse; if (isset($MonProjet)) { if ((utf8_strlen($MonProjet->F539b5aa8()) > 0) && (utf8_strcasecmp($NomPage, $MonProjet->F539b5aa8()) == 0)) { if (utf8_strlen($MonProjet->F03298240()) > 0) { $NomPage = $MonProjet->F03298240(); } } } $arg=func_get_args(); $AllParams=''; $nBorneMax =count($arg); for ($i=1;$i<$nBorneMax;$i++) { if ($AllParams != '') $AllParams .= '&'; $AllParams .= 'P'.$i.'='.F828b8ca2(Fee7ba3f9($arg[$i]), true); } global $MaPage; Fe038c555( utf8_strtoupper($NomPage) ); if (utf8_strcasecmp($MaPage->Nom,$NomPage) === 0) $GLOBALS['bSauveContexte'] = false; $UrlPage = ''; if (isset($gtabCheminPage[utf8_strtoupper($NomPage)])) { $pclLangue =& FMK_Langue_Alphabet(); $nNation = $pclLangue->nNation; $UrlPage .= $gtabCheminPage[utf8_strtoupper($NomPage)][$nNation]['URL']; $NomPage = $gtabCheminPage[utf8_strtoupper($NomPage)][$nNation]['NOM']; } $sBaseChemin=F0ac3fb91(F8df7b692(realpath(WB_BASE_DIR . '/../..'))); Ff49de04d('EXTENSION'); $sExtensionStatique = EnvGet('EXTENSION_STATIQUE'); if ($sExtensionStatique===null) $sExtensionStatique='.htm'; switch(true) { case file_exists(F9486bf1a($sCheminComplet = ($sBaseChemin . ($UrlPageExistante = $UrlPage . F5b2f2e5c('.php',$NomPage,null))))): case file_exists(F9486bf1a($sCheminComplet = ($sBaseChemin . ($UrlPageExistante = $UrlPage . F5b2f2e5c( $sExtensionStatique,$NomPage,null))))): case file_exists(F9486bf1a($sCheminComplet = ($sBaseChemin . ($UrlPageExistante = $UrlPage . F5b2f2e5c('.awp',$NomPage,null))))): $UrlPage = $UrlPageExistante; $sCheminCompletReel = realpath($sCheminComplet); if (F61bc61eb($sCheminCompletReel,$sBaseChemin)) { $UrlPage = utf8_substr($sCheminCompletReel,utf8_strlen($sBaseChemin)); } break; default: } if (isset($gszCheminPageInverse)) { $UrlPage = $gszCheminPageInverse . $UrlPage; } F6e3689dc( $UrlPage, $AllParams ); } function F09f0476c( $szMessage ) { Erreur('ErreurGenerique',Fc34ec142("ERR_WLL"),Fc34ec142("ERR_FATAL"),$szMessage); } function PageActualise( $NomPage='' ) { if(Feef890d7()) { Erreur('ErreurWL_1_Param',"ErreurFonctionInterditeAjax", Fc34ec142("FCT_PAGE_ACTUALISE")); } if ($NomPage == '') { global $MaPage; $NomPage = $MaPage->Nom; } global $gtabCheminPage; global $gszCheminPageInverse; $UrlPage = ''; if (isset($gszCheminPageInverse)) { $UrlPage .= $gszCheminPageInverse; } if (isset($gtabCheminPage[utf8_strtoupper($NomPage)])) { $pclLangue =& FMK_Langue_Alphabet(); $nNation = $pclLangue->nNation; $UrlPage .= $gtabCheminPage[utf8_strtoupper($NomPage)][$nNation]['URL']; $NomPage = $gtabCheminPage[utf8_strtoupper($NomPage)][$nNation]['NOM']; } $UrlPage .= $NomPage.'.php'; F6e3689dc($UrlPage, 'refresh'); } function Multitache( $Delais ) { if ($Delais < 0) $Delais = -$Delais; if ($Delais > 0) $Delais -= 1; sleep( ($Delais / 100) + 1 ); } function Info() { $tabArgv = func_get_args(); F6813d1cb(utf8_implode("\n",$tabArgv),'alert'); } function ToastAffiche($pszMessage,$nDuree=0,$nCadrageV=-1,$nCadrageH=-1,$dwCouleurFond=-1) { $pszParams = ',' . $nDuree; if ($nCadrageV>-1) $pszParams.= ','.$nCadrageV; if ($nCadrageH>-1) $pszParams.= ','.$nCadrageH; if ($dwCouleurFond>-1) $pszParams.= ',\'#'.F5bfcd185($dwCouleurFond).'\''; F6813d1cb($pszMessage,'WDToastBase.prototype.s_ToastAffiche',$pszParams); } function ToastAffichePopup($pszNomPopup,$nDuree=0,$nCadrageV=-1,$nCadrageH=-1) { $pszParams = ',' . $nDuree; if ($nCadrageV>-1) $pszParams.= ','.$nCadrageV; if ($nCadrageH>-1) $pszParams.= ','.$nCadrageH; $pclVM =& obtenirVM(); $pszNomPopupCorrige = $pclVM->F67af5b5c($pszNomPopup); if (!empty($pszNomPopupCorrige)) { $pclChamp =& F9abbf335($pszNomPopupCorrige,IND_CHAMP); if ($pclChamp===null || $pclChamp->GetType()!==ID_POPUP_DEST) { $pszNomPopupCorrige=$pszNomPopup; } else { $pszNomPopupCorrige = $pclChamp->Alias; } } F6813d1cb($pszNomPopupCorrige,'WDToastBase.prototype.s_ToastAffichePopup',$pszParams); } function F191e839a(&$nTaux) { global $_gszGFI_ACTIVE, $_gszGFI_TAUX; $nTaux = $_gszGFI_TAUX; return $_gszGFI_ACTIVE; } function PopupAffiche($pszNomPopup,$nPosition=5,$X=0,$Y=0) { $nPositionSansFixed = Ffecd99cc($nPosition, 1073741824); $bFixed = Fdef56c7f($nPosition, 1073741824); $pclVM =& obtenirVM(); $pszMessage = $pclVM->F67af5b5c($pszNomPopup); if (empty($pszMessage)) { $pszMessage=$pszNomPopup; } else { $pclChamp =& F9abbf335($pszMessage,IND_CHAMP); if ($pclChamp===null || $pclChamp->GetType()!==ID_POPUP_DEST) { $pszMessage=$pszNomPopup; } else { $pszMessage=$pclChamp->Alias; } } $nOpaciteGFI = 60; $bGFI = F191e839a($nOpaciteGFI); if (0 === $nPositionSansFixed) { $pszX = $Y; $pszY = $Y; } else { $pszX = 'undefined'; $pszY = 'undefined'; } $cszParametresSupplementaires = ", document, " . $nPositionSansFixed . ", " . ($bGFI ? '1' : "undefined") . ", " . $nOpaciteGFI . ", " . $pszX . ", " . $pszY . ", " . ($bFixed ? '1' : "undefined") ; F6813d1cb($pszMessage, 'clWDUtil.CelluleAfficheDialogue', $cszParametresSupplementaires); } function F6813d1cb($pszMessage , $pszCommande , $pszParametreSupplementaires='' , $bPourErreur=false) { $sCeMessage = $pszCommande . "('" .utf8_addcslashes ( utf8_str_replace(array("\\", "\"", "'", "&", "<", ">", "\r\n", "\r"), array("\\\\", "\\42", "\\47", "&amp;", "&lt;", "&gt;", "\n", "\n"), Page_ANY2STR($pszMessage)) , "\0..\37" ) ."'".$pszParametreSupplementaires.');'; if(Feef890d7()) { F2930536a($sCeMessage); } else { $clContexte =& F4a1887ce(); $clContexte->F4c8f9bd4('InfoMessage', ((string)$clContexte->F239ddeda('InfoMessage')) . $sCeMessage ); } } function RAZ($pclGroupe = null) { if (!isset($pclGroupe)) { global $MaPage; $MaPage->F4c1a2ac2(); } else { $pclChampGroupe =& F9abbf335($pclGroupe,IND_CHAMP); if (!isset($pclChampGroupe) || $pclChampGroupe->GetType()!==58) return; $pclChampGroupe->F4c1a2ac2(); } } function PageInitialisation($bRaz=true) { if(Feef890d7()) { Erreur('ErreurWL_1_Param',"ErreurFonctionInterditeAjax", Fc34ec142("FCT_PAGE_INITIALISATION")); } global $MaPage; $MaPage->Fd12415ea($bRaz); } function ZoneRepeteeCherche( $szNomAttributWL, $szValeurRech, $bType = true, $nPosDebut = 1 ) { global $MaPage; $szNomZone = &$MaPage->Ffc024b6b( $szNomAttributWL ); if ( !isset($szNomZone) ) { Erreur('ErreurGenerique',Fc34ec142("ERR_WLL"),Fc34ec142("ERR_FATAL"), FMK_ChaineConstruit(Fc34ec142("ERR_ZRCHERCHE_BADATTRIB"), $szNomAttributWL) ); return -1; } return $GLOBALS[$szNomZone]->ZoneRepeteeCherche( $szNomAttributWL, $szValeurRech, $bType, $nPosDebut ); } function ZoneRepeteeIndiceRupture(&$piRupture, $nIndiceWL=-1) { $nNbRupture = count($piRupture->m_clObjet->TabRupture,COUNT_NORMAL); for ($i=0; $i<$nNbRupture; ++$i) { if ( ($piRupture->m_clObjet->TabRupture[$i][ZR_RUPTURE_HAUT]->m_sNomWL == $piRupture->m_Indice2->m_Valeur) ) { $pclObjRupture =& $piRupture->m_clObjet->TabRupture[$i][ZR_RUPTURE_HAUT]; break; } if ( ($piRupture->m_clObjet->TabRupture[$i][ZR_RUPTURE_BAS]->m_sNomWL == $piRupture->m_Indice2->m_Valeur) ) { $pclObjRupture =& $piRupture->m_clObjet->TabRupture[$i][ZR_RUPTURE_BAS]; break; } } if (($pclObjRupture == null) || ($pclObjRupture->GetType() != ID_PARTIERUPTUREZR)) { Fe81a7f9e('ERR_NOTARUPTURE',$piRupture->GetNom(), ($pclObjRupture != null) ? F3b9ec4ca($pclObjRupture->F1e21db15()) : ''); return 0; } $pclRupture =& $pclObjRupture; $pclChampParent =& $pclRupture->Fd1c22179(); if ($pclChampParent == null) return 0; if ($nIndiceWL == -1) $nIndiceWL = $pclChampParent->Valeur; if ($nIndiceWL == -1) { return 0; } return ($pclChampParent->F98cfc964($pclRupture, $nIndiceWL-1) + 1); } function RepertoireWeb() { global $MonProjet; if (!isset($MonProjet)) return "."; $szRes = utf8_strtoupper($MonProjet->m_szNomProjet) . '_WEB'; return $szRes; } function PagePrecedente () { global $MonProjet; if (!isset($MonProjet)) return ''; return $MonProjet->F539b5aa8(); } function PageCourante () { global $MaPage; return $MaPage->Nom; } function F7e48dc0b() { global $MonProjet; return $MonProjet->m_szPageCouranteCasse; } function FinProgramme($sLibelle="") { session_destroy(); ob_end_flush(); $sTexte = $sLibelle; if (func_num_args() == 1) die($sTexte); $args = func_get_args(); $args = array_slice($args,1); $i=0; while ( (isset($args[$i])) ) { if (is_string($args[$i])) $sTexte .= RC .$args[$i]; elseif (is_bool($args[$i])) { $args[$i] = true; } ++$i; } die($sTexte); } function FichierVersEcran($sNomPage='', $Fichier='') { global $sLastFunction; $sLastFunction = Fc34ec142("FCT_FICHIER_VERS_PAGE"); $sNomFichier = ""; if(!empty($Fichier)) { $Fichier = &F9c2a1edc($Fichier); if(isset($Fichier)) { $sNomFichier = $Fichier->sNomLogique; } } global $MaPage; if(!empty($sNomPage)) { if(utf8_strcasecmp($MaPage->Nom, $sNomPage) != 0) { Erreur('ErreurHF',"PageEnCours"); return; } } $TabChamp= array_keys($MaPage->TabChampLiaison); foreach($TabChamp as $Nom) { $Champ = &$MaPage->TabChampLiaison[$Nom]; if(empty($sNomFichier) || utf8_strcasecmp($sNomFichier, $Champ->sFichierBase) == 0) { $Champ->F409dc8d1(); } } } function EcranVersFichier($sNomPage='', $Fichier='') { global $sLastFunction; $sLastFunction = Fc34ec142("FCT_PAGE_VERS_FICHIER"); $sNomFichier = ""; if(!empty($Fichier)) { $Fichier = &F9c2a1edc($Fichier); if(isset($Fichier)) { $sNomFichier = $Fichier->sNomLogique; } } global $MaPage; if(!empty($sNomPage)) { if(utf8_strcasecmp($MaPage->Nom, $sNomPage) != 0) { Erreur('ErreurHF',"PageEnCours"); return; } } $TabChamp= array_keys($MaPage->TabChampLiaison); foreach($TabChamp as $Nom) { $Champ = &$MaPage->TabChampLiaison[$Nom]; if(empty($sNomFichier) || utf8_strcasecmp($sNomFichier, $Champ->sFichierBase) == 0) { $Champ->F82c9860c(); } } } function NavigateurAdresseIP() { return F78b7df27(); } function NavigateurNom() { return $_SERVER['HTTP_USER_AGENT']; } function NavigateurPlateforme() { $pstNavigateurInfo =& Fa136cbc9(); return $pstNavigateurInfo->m_ePlateforme; } function NavigateurType() { $pstNavigateurInfo =& Fa136cbc9(); return $pstNavigateurInfo->m_eType; } function NavigateurVersion($nVersion = 0) { $pstNavigateurInfo =& Fa136cbc9(); switch ($nVersion) { default: case 0: return $pstNavigateurInfo->m_nVersionMajeure; case 1: return $pstNavigateurInfo->m_pszVersionComplete; } } function TailleVersChaine($nTaille, $nFormat = null) { $sChaine = ""; if (!is_numeric($nTaille)) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_VALEUR_PARAM"),$nTaille)); return $sChaine; } if ( isset($nFormat) && ($nFormat<tailleO) && ($nFormat>tailleTO) ) { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_VALEUR_PARAM"),$nFormat)); return $sChaine; } $nTaille = F075ca95b($nTaille); $bSigne = ($nTaille>=0); $nTaille = abs($nTaille); if($nTaille<0) { $nFormat = tailleO; } else { if (!isset($nFormat)) { $nTailleCalcul = $nTaille; $nFormat = 1; while( (round(($nTailleCalcul/=1024),2)>=1) && ($nFormat<tailleTo) ) { ++$nFormat; } } } $nTaille/= pow(1024,$nFormat-1); $nTaille = round($nTaille,2); if (tailleO !== $nFormat) $sChaine = FormateNum($nTaille,MASQUE_TAILLE); else $sChaine = (string)$nTaille; if (is_float($nTaille)) $nTaille = utf8_str_replace(',','.',$sChaine); $tabInfoPrjUniteTailleFichier = EnvGet('UNITESTAILLESFICHIER'); if (isset($tabInfoPrjUniteTailleFichier) && array_key_exists($nFormat-1,$tabInfoPrjUniteTailleFichier)) { $sChaine.= ' '. $tabInfoPrjUniteTailleFichier[$nFormat-1]; } else { switch ($nFormat) { case tailleO: $sChaine .= ' '.Fc34ec142('UNITE_OCTET'); break; case tailleKo: $sChaine .= ' '.Fc34ec142('UNITE_KILO_OCTET'); break; case tailleMo: $sChaine .= ' '.Fc34ec142('UNITE_MEGA_OCTET'); break; case tailleGo: $sChaine .= ' '.Fc34ec142('UNITE_GIGA_OCTET'); break; case tailleTo: $sChaine .= ' '.Fc34ec142('UNITE_TERA_OCTET'); break; default: } } return ($bSigne ? '' : '-') . $sChaine; } function dFinDessin() { F67cfd262(); $tabGloablsKeys = array_keys($GLOBALS); foreach ($tabGloablsKeys as $i) { if ( (isset($GLOBALS[$i])) && (is_object($GLOBALS[$i])) && (is_callable(array($GLOBALS[$i],'GetType'))) && ($GLOBALS[$i]->GetType() == ID_IMAGE) ) { if (!$GLOBALS[$i]->dFinDessin()) Fdd279d21(FMK_ChaineConstruit(Fc34ec142("ERR_DESSIN"),Fc34ec142("FCT_DFINDESSIN"))); if (Feef890d7()) F4c16799e($GLOBALS[$i]->m_sNomPHP,XML_CHAMP_PROP_NUM_VALEUR); } } } function TableIndiceColonne(&$Table, $sNomColonne) { if (!F1c7c7cae($Table)) { $pclVM =& obtenirVM(); $sNomTable = VersChaine($Table); $pclChampTable = $pclVM->F67af5b5c($sNomTable); if (!isset($pclChampTable)) { Fe81a7f9e('ERR_CHAMP_INCONNU','FCT_TABLEINDICECOLONNE',$sNomTable); } if (!F1c7c7cae($Table)) { Fe81a7f9e('ERR_TABLE_INCONNUE','FCT_TABLEINDICECOLONNE',$sNomTable); } } else { $pclChampTable =& $Table; } $sNomColonneMinSansAccent = Fcb2d4de8(utf8_strtolower($sNomColonne),ccSansAccent); foreach ($pclChampTable->TabColonnes as $nIndiceColonne => $clColonne) { if (strcmp(Fcb2d4de8(utf8_strtolower($clColonne->Nom),ccSansAccent),$sNomColonneMinSansAccent)===0) { return $nIndiceColonne; } } Fe81a7f9e('ERR_COLONNE_INCONNUE','FCT_TABLEINDICECOLONNE',$sNomTable,$sNomColonne); return 0; } function TablePosition(&$Table,$nIndice=null) { if (!F1c7c7cae($Table)) { $pclVM =& obtenirVM(); $sNomTable = VersChaine($Table); $pclChampTable = $pclVM->F67af5b5c($sNomTable); if (!isset($pclChampTable)) { Fe81a7f9e('ERR_CHAMP_INCONNU','FCT_TABLEPOSITION',1,$sNomTable); } if (!F1c7c7cae($Table)) { Fe81a7f9e('ERR_TABLE_INCONNUE','FCT_TABLEPOSITION',1,$sNomTable); } } else { $pclChampTable =& $Table; } return F184ff088($pclChampTable,$nIndice); } function ZoneRepeteePosition(&$Table,$nIndice=null) { if (!Fba68c6f1($Table)) { $pclVM =& obtenirVM(); $sNomTable = VersChaine($Table); $pclChampTable =& $pclVM->F67af5b5c($sNomTable); if (!isset($pclChampTable)) { Fe81a7f9e('ERR_CHAMP_INCONNU','FCT_ZONEREPETEEPOSITION',1,$sNomTable); } if (!Fba68c6f1($Table)) { Fe81a7f9e('ERR_ZR_INCONNUE','FCT_ZONEREPETEEPOSITION',1,$sNomTable); } } else { $pclChampTable =& $Table; } return F184ff088($pclChampTable,$nIndice); } function F184ff088(&$pclChampTable,$nIndice=null) { if (!isset($nIndice)) { if ($pclChampTable->m_bEstAjax && (!isset($pclChampTable->Reglette))) { if (isset($pclChampTable->m_nIndiceAffichage)) { return $pclChampTable->m_nIndiceAffichage; } return $pclChampTable->GetValeur(); } else { if ($pclChampTable->nFirstIndex == 0) return $pclChampTable->GetValeur(); return $pclChampTable->nFirstIndex; } } else { $nOccurrence = $pclChampTable->GetOccurrence(); if ($nOccurrence === 0) return null; if ($nIndice<1) $nIndice = 1; elseif ($nIndice>$nOccurrence) $nIndice = $nOccurrence; if (isset($pclChampTable->Reglette)) { $pclChampTable->Reglette->F47301c2e($nIndice % $pclChampTable->F56a8269c()); return; } if ($pclChampTable->m_bEstAjax) { $pclChampTable->m_nIndiceAffichage=$nIndice; if(Feef890d7()) { if($pclChampTable->GetType() == TYPE_CHAMP_TABLE) { F9402f437($pclChampTable->GetNom(), $pclChampTable); } else { F055fb2fe($pclChampTable->GetNom(), $pclChampTable); } } } else { $pclChampTable->SetFirstIndex($nIndice-1); if(Feef890d7()) { if($pclChampTable->GetType() == TYPE_CHAMP_TABLE) { F9402f437($pclChampTable->GetNom(), $pclChampTable); } else { F055fb2fe($pclChampTable->GetNom(), $pclChampTable); } $pclChampTable->F8723e249($pclChampTable->GetFirstIndex() + 1); } } } } function OngletDuChamp(&$pclChamp) { if (!isset($pclChamp)||!is_object($pclChamp)||!$pclChamp->F70cea20e()) { Fe81a7f9e('ERR_CHAMP_INCONNU','FCT_ONGLETDUCHAMP',1,VersChaine($pclChamp)); return null; } if (!isset($pclChamp->m_pclOngletDuChamp)) { return ''; } return $pclChamp->m_pclOngletDuChamp->GetNom(); } function ChangeSeparateur($nSeparateur,$sValeur) { global $MonProjet; if (!isset($MonProjet)) { global $MaPage; $pclContexte =& $MaPage; } else { $pclContexte =& $MonProjet; } switch($nSeparateur) { case 0: $pclContexte->F214aea6a('_gszSEPDEC',$sValeur); break; case 1: $pclContexte->F214aea6a('_gszSEPMIL',$sValeur); break; case 2: $pclContexte->F214aea6a('_gszSEPDEVISE',$sValeur); break; default: } } function PageTauxGFI($nTaux=-1) { if ($nTaux<-1) $nTaux = -1; elseif ($nTaux>100) $nTaux = 100; if ($nTaux==-1) { global $_gszGFI_TAUX; return $_gszGFI_TAUX; } global $MonProjet; if (!isset($MonProjet)) { global $MaPage; $pclContexte =& $MaPage; } else { $pclContexte =& $MonProjet; } $pclContexte->F214aea6a('_gszGFI_TAUX',$nTaux); } function PageActiveGFI($bActive) { $bActive = VersBooleen($bActive); global $_gszGFI_ACTIVE; $bValeurPrecedente = $_gszGFI_ACTIVE; global $MonProjet; if (!isset($MonProjet)) { global $MaPage; $pclContexte =& $MaPage; } else { $pclContexte =& $MonProjet; } $pclContexte->F214aea6a('_gszGFI_ACTIVE',$bActive); return $bValeurPrecedente; } function glien($sChaine) { return utf8_chr(27).'K'. ((string)$sChaine) . utf8_chr(27).'K'; } function gLienActive(&$pclChampListeOuCombo,$bActive=true) { if (!Fa966307f($pclChampListeOuCombo)) { $sNomListeOuCombo = VersChaine($pclChampListeOuCombo); $pclChampListeOuCombo =& WB_Indirection($sNomListeOuCombo); if (!isset($pclChampListeOuCombo)) return null; } $bAncienneValeur = $pclChampListeOuCombo->m_bGlienActif; $pclChampListeOuCombo->m_bGlienActif =(bool)$bActive; return $bAncienneValeur; } function gARecuperer($sChaine) { return utf8_chr(27).'V'. ((string)$sChaine) . utf8_chr(27).'V'; } function MenuAjouteMenu(&$piMenuParent, $pszNomNouveauMenu, $pszLibelleNouveauMenu, $pszNomProcedure=null, $pclParametre=null) { return Fc2ae26aa($piMenuParent , $pszNomNouveauMenu , $pszLibelleNouveauMenu , $pszNomProcedure , $pclParametre , (NULL != $pszNomProcedure) ? 4 : 3); } function MenuAjoutePopup ($piOptionMenu, &$pclChampPopup, $nPosition = 0) { $piOptionMenu =& Fd6962f65($piOptionMenu); $pclChampPopup =& F9abbf335($pclChampPopup,IND_CHAMP); if (null === $piOptionMenu) { F1795d655($piOptionMenu, ID_OPTIONMENU); return; } $pclMenuParent =& $piOptionMenu->Fab988b63(); if (null !== $pclMenuParent->Fab988b63()) { Fb9eb0792('ERR_NOTA_OPTIOMENU_RACINE_POPUP',Fc34ec142('FCT_MENUAJOUTEPOPUP'),$piOptionMenu->Fd464306b()); } if (ID_POPUP_DEST !== $pclChampPopup->GetType()) { F1795d655($pclChampPopup, ID_POPUP_DEST); return; } $pclMenuParent->Feb0a1ae8($piOptionMenu, $pclChampPopup->Alias, $nPosition); } function MenuAjouteOption(&$piMenuParent, $pszNomNouvelleOption, $pszLibelleNouvelleOption, $pszNomProcedure, $pclParametre = null) { return Fc2ae26aa($piMenuParent , $pszNomNouvelleOption , $pszLibelleNouvelleOption , $pszNomProcedure , $pclParametre , 0); } function MenuAjouteOptionURL(&$piMenuParent, $pszNomNouvelleOption, $pszLibelleNouvelleOption, $pszURL) { return Fc2ae26aa($piMenuParent , $pszNomNouvelleOption , $pszLibelleNouvelleOption , $pszURL , null , 1); } function MenuAjouteSeparateur(&$piMenuParent) { return Fc2ae26aa($piMenuParent , null , null , null , null , 2); } function MenuSupprime(&$piMenu,$nIndiceOption = null) { if (isset($nIndiceOption)) { $pclMenu =& F72a34ce0($piMenu, ID_OPTIONMENU); $pclOptionMenu =& $pclMenu->pclGetOption($nIndiceOption-1); --$nIndiceOption; } else { $pclOptionMenu =& F72a34ce0($piMenu, ID_OPTIONMENU); } if ($pclOptionMenu != null) { if ($pclOptionMenu->F60786b1e() != false) { $pclMenuParent =& $pclOptionMenu->Fab988b63(); if ($pclMenuParent != null) { if (!isset($nIndiceOption)) { $nIndiceOption = $pclMenuParent->Ff364ee4e($pclOptionMenu); } if ($nIndiceOption >= 0) { $pclMenuParent->F3153a477($nIndiceOption); } } } else { Fe81a7f9e('ERR_OPTIONPASDYNAMIQUE'); } } } function& F72a34ce0($pszNomChamp, $eTypeAttendu) { if (isset($pszNomChamp)) { $pclObjetMenu =& WB_Indirection($pszNomChamp,IND_CHAMP); if ($pclObjetMenu == null) { F1795d655(null, $eTypeAttendu ); return null; } if ($pclObjetMenu->GetType() != ntypOPTIONMENU) { F1795d655($pclObjetMenu, $eTypeAttendu); return null; } return $pclObjetMenu; } return null; } function& Fd6962f65($pszNomMenu) { if (isset($pszNomMenu)) { $pclObjetMenu =& WB_Indirection($pszNomMenu,IND_CHAMP); if ($pclObjetMenu == null) { F1795d655(null, ID_OPTIONMENU ); return null; } if (!isset($pclObjetMenu->m_tabOptions)) { XVERIFY( F4cd9f399($pclObjetMenu,'CSousMenu') ); } return $pclObjetMenu; } $null=null; return $null; } function Fc2ae26aa( $piMenuParent, $pszNomNouvelleOption, $pszLibelleNouvelleOption, $pszNomCible, $pclParametre, $eModeAjout) { $pclMenuParent =& Fd6962f65($piMenuParent); if ($pclMenuParent == null) return -1; if ( ($eModeAjout !== 2) && ($pclMenuParent->F66f81357($pszNomNouvelleOption) !== null)) { Fe81a7f9e('ERR_OPTIONEXISTEDEJA', $pszNomNouvelleOption, $pclMenuParent->GetNom()); return -1; } $pclNouvelleOption =& $pclMenuParent->Fc85a0519($pszNomNouvelleOption, -1, ($eModeAjout >= 3)); $pclNouvelleOption->Fd060edb1(); if ($eModeAjout !== 2) $pclNouvelleOption->SetLibelle( $pszLibelleNouvelleOption ); switch ($eModeAjout) { case 0: case 4: $pclNouvelleOption->Fcbc9af36($pszNomCible, $pclParametre); break; case 1: $pclNouvelleOption->Ff58e7648(VersURL, $pszNomCible, null); break; case 2: $pclNouvelleOption->Fe7656b24(true); break; case 3: break; default: break; } $pclNouvelleOption->SetVisible(true); return $pclMenuParent->Ff364ee4e($pclNouvelleOption) + 1; } function Occurrence(&$pclInstance) { return GetValeur(GetProp($pclInstance,'Occurrence')); } function DonneCouleur($nIndice = -1) { $nIndiceC = $nIndice-1; if ($nIndice === -1) { global $TabVariableGlobalePAGE; if (!array_key_exists('gnIndiceAutoCouleur',$TabVariableGlobalePAGE)) $TabVariableGlobalePAGE['gnIndiceAutoCouleur'] = 0; $nIndiceC = $TabVariableGlobalePAGE['gnIndiceAutoCouleur']++; } if ($nIndiceC<0) $nIndiceC=0; return F229c12d9($nIndiceC, 0); } $gTabCouleurPaletteVariation = array( array( 0, 21, 22 ), array( 1, 23, 24 ), array( 2, 4, 25 ), array( 3, 5, 26 ), array( 8, 9, 28 ), array( 35, 36, 37 ), array( 38, 39, 40 ), array( 29, 30, 31 ), array( 32, 33, 34 ), array( 6, 7, 27 ), array( 41, 42, 43 ), array( 10, 19, 44 ), array( 18, 45, 46 ), array( 20, 56, 57 ), array( 13, 15, 64 ), array( 65, 66, 67 ), array( 58, 59, 60 ), array( 61, 62, 63 ), array( 11, 47, 48 ), array( 12, 49, 50 ), array( 14, 51, 52 ), array( 53, 54, 55 ), array( 16, 17, 68 ), array( 69, 70, 71 ), array( 72, 73, 74 ), array( 81, 82, 83 ), array( 84, 85, 86 ), array( 75, 76, 77 ), array( 78, 79, 80 ), ); function CouleurPalette($nFamille,$nVariation=1) { global $gTabCouleurPaletteVariation; if (!array_key_exists($nFamille,$gTabCouleurPaletteVariation) || !array_key_exists($nVariation-1,$gTabCouleurPaletteVariation[$nFamille])) return 0; $eCouleur = $gTabCouleurPaletteVariation[$nFamille][$nVariation-1]; if (false===defined('COULEURPALETTE_' . $eCouleur)) { $sNomDoc = 'WDDocXML_CouleurPalette'; global $MaPage; FMK_Charge('WL/XML/XML.php',false); XMLDocument($sNomDoc,file_get_contents(F9486bf1a($MaPage->sFichierPalette))); XMLRecherche($sNomDoc,'ID',XML_ATTRIBUT); while (XMLTrouve($sNomDoc)) { $nId = XMLDonnee($sNomDoc); XMLAnnuleRecherche($sNomDoc); XMLSuivant($sNomDoc); XMLParent($sNomDoc); $sValeurChaineHexa = XMLDonnee($sNomDoc); define('COULEURPALETTE_' . $nId . '_HTML',$sValeurChaineHexa); define('COULEURPALETTE_' . $nId,F91b14b72(F63d91c07($sValeurChaineHexa))); XMLRecherche($sNomDoc,'ID',XML_ATTRIBUT); XMLSuivant($sNomDoc); } XMLTermine($sNomDoc); unset($sNomDoc); } return constant('COULEURPALETTE_' . $eCouleur); } $ms_tabLanguesNomAvecVariantes = array( 'fr-fr' => NATION_FRANCAIS, 'en-gb' => NATION_ANGLAIS, 'de-de' => NATION_ALLEMAND, 'en-us' => NATION_AMERICAIN, 'en-au' => NATION_AUSTRALIEN, 'fr-ca' => NATION_CANADIEN_FRANCAIS, 'da-dk' => NATION_DANOIS, 'es-es' => NATION_ESPAGNOL, 'fi-fi' => NATION_FINNOIS, 'is-is' => NATION_ISLANDAIS, 'it-it' => NATION_ITALIEN, 'nl-nl' => NATION_NEERLANDAIS, 'no-no' => NATION_NORVEGIEN, 'nb-no' => NATION_NORVEGIEN, 'nn-no' => NATION_NORVEGIEN, 'pt-pt' => NATION_PORTUGAIS, 'pt-br' => NATION_PORTUGAIS_BRESILIEN, 'ru-ru' => NATION_RUSSE, 'sv-se' => NATION_SUEDOIS, 'cs-cz' => NATION_TCHEQUE, 'ar-ar' => NATION_ARABE, 'bs-ba' => NATION_BOSNIAQUE, 'bg-bg' => NATION_BULGARE, 'zh-tw' => NATION_CHINOIS_TRADITIONNEL, 'zh-cn' => NATION_CHINOIS, 'ko-kr' => NATION_COREEN, 'hr-hr' => NATION_CROATE, 'et-ee' => NATION_ESTONIEN, 'el-gr' => NATION_GREC, 'he-il' => NATION_HEBREUX, 'hu-hu' => NATION_HONGROIS, 'ga-ie' => NATION_IRLANDAIS, 'ja-jp' => NATION_JAPONAIS, 'lv-lv' => NATION_LETTON, 'lt-lt' => NATION_LITUANIEN, 'pl-pl' => NATION_POLONAIS, 'ro-ro' => NATION_ROUMAIN, 'sr-rs' => NATION_SERBE, 'sk-sk' => NATION_SLOVAQUE, 'sl-si' => NATION_SLOVENE, 'th-th' => NATION_THAI, 'tr-tr' => NATION_TURC, 'vi-vn' => NATION_VIETNAMIEN, ); $ms_tabLanguesNomSansVariantes = array( 'fr' => NATION_FRANCAIS, 'en' => NATION_ANGLAIS, 'de' => NATION_ALLEMAND, 'da' => NATION_DANOIS, 'es' => NATION_ESPAGNOL, 'fi' => NATION_FINNOIS, 'is' => NATION_ISLANDAIS, 'it' => NATION_ITALIEN, 'nl' => NATION_NEERLANDAIS, 'no' => NATION_NORVEGIEN, 'nb' => NATION_NORVEGIEN, 'nn' => NATION_NORVEGIEN, 'pt' => NATION_PORTUGAIS, 'ru' => NATION_RUSSE, 'sv' => NATION_SUEDOIS, 'cs' => NATION_TCHEQUE, 'ar' => NATION_ARABE, 'bs' => NATION_BOSNIAQUE, 'bg' => NATION_BULGARE, 'zh' => NATION_CHINOIS, 'ko' => NATION_COREEN, 'hr' => NATION_CROATE, 'et' => NATION_ESTONIEN, 'el' => NATION_GREC, 'he' => NATION_HEBREUX, 'hu' => NATION_HONGROIS, 'ga' => NATION_IRLANDAIS, 'ja' => NATION_JAPONAIS, 'lv' => NATION_LETTON, 'lt' => NATION_LITUANIEN, 'pl' => NATION_POLONAIS, 'ro' => NATION_ROUMAIN, 'sr' => NATION_SERBE, 'sk' => NATION_SLOVAQUE, 'sl' => NATION_SLOVENE, 'th' => NATION_THAI, 'tr' => NATION_TURC, 'vi' => NATION_VIETNAMIEN, ); class CAcceptLanguage { var $m_tabLangues; function CAcceptLanguage() { $this->m_tabLangues = array(); $this->Ffb5ecf3f(); } function Ffb5ecf3f() { $cszAcceptLanguage = Faee3f2e8('HTTP_ACCEPT_LANGUAGE'); $nRang = 0; foreach(Fb05a9221($cszAcceptLanguage, ',') as $cszLangueEtPreference) { $cszLangueEtPreference=utf8_trim($cszLangueEtPreference); $this->Fe1ae51df($cszLangueEtPreference); } } function Fe1ae51df(&$rcszLangueEtPreference) { if (!empty($rcszLangueEtPreference)) { $cszLangue = utf8_trim( F05ad8ed4($rcszLangueEtPreference, rangPremier, ';') ); if ($cszLangue!==EOT) { if (!empty($cszLangue)) { if ($cszLangue !== '*') { global $ms_tabLanguesNomAvecVariantes, $ms_tabLanguesNomSansVariantes; $bAvecVariante = (strpos($rcszLangueEtPreference,'-')!==false); if ($bAvecVariante && isset($ms_tabLanguesNomAvecVariantes[$cszLangue])) { $this->Ff7e101b8($ms_tabLanguesNomAvecVariantes[$cszLangue],true); } else if (!$bAvecVariante && isset($ms_tabLanguesNomAvecVariantes[$cszLangue])) { $this->Ff7e101b8($ms_tabLanguesNomAvecVariantes[$cszLangue],true); } else { $sFamilleDemandee = F05ad8ed4($cszLangue, rangPremier, '-'); foreach($ms_tabLanguesNomAvecVariantes as $sFamilleLangue => $nNation) { if (F05ad8ed4($sFamilleLangue, rangPremier, '-') === $sFamilleDemandee) $this->Ff7e101b8($nNation,false); } } } else { $this->Ff7e101b8(-2, true); } } } } } function Ff7e101b8($eLangue, $bExacte) { if (isset($this->m_tabLangues[$eLangue]) && $this->m_tabLangues[$eLangue]) return; $this->m_tabLangues[$eLangue] = $bExacte; } } ?>