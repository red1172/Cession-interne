<?php
//20.0.56.0 IHM/Champ/Calendrier/ControleurChampCalendrier_Web.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__IHM/Champ/Calendrier/ChampCalendrier.php')) { define('__INC__IHM/Champ/Calendrier/ChampCalendrier.php',true); include_once(WB_INCLUDE_PATH.'WD1aa4dcf1463d195c040c2a3cf17bd5da.php'); } if (!defined('__INC__IHM/Champ/Champ.php')) { define('__INC__IHM/Champ/Champ.php',true); include_once(WB_INCLUDE_PATH.'WD7c939e6867492a5e5416bd4b4327fac0.php'); } class CControleurChampCalendrier_Web extends CControleurChamp_Web { function CControleurChampCalendrier_Web ( &$pclModele) { parent::CControleurChamp_Web($pclModele); } function& Fde9abc90() { return $this->Fda201604(); } function F0bf0c400( $eAction, $Parametere = null) { switch ($eAction) { case ACTION_WEB_PRINCIPALE: { $pclModele =& $this->Fda201604(); $pclZR = null; $bEstChampSaisie = $pclModele->F6ce2b314($pclZR); if (isset($pclZR)) { if (!$bEstChampSaisie) { return ACTION_WEB_RESULTAT_OK; } } $pszValeur = F4e7f6fae(Fc3c777b7("%s_JOUR", $pclModele->F317347df())); if ((!isset($pszValeur))|| (F01dad99e($pszValeur) == false)) return ACTION_WEB_RESULTAT_ERREUR; $nRaisonMois = 0; $pclModeleChampCalendrier =& $this->Fde9abc90(); $pclMoisCourant =& $pclModeleChampCalendrier->Fed58e9ca(); $nComparaison = $pclMoisCourant->Ff5b208cb($pszValeur); if ($nComparaison < 0) $nRaisonMois = nCHANGEMOIS_SUIVANTUSER; else if ($nComparaison < 0) $nRaisonMois = nCHANGEMOIS_PRECEDENTUSER; else $nRaisonMois = nCHANGEMOIS_SANSUSER; $clDateCalendrier=new CDateCalendrier($pszValeur); $pclModeleChampCalendrier->F7e337dc2($clDateCalendrier, $nRaisonMois); } return ACTION_WEB_RESULTAT_OK; case ACTION_WEB_CALENDRIER_AUJOURDHUI: $pclModeleChampCalendrier =& $this->Fde9abc90(); $pclModeleChampCalendrier->F817a2aae(); return ACTION_WEB_RESULTAT_OK; case ACTION_WEB_CALENDRIER_MOISPREC: $pclModeleChampCalendrier =& $this->Fde9abc90(); $pclModeleChampCalendrier->Feb869ee3(); return ACTION_WEB_RESULTAT_OK; case ACTION_WEB_CALENDRIER_MOISSUIV: $pclModeleChampCalendrier =& $this->Fde9abc90(); $pclModeleChampCalendrier->F8e55546c(); return ACTION_WEB_RESULTAT_OK; default: return parent::F0bf0c400($eAction); } } } class CControleurChampAgenda_Web extends CControleurChampCalendrier_Web { var $m_xpiHTTPRequeteLocal = null; var $m_xpclRendezVous = null; var $m_nRendezVous = nNUMELEMENT_INVALIDE; var $m_clDateDebutAffichage = null; var $m_clDateDebutAffichageScroll = null; function CControleurChampAgenda_Web ( &$pclModele) { parent::CControleurChampCalendrier_Web($pclModele); $this->m_xpiHTTPRequeteLocal = null; $this->m_xpclRendezVous = new CDinoRendezVous(); $this->m_nRendezVous=nNUMELEMENT_INVALIDE; $this->m_clDateDebutAffichage = new CDateAgenda(); $this->m_clDateDebutAffichageScroll = new CDateAgenda(); } function Fe27642cb($eAction, $bInterditSiInactif) { switch ($eAction) { case ACTION_WEB_AGENDA_RDV_DEPLACEMENT: case ACTION_WEB_AGENDA_RDV_REDIM: case ACTION_WEB_AGENDA_RDV_SUPPRIME: case ACTION_WEB_AGENDA_RDV_AJOUTE: $bInterditSiInactif = true; case ACTION_WEB_AGENDA_RDV_EDITIONTITRE: case ACTION_WEB_AGENDA_PERIODE_AFFICHE: return parent::Fe27642cb($eAction, $bInterditSiInactif); default: return $this->F698bf3a0($eAction, 0); } } function F0bf0c400($eAction, $Parametere = null) { if (ACTION_WEB_AGENDA_PERIODE_AFFICHE !== $eAction) { if (false === $this->F482ba9c0()) { return ACTION_WEB_RESULTAT_ERREUR; } } $bRes = false; switch ($eAction) { case ACTION_WEB_AGENDA_RDV_DEPLACEMENT: $bRes = $this->Ffab22225(); break; case ACTION_WEB_AGENDA_RDV_REDIM: $bRes = $this->F11b6a410(); break; case ACTION_WEB_AGENDA_RDV_SUPPRIME: $bRes = $this->F606364d0(); break; case ACTION_WEB_AGENDA_RDV_AJOUTE: $bRes = $this->Fa27a481f(); break; case ACTION_WEB_AGENDA_RDV_EDITIONTITRE: $bRes = $this->F5d7c477e(); break; case ACTION_WEB_AGENDA_PERIODE_AFFICHE: $bRes = $this->Fb67e7e2f(); break; default: $this->F0b324609(); return parent::F0bf0c400($eAction); } $this->F0b324609(); return $bRes ? ACTION_WEB_RESULTAT_OK : ACTION_WEB_RESULTAT_ERREUR; } function F26f6dd90(&$rpszRessource) { $rpszRessource = NULL; return true; } function Fbe12f8ca(&$rclDateHeure) { } function Fb67e7e2f($bPourPlacementDonnees=false) { if ($this->m_pclModele->Etat != ETAT_CHAMP_ACTIF) return false; if (0 !== $this->m_clDateDebutAffichage->Fc734cbfe()) { $this->m_pclModele->Feca5376f($this->m_clDateDebutAffichage, 1); } return true; } function Ffab22225() { $pclModele =& $this->m_pclModele; if (false === $pclModele->F9ab17b6e($this->m_xpclRendezVous)) { return false; } $clDateDebut = new CDateAgenda(); if (false === $this->F22b3862c('m_oDateDebut', $clDateDebut)) return false; if ( (ID_AGENDA === $pclModele->Feb661866()) && (eZoomMois == $pclModele->m_eModeZoom) && (null !== $this->m_xpclRendezVous)) { $clDateDebut->m_dwHeure = $this->m_xpclRendezVous->m_clDateDebut->m_dwHeure; } $pszRessource = ''; if (false === $this->F26f6dd90($pszRessource)) return false; $pclModele->Fc49677c2($this->m_xpclRendezVous, $clDateDebut, $pszRessource); return true; } function F0b324609() { $this->m_xpiHTTPRequeteLocal = null; $clNouvelleInstance = new CDinoRendezVous(); $this->m_xpclRendezVous =& $clNouvelleInstance; $this->m_nRendezVous = nNUMELEMENT_INVALIDE; $this->m_clDateDebutAffichage->Fea34dd7d(); $this->m_clDateDebutAffichageScroll->Fea34dd7d(); } function F482ba9c0() { if (null !== $this->m_xpiHTTPRequeteLocal) { return true; } return false; } function F8e23c9b4($eAction, &$rpszParam) { $pszParamEvenement = $rpszParam; if (false === $this->Fca9da5c1(false, $rpszParam)) return false; if (null !== $rpszParam) { $nTaille = utf8_strlen($pszParamEvenement) - utf8_strlen($rpszParam) - 1; } else { $nTaille = utf8_strlen($pszParamEvenement); } utf8_parse_str(utf8_substr($pszParamEvenement,utf8_strlen((string)$rpszParam),$nTaille),$this->m_xpiHTTPRequeteLocal); if (null !== $this->m_xpiHTTPRequeteLocal) { $dwIDUnique = -1; if (false === $this->Fe6723554($this->m_xpiHTTPRequeteLocal, 'm_sID', $dwIDUnique)) { return (ACTION_WEB_AGENDA_RDV_AJOUTE === $eAction); } $dwIDUnique = intval($dwIDUnique); $pclEvenement =& $this->m_pclModele->Febbdb070($dwIDUnique,$this->m_nRendezVous); if (null !== $pclEvenement) { $this->m_xpclRendezVous =& $pclEvenement; } else { return false; } if ($this->m_nRendezVous !== $this->m_pclModele->F5c14ecc7()) { $this->m_pclModele->F55d8e854($pclEvenement, $this->m_nRendezVous, nFROM_CONTROLEUR); } } return true; } function F22b3862c($pszNomParametre, &$rclDate) { $qwDate = 0; if (false === $this->Fe6723554($this->m_xpiHTTPRequeteLocal, $pszNomParametre, $qwDate)) return false; return $this->F7c5123d9($qwDate, $rclDate); } function F37dde032( &$rpszParam, &$rclDate) { $pszParamDate = $rpszParam; if (false === $this->Fca9da5c1(false, $rpszParam)) return false; $qwDate = 0; if (false == $this->Fe6723554(array(0=>utf8_substr($pszParamDate,0,utf8_strlen($pszParamDate)-utf8_strlen($rpszParam)-1)),0, $qwDate)) return false; return $this->F7c5123d9($qwDate, $rclDate); } function F7c5123d9($qwDate, &$rclDate) { $clDate = new CDateTime(0x07B20101, 0); $rclDate->F278c4330($clDate); $rclDate->F2bc25f7f($qwDate); return true; } function F11b6a410() { if (false === $this->m_pclModele->F74df5824($this->m_xpclRendezVous)) { return false; } $clDateDebut = new CDateAgenda(); if (false === $this->F22b3862c('m_oDateDebut', $clDateDebut)) return false; $clDateFin = new CDateAgenda(); if (false === $this->F22b3862c('m_oDateFin', $clDateFin)) return false; $bSansRedimDebut = false; $this->Fe6723554($this->m_xpiHTTPRequeteLocal, 'm_bSansRedimDebut', $bSansRedimDebut); if (false != $bSansRedimDebut) $clDateDebut = $this->m_xpclRendezVous->m_clDateDebut; $bSansRedimFin = false; $this->Fe6723554($this->m_xpiHTTPRequeteLocal, 'm_bSansRedimFin', $bSansRedimFin); if (false != $bSansRedimFin) $clDateFin = $this->m_xpclRendezVous->m_clDateFin; $this->m_pclModele->F0851fca1($this->m_xpclRendezVous, $clDateDebut, $clDateFin); return true; } function F606364d0() { if ($this->m_pclModele->Etat != ETAT_CHAMP_ACTIF) return false; $this->m_pclModele->F83a3eb72(); return true; } function Fa27a481f() { if ($this->m_pclModele->Etat != ETAT_CHAMP_ACTIF) return false; $cszTitre = $this->Fee423a26($this->m_xpiHTTPRequeteLocal,'m_sTitre'); $clDateDebut = new CDateAgenda(); if (false === $this->F22b3862c('m_oDateDebut', $clDateDebut)) return false; $clDateFin = new CDateAgenda(); if (false === $this->F22b3862c('m_oDateFin', $clDateFin)) return false; $pszRessource = ''; if (false === $this->F26f6dd90($pszRessource)) return false; $bJourneeEntiere = false; $this->Fe6723554($this->m_xpiHTTPRequeteLocal, 'm_bJourneeEntiere', $bJourneeEntiere); if ( (ID_AGENDA === $this->m_pclModele->Feb661866()) && (eZoomMois === $this->m_pclModele->m_eModeZoom)) $bJourneeEntiere = true; $nRectEve = (false !== (bool)$bJourneeEntiere) ? 2 : 1; $this->m_pclModele->F1184b744(null, $cszTitre, $clDateDebut, $clDateFin, null, '', $pszRessource, $nRectEve); return true; } function F5d7c477e() { if (false === $this->m_pclModele->Fedf458ec($this->m_xpclRendezVous)) { return false; } $cszTitre = $this->Fee423a26($this->m_xpiHTTPRequeteLocal,'m_sTitre'); $this->m_pclModele->F4ed1c0b0($this->m_xpclRendezVous, $this->m_nRendezVous, $cszTitre); return true; } function Fb29dfdd9($pszDonneesUTF8) { $pszDonneesUTF8 =parent::Fb29dfdd9($pszDonneesUTF8); if (F61196400($pszDonneesUTF8)) { $this->F0b324609(); $bRes = $this->F37dde032($pszDonneesUTF8, $this->m_clDateDebutAffichage); $bRes = $this->F37dde032($pszDonneesUTF8, $this->m_clDateDebutAffichageScroll); if (false !== $bRes) { $this->Fbe12f8ca($this->m_clDateDebutAffichageScroll); } $this->F8e23c9b4(ACTION_WEB_SELECTION, $pszDonneesUTF8); } return $pszDonneesUTF8; } } class CControleurChampPlanning_Web extends CControleurChampAgenda_Web { function CControleurChampPlanning_Web ( &$pclModele) { parent::CControleurChampAgenda_Web($pclModele); } function F26f6dd90( &$rpszRessource) { $dwRessource = 0; if (false !== $this->Fe6723554($this->m_xpiHTTPRequeteLocal,'m_nRessource', $dwRessource)) { if (false !== $this->m_pclModele->F75cd9976($dwRessource)) { $rpszRessource = $this->m_pclModele->Ff73c76ba($dwRessource, 2); return true; } else { } } $rpszRessource = null; return false; } function Fbe12f8ca(&$rclDateHeure) { $this->m_pclModele->Fb1c46213($rclDateHeure, 1); } } ?>