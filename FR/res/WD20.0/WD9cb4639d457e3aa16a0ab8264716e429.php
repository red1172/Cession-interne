<?php
//20.0.56.0 FMK/Sql/MySql.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 define('FMK_SQL_MYSQL',true); if (!defined('__INC__FMK/Sql.php')) { define('__INC__FMK/Sql.php',true); include_once(WB_INCLUDE_PATH.'WD4b9c73b07be5742abf5273cd830e12f9.php'); } function F30873e4f( $TabRow ) { $TabMySQL2HF['BIT'] = array('N', 1, 1); $TabMySQL2HF['BOOL'] = array('N', 1, 1); $TabMySQL2HF['TINYINT'] = array('N', 2, 1); $TabMySQL2HF['BIGINT'] = array('N', 3, 8); $TabMySQL2HF['TINYBLOB'] = array('T', 4, -1); $TabMySQL2HF['BLOB'] = array('T', 4, -1); $TabMySQL2HF['LONGBLOB'] = array('T', 4, -1); $TabMySQL2HF['MEDIUMBLOB'] = array('T', 4, -1); $TabMySQL2HF['LONGBLOB'] = array('T', 4, -1); $TabMySQL2HF['TINYTEXT'] = array('T', 7); $TabMySQL2HF['TEXT'] = array('T', 7); $TabMySQL2HF['STRING'] = array('T', 7); $TabMySQL2HF['SET' ] = array('T', 7); $TabMySQL2HF['MEDIUMTEXT' ] = array('T', 7); $TabMySQL2HF['LONGTEXT' ] = array('T', 7); $TabMySQL2HF['ENUM'] = array('N', 7); $TabMySQL2HF['CHAR'] = array('T', 9); $TabMySQL2HF['NUMERIC'] = array('N', 10); $TabMySQL2HF['DECIMAL'] = array('N', 11); $TabMySQL2HF['DEC'] = array('N', 11); $TabMySQL2HF['INTEGER'] = array('N', 12, 4); $TabMySQL2HF['INT'] = array('N', 12, 4); $TabMySQL2HF['MEDIUMINT'] = array('N', 12, 4); $TabMySQL2HF['SMALLINT'] = array('N', 13, 2); $TabMySQL2HF['FLOAT'] = array('T', 14, 4); $TabMySQL2HF['REAL'] = array('T', 15, 4); $TabMySQL2HF['DOUBLE'] = array('T', 16, 8); $TabMySQL2HF['NUMERIC'] = array('T', 16, 8); $TabMySQL2HF['DATE'] = array('T', 17, 8); $TabMySQL2HF['TIME'] = array('T', 18, 8); $TabMySQL2HF['DATETIME'] = array('T', 18, 8); $TabMySQL2HF['TIMESTAMP'] = array('T', 19, 8); $TabMySQL2HF['VARCHAR'] = array('T', 20); $szNomTypeSQL = utf8_strtoupper($TabRow[1]); $nPosParenthe = utf8_strpos( $szNomTypeSQL, '(' ); if ($nPosParenthe > 0) { $Taille = 0 + utf8_substr( $szNomTypeSQL, $nPosParenthe+1 ); $szNomTypeSQL = utf8_substr( $szNomTypeSQL, 0, $nPosParenthe ); } $TabInfo = $TabMySQL2HF[ $szNomTypeSQL ]; if (!isset($TabInfo[2])) $TabInfo[2] = $Taille; return $TabInfo; } class FMK_ConnexionMySql { var $ConnectID; function F98fedcfa( $Source, $Utilisateur, $MotDePasse, $NomDeLaDataBase ) { global $gclContextSQL; $SQL =& F144dce03(); if (!function_exists( 'mysql_pconnect' )) { Erreur('ErreurGenerique',Fc34ec142("ERR_WLL"),Fc34ec142("ERR_FATAL"),Fc34ec142("ERR_NOMYSQL")); return false; } DebutErreurAttendue(); $this->ConnectID = mysql_pconnect($Source, $Utilisateur, $MotDePasse); FinErreurAttendue(); $gclContextSQL->ConnectID = $this->ConnectID; $SQL->ConnectID = $gclContextSQL->ConnectID; if (!$gclContextSQL->ConnectID) { Ffe27c994('mysql_connect'); return false; } DebutErreurAttendue(); $res = mysql_select_db($NomDeLaDataBase); FinErreurAttendue(); if (!$res) { Ffe27c994('mysql_select_db'); return false; } return true; } function F3f4d9a86() { DebutErreurAttendue(); mysql_close( $this->ConnectID ); FinErreurAttendue(); } function Fc639f13d( $szCodeSQL ) { DebutErreurAttendue(); $res = mysql_query($szCodeSQL, $this->ConnectID ) or false; FinErreurAttendue(); if ($res === false) { Ffe27c994('mysql_query'); return false; } return $res; } function F75609ad1( $resQuery, $sCodeInsert ) { if (!$resQuery) return false; F6b1e3687(); $bEstInsert = ( is_resource($resQuery) && (mysql_affected_rows($resQuery) == 1) ); F1e7b0563(); if (F1abae4f0()!='') { F3ccdac86(F1abae4f0(),errMessageSysteme); } if (!$bEstInsert) return false; F6b1e3687(); $nIdAuto = mysql_insert_id($resQuery); F1e7b0563(); return ($nIdAuto == 0) ? false : $nIdAuto; } function F58e3a375( $resQuery ) { DebutErreurAttendue(); if ($resQuery) mysql_free_result($resQuery); FinErreurAttendue(); } function F4a096310( $resQuery ) { if (!$resQuery) return false; DebutErreurAttendue(); $return = mysql_fetch_row($resQuery); FinErreurAttendue(); return $return; } function Fd5a050a1( $resQuery ) { DebutErreurAttendue(); $return = mysql_num_fields( $resQuery ); FinErreurAttendue(); return $return; } function F978f8f4e( $bSimple, $bQueLesTableEtVues) { DebutErreurAttendue(); $result = mysql_query("SHOW TABLES", $this->ConnectID ) or false; FinErreurAttendue(); if (!$result) { Ffe27c994('SHOW TABLES'); return ""; } $szRes = ''; DebutErreurAttendue(); $TabRow = mysql_fetch_row($result); FinErreurAttendue(); while ($TabRow) { if ($szRes != '') $szRes .= "\n"; $szRes .= $TabRow[0]; if (!$bSimple) { } DebutErreurAttendue(); $TabRow = mysql_fetch_row($result); FinErreurAttendue(); } return $szRes; } function Fbf1c42e2( $szNomTable, $bSimple ) { DebutErreurAttendue(); $res = mysql_query("DESCRIBE $szNomTable") or false; FinErreurAttendue(); if (!$res) return ''; $szRes = ''; DebutErreurAttendue(); $TabRow = mysql_fetch_row($res); FinErreurAttendue(); while( $TabRow ) { if ($szRes != '') $szRes .= "\n"; $szRes .= $TabRow[0]; if ($bSimple) { $TabInfo = F30873e4f( $TabRow ); $szRes .= "\t" . $TabInfo[0]; $szRes .= "\t" . $TabInfo[1]; $szRes .= "\t" . $TabInfo[2]; } DebutErreurAttendue(); $TabRow = mysql_fetch_row($res); FinErreurAttendue(); } return $szRes; } function F39bb791f( $resQuery , $i, $bSimple ) { $szRes = mysql_field_name ( $resQuery , $i ); if ($bSimple) { DebutErreurAttendue(); $TabRow = array( '', mysql_field_type($resQuery , $i) . '(' . mysql_field_len($resQuery , $i) . ')' ); FinErreurAttendue(); $TabInfo = F30873e4f( $TabRow ); $szRes .= "\t" . $TabInfo[0]; $szRes .= "\t" . $TabInfo[1]; $szRes .= "\t" . $TabInfo[2]; } return $szRes; } function F841ad845( &$pstInfoReq, $Code ) { DebutErreurAttendue(); $pstInfoReq->Erreur = mysql_errno(); $pstInfoReq->MesErreur = $Code.":".mysql_error(); FinErreurAttendue(); } } ?>