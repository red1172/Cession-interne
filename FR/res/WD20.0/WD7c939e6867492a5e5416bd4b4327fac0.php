<?php
//20.0.56.0 IHM/Champ/Champ.php GF 
//VersionVI: 30F200066p
//(c) 2005-2012 PC SOFT  - Release
 if (!defined('__INC__IHM/ObjetBase.php')) { define('__INC__IHM/ObjetBase.php',true); include_once(WB_INCLUDE_PATH.'WD55e11718a84583ed04e842fb319086b2.php'); } class CChamp extends CObjetBase { var $FichierParcours; var $RubriqueParcours; var $sRubriqueAffichee= ""; var $sFichierAffiche; var $sFichierBase; var $sRubriqueBase; var $sRubriqueReliee; var $sRubriqueMemorisee = ""; var $FichierLiaison = null; var $RubriqueLiaison = null; var $bMultiLiaison = false; var $sValeurRecherche = ""; var $bParcoursAsc= true; var $nLastPosition = -1; var $nFirstIndex = 0; var $nLastIndex = 0; var $nMaxLignePage = 0; var $nLimiteChargementMemoire = null; var $TabPosition = array(); var $m_clGestFichierParcouru = null; var $m_nActionAutoriseeBase; var $m_pclOngletDuChamp = null; var $m_sBarreOutilsOptions; var $m_eBarreOutilsMode; var $_Optim_bPcodeAffichageLigne = null; var $m_bInterne = false; function CChamp() { parent::CObjetBase(); $this->m_nActionAutoriseeBase = (nACTSRC_AJOUT | nACTSRC_MODIF | nACTSRC_SUPPR); } function F0198de68($sClasseVue, $eTypeVue) { switch ($eTypeVue) { case VUECONTROLEUR_TYPE_SANS: return null; case VUECONTROLEUR_TYPE_WEB : return new $sClasseVue($this); break; default: return null; } } function Fea7a1f04($sClasseControleur, $eTypeControleur) { switch ($eTypeControleur) { case VUECONTROLEUR_TYPE_SANS: return null; case VUECONTROLEUR_TYPE_WEB: return new $sClasseControleur($this); default: return null; } } function F7593ffad($dwFlags) { CWebCommun::F7593ffad(dwFlags); } function Fb560a68a($dwFlags) { CWebCommun::Fb560a68a($dwFlags); $this->Fb3dcf02b(F166fddb3($dwFlags, dwrvNOCHILD | dwrvCREATE)); } function Fb3dcf02b($dwFlags) { if (isset($this->ValeurInitiale)) { $this->Fc6eb41aa(); return true; } return false; } function F48dce54a() { return $this->FichierParcours != null; } function F5ffae798($pclTabValeur,$hPosHF,$hPosDINO) { } function F8ec1b7af($nNumElemModif,&$pclTabValeur, $nNbValeur, $hPositionHF, $hPosDino) { } function F3de60b01(&$pclFichierAnalyse) { return array(); } function Fa96f8906($nNumElemModif, &$phPosElement) { return 0; } function F3ee935df(&$pclEvenement) { } function Fd3a7c1a8() { } function F77cc9fa2($nNumElemModif) { } function Fa87e84c7(&$pclTabVal, $nNbValeur, $nFlag = 0 ) { } function Fbe50ddf6($nIndice) { if (!isset($this->_Optim_bPcodeAffichageLigne )) { if (ExecuteTraitement($this->m_sNomPHP,trtAffichageLigne,false,true)===false) { $this->_Optim_bPcodeAffichageLigne = false; return true; } else $this->_Optim_bPcodeAffichageLigne = true; } elseif ($this->_Optim_bPcodeAffichageLigne===false) { return true; } if ($this->bPcodeAffichageEnCours === true) return true; $this->bPcodeAffichageEnCours = true; $nAncienneValeur = $this->Valeur; if ($this->F48dce54a()) { $Cache = $this->RubriqueParcours->BufferParcours->Cache; $nPosition = $this->FichierParcours->Fd172163b($this->RubriqueParcours); } $bAjax = Feef890d7(); F3ecf4149(false); $this->F37bb1c9f($nIndice); F3ecf4149($bAjax); if ($this->F48dce54a()) { $bAncienneValeur = $this->FichierParcours->m_bNouvelEnregistrement; $this->FichierParcours->m_bNouvelEnregistrement = 0; } ExecuteTraitement($this->m_sNomPHP,trtAffichageLigne,false); if ($this->F48dce54a()) { $bRetourPositionUtile = ($this->FichierParcours->m_bNouvelEnregistrement !== 0); $this->FichierParcours->m_bNouvelEnregistrement = $bAncienneValeur; } $this->bPcodeAffichageEnCours = false; F3ecf4149(false); $this->F37bb1c9f($nAncienneValeur); F3ecf4149($bAjax); if ($this->F48dce54a()) { Fe4e65a90($nPosition); if (false === $bRetourPositionUtile) { $this->RubriqueParcours->BufferParcours->Cache = $Cache; } } return true; } function Fb40d01a9($nLigne) { if (ExecuteTraitement($this->m_sNomPHP,TRT_Filtre_Page,false,true)===false) { return nFILTRE_OK; } if ($this->F48dce54a()) { $nPosition = $this->FichierParcours->Fd172163b($this->RubriqueParcours); $Cache = $this->RubriqueParcours->BufferParcours->Cache; $bAncienneValeur = $this->FichierParcours->m_bNouvelEnregistrement; $this->FichierParcours->m_bNouvelEnregistrement = 0; } $bResultat = ExecuteTraitement($this->m_sNomPHP,TRT_Filtre_Page,false); if ($this->F48dce54a()) { $bRetourPositionUtile = ($this->FichierParcours->m_bNouvelEnregistrement !== 0); $this->FichierParcours->m_bNouvelEnregistrement = $bAncienneValeur; Fe4e65a90($nPosition); if (false === $bRetourPositionUtile) { $this->RubriqueParcours->BufferParcours->Cache = $Cache; } } if ($bResultat === false) { return nFILTRE_LIGNESUIVANTE; } elseif ($bResultat === true) { return nFILTRE_OK; } elseif ($bResultat === 2) { return nFILTRE_FIN; } else { return nFILTRE_OK; } return nFILTRE_ERREUR; } function F689fe026() { return true; } function F7b66f7f8() { return PHP_INT_MAX; } function dDebutDessin() { Fdd46bacf(FMK_ChaineConstruit(Fc34ec142("ERR_DESSIN"),Fc34ec142("FCT_DDEBUTDESSIN"))); return false; } function& GetOpacite() { return $this->m_nOpacite; } function SetOpacite($nOpacite) { if ( (!is_numeric($nOpacite)) || ($nOpacite<0) || ($nOpacite>100)) { $nOpacite = 100; } $this->m_nOpacite = $nOpacite; if (Feef890d7()) { F4c16799e($this->m_sNomPHP,XML_CHAMP_PROP_NUM_OPACITE); } } function Fdc05d49f( $ValeurHTTP ) { } function GetValeurHTML( $TypeConvertion = 0 ) { if ($TypeConvertion==2) return $this->GetValeurAffichee(); $Res = utf8_htmlentities( $this->GetValeurAffichee() , ENT_NOQUOTES ); $Res = utf8_str_replace("\r\n", '<BR>', $Res ); $Res = utf8_str_replace("\n", '<BR>', $Res ); $Res = utf8_str_replace("\r", '<BR>', $Res ); return $Res; } function Fb2784a04() { return $this->GetValeur(); } function GetLibelleHTML( $TypeConvertion = 0 ) { if ($TypeConvertion==2) return $this->GetLibelle(); elseif ($TypeConvertion==0 && $this->m_bLibelleRiche) return $this->GetLibelle(); $Res = utf8_htmlentities( $this->GetLibelle() , ENT_NOQUOTES ); $Res = utf8_str_replace("\r\n", '<br>', $Res ); $Res = utf8_str_replace("\n", '<br>', $Res ); $Res = utf8_str_replace("\r", '<br>', $Res ); return $Res; } function GetCouleurHTML() { return F5bfcd185($this->Couleur); } function GetCouleurFondHTML() { return F5bfcd185($this->CouleurFond); } function& GetType() { return getRef(3); } function Fc6eb41aa() { $this->SetValeur( isset($this->ValeurInitiale) ? $this->ValeurInitiale : '' ); } function F37bb1c9f($Valeur) { $this->Valeur = $Valeur; } function F9888ce5c() { $this->ValeurInitiale = _clone($this->Valeur); } function SetLiaisonFichier($sNomFichier, $sNomRubrique, $pclZR=null, $sNomPHP=null) { $this->sFichierBase = $sNomFichier; $this->sFichierAffiche = $sNomFichier; $this->sRubriqueBase = $sNomRubrique; $this->sRubriqueAffichee = $sNomRubrique; global $MaPage; $MaPage->F7a045ba1($this->Alias, $this); if(isset($pclZR)) { $pclZR->F18f1a158($this,$sNomPHP,$sNomFichier,$sNomRubrique); } } function Fa1b569ab() { return false;; } function SetLiaisonMultiFichier($sFichierBase, $sRubriqueBase, $sFichierRelie1 = "", $sRubriqueRelie1 = "", $sRubriqueAffichee1 = "", $sFichierRelie2 = "", $sRubriqueRelie2= "", $sRubriqueAffichee2="", $pclZR=null, $sNomPHP=null) { if(empty($sFichierRelie1)) { $this->SetLiaisonFichier($sFichierBase, $sRubriqueBase,$pclZR,$sNomPHP); } else { $this->sFichierBase = $sFichierBase; $this->sRubriqueBase = $sRubriqueBase; if(empty($sFichierRelie2)) { $this->bMultiLiaison = true; $this->sFichierAffiche = $sFichierRelie1; $this->sRubriqueAffichee = $sRubriqueAffichee1; $this->sRubriqueReliee = $sRubriqueRelie1; } else { $this->bMultiLiaison = true; $this->sFichierAffiche = array($sFichierRelie1 , $sFichierRelie2); $this->sRubriqueAffichee = array($sRubriqueAffichee1 , $sRubriqueAffichee2); $this->sRubriqueReliee = array($sRubriqueRelie1,$sRubriqueRelie2); } global $MaPage; $MaPage->F7a045ba1($this->Alias, $this); if(isset($pclZR)) { $pclZR->F18f1a158($this,$sNomPHP,$sFichierBase, $sRubriqueBase, $sFichierRelie1 , $sRubriqueRelie1 , $sRubriqueAffichee1 , $sFichierRelie2 , $sRubriqueRelie2, $sRubriqueAffichee2); } } } function F409dc8d1() { if($this->bMultiLiaison) { $Fichier = &Fbad7a601($this->sFichierBase); if(is_object($this->FichierParcours) && Feee3b2d5($this->FichierParcours)) { $this->FichierParcours->F08193936("",array()); } $nResultQuery = $Fichier->F1b8fc945($this); if(!$nResultQuery) { return; } $nResult = $Fichier->F91276a4c($nResultQuery); if(($nResult) != 0) { if(isset($nResult)) { $Rubrique =& F4fc992ba($this); $this->SetValeur($Rubrique->F48bb09ec($nResult[0])); } } } else { $Rubrique =& F4fc992ba($this); $this->SetValeur($Rubrique->GetValeur()); } } function F82c9860c() { if($this->bMultiLiaison) { return; } Fbb1a729e($this->sFichierBase, $this->sRubriqueBase, $this->Fb2784a04()); } function UploadNomFichier($bLocalisation = true, $nIndice = 1) { if(!isset($_FILES[$this->Alias])) { return ''; } if(!$bLocalisation) { return $_FILES[$this->Alias]['name']; } else { $tmp_file = $_FILES[$this->Alias]['tmp_name']; if((is_uploaded_file($tmp_file))||is_file($tmp_file)) { return F8df7b692($tmp_file); } return ''; } } function UploadCopieFichier($sCheminServeur, $sNomFichier, $nIndice = 1) { if(!isset($_FILES[$this->Alias])) { return ''; } $sNomFichier = F406b3c6d($_FILES[$this->Alias]['tmp_name'],$_FILES[$this->Alias]['name'],$sCheminServeur, $sNomFichier); if (!empty($sNomFichier)) { $_FILES[$this->Alias]['tmp_name'] = F0ac3fb91($sCheminServeur).$sNomFichier; } return $sNomFichier; } function& F87d9a981() { global $MaPage; return $MaPage; } function& GetCouleur() { return $this->F3a0a4a7c($this->F0001028f()); } function& F0001028f() { return parent::GetCouleur(); } function SetCouleur( $clValeur) { $this->F9158bf7f($this->F3b14fdc3($clValeur, $this->F917c0a49(), dwCODESys3DBouton)); $this->F6fb6d0cf(COULEUR_WEB); } function F9158bf7f($dwCoul) { parent::SetCouleur($dwCoul); } function& GetCouleurFond() { return $this->F3a0a4a7c($this->F55933098()); } function& F55933098() { return parent::GetCouleurFond(); } function SetCouleurFond ( $clValeur) { parent::SetCouleurFond($clValeur); $this->F6fb6d0cf(COULEURFOND_WEB); } function F267458f8( $stLogFont, $clCouleurTxt, $pszTailleCSS, $pszPoliceCSS) { $pclCadre =& F264709eb($this,'m_clCadre'); $pclCadre->F710f6f7f($stLogFont, $pszTailleCSS, $pszPoliceCSS); if ($clCouleurTxt->Fd061cc94()) $this->F9158bf7f($clCouleurTxt); } function GetBarreOutilsOptionsHTML( $TypeConvertion = 0 ) { return $this->m_sBarreOutilsOptions; } function GetBarreOutilsModeHTML( $TypeConvertion = 0 ) { return (string)$this->m_eBarreOutilsMode; } } class CSuperChamp extends CChamp { function CSuperChamp() { parent::CChamp(); } function& GetType() { return getRef(40); } function Fc6eb41aa() { } function& GetValeur() { if (!F10625e0f('__WB__PCODE_AFFRECUP_VALEUR__' . $this->F960e3ffe())) { $sNomCallbackGetValeur = $this->F960e3ffe() . TRT_GetValeur_Page; if (!function_exists($sNomCallbackGetValeur)) $sNomCallbackGetValeur = $this->F960e3ffe() . 'LVAL'; if (function_exists($sNomCallbackGetValeur)) { call_user_func($sNomCallbackGetValeur); } } return $this->Valeur ; } function SetValeur($NewVal) { parent::SetValeur($NewVal); if (!F10625e0f('__WB__PCODE_AFFRECUP_VALEUR__' . $this->F960e3ffe())) { $sNomCallbackSetValeur = $this->F960e3ffe() . TRT_SetValeur_Page; if (!function_exists($sNomCallbackSetValeur)) $sNomCallbackSetValeur = $this->F960e3ffe() . 'EVAL'; if (function_exists($sNomCallbackSetValeur)) { call_user_func($sNomCallbackSetValeur); } } } function& F1e21db15() { $t=TYPEWL_VARIANT; return $t; } } class COptionMenu extends CChamp { var $Occurrence; var $m_bSelectionee = false; var $m_bCreeDynamiquement = false; var $m_sFonction = null; var $m_xParametre = null; var $m_eAction = null; var $m_czPageAction = null; var $m_bEstunSeparateur = false; var $m_sMenuParent = null; var $m_bEstUnSousMenu = false; function COptionMenu() { parent::CChamp(); } function& GetType() { return getRef(ntypOPTIONMENU); } function Fc1a6d5f6($nIdPcode,$ptabParams=null ) { if ($nIdPcode == trtClic) { if ( !empty($this->URL) ) { F6e3689dc($this->URL); } elseif (!empty($this->m_sFonction)) { $sNomFonctionPHP=$this->m_sFonction; XASSERT(function_exists($sNomFonctionPHP)); if(isset($this->m_xParametre)) { $p1 =& $this->m_xParametre; return call_user_func($sNomFonctionPHP,$p1); } else { return call_user_func($sNomFonctionPHP); } } } else { return parent::Fc1a6d5f6($nIdPcode,$ptabParams); } return null; } function SetLibelle($szNewVal) { parent::SetLibelle($szNewVal); parent::SetBulle($szNewVal); } function SetBulle($szNewVal) { $this->F48f1d9bc($szNewVal); } function F48f1d9bc($szNewVal) { parent::SetLibelle($szNewVal); parent::SetBulle($szNewVal); } function SetSelectionnee( $bValeur ) { $this->m_bSelectionee = (bool)$bValeur; if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_SELECTIONNEE ); } } function& GetSelectionnee() { return $this->m_bSelectionee; } function F60786b1e() { return $this->m_bCreeDynamiquement; } function Fd060edb1() { $this->m_bCreeDynamiquement = true; } function Fcbc9af36($sNomFonction, $xParam) { $pclVM =& obtenirVM(); $sNomFonctionPHP = $pclVM->Ff06e3e53($sNomFonction); XASSERT(function_exists($sNomFonctionPHP)); $this->m_sFonction = $sNomFonctionPHP; $this->m_xParametre = $xParam; } function Fe7656b24($b) { $this->m_bEstunSeparateur = $b; } function& Fab988b63() { return $GLOBALS[$this->m_sMenuParent]; } function Ff58e7648($eAction, $pszLien, $pszPageAction) { $this->m_eAction = $eAction; $this->URL = $pszLien; $this->m_czPageAction = $pszPageAction; } function SetMenuParent($sSousMenu) { $this->m_sMenuParent = $sSousMenu; } function F1a194522($bRechargeTailleParent) { if ($this->m_sMenuParent != null) { $pclMenuParent =& $this->Fab988b63(); if ($pclMenuParent->F9a76711e() != false) { $this->m_nLargeur = $pclMenuParent->F24d02852(); } else { $this->m_nHauteur = $pclMenuParent->Faaf2cc2c(); } } } function& F66f81357($sNom) { if ($this->Nom == $sNom) return $this; $null = null; return $null; } function pszGetMeniSiAvecHrefHTML() { return !empty($this->URL) ||!empty($this->m_sFonction); } } class CSousMenu extends COptionMenu { var $m_tabOptions = array(); function CSousMenu() { parent::COptionMenu(); $this->Occurrence=0; $this->m_bEstUnSousMenu = true; } function Ff364ee4e(&$pclOptionMenu) { for($i=0; $i<$this->Occurrence; ++$i) { if ($this->m_tabOptions[$i]->m_sNomPHP === $pclOptionMenu->m_sNomPHP) return $i; } } function F3153a477($nIndiceOption) { if (isset($this->m_tabOptions[$nIndiceOption])) { $this->m_tabOptions[$nIndiceOption]->SetMenuParent(null); unset($this->m_tabOptions[$nIndiceOption]); $this->m_tabOptions = array_values($this->m_tabOptions); --$this->Occurrence; } } function& pclGetOption($nIndiceOption) { if (isset($this->m_tabOptions[$nIndiceOption])) { return $this->m_tabOptions[$nIndiceOption]; } $null = null; return $null; } function& F66f81357($sNom) { if (parent::F66f81357($sNom) !== null) return $this; for($i=0; $i<$this->Occurrence; ++$i) { if ($this->m_tabOptions[$i]->F66f81357($sNom) !== null) return $this->m_tabOptions[$i]; } $null = null; return $null; } function F24d02852() { return -1; } function Faaf2cc2c() { return -1; } function& Fc85a0519($pszNom, $nAfter, $bSousMenu) { $sNomGlobal = uniqid($this->m_sNomPHP . '_'); $GLOBALS[$sNomGlobal] = null; if ($bSousMenu) { $GLOBALS[$sNomGlobal]=&CreerChamp('CSousMenu'); } else { $GLOBALS[$sNomGlobal]=&CreerChamp('COptionMenu'); } $pclNouvelleOption =& $GLOBALS[$sNomGlobal]; global $MaPage; $MaPage->WB_AjouteChamp($pszNom,uniqid('ALIAS'),$pclNouvelleOption,$sNomGlobal); $pclNouvelleOption->lierVM($MaPage->Nom,$pszNom,$sNomGlobal); $pclNouvelleOption->SetMenuParent($this->m_sNomPHP); $pclNouvelleOption->F1a194522(true); if ($nAfter === -1) { $this->m_tabOptions[] =& $pclNouvelleOption; } else { array_splice($this->m_tabOptions,$nAfter-1,1,array(&$pclNouvelleOption,&$this->m_tabOptions[$nAfter-1])); } ++$this->Occurrence; return $this->m_tabOptions[$this->Occurrence-1]; } function F9a76711e() { $pclParent =& $this->Fab988b63(); if (isset($pclParent)) return $pclParent->F9a76711e(); return false; } function Feb0a1ae8(&$pclOptionMenu, $pszAliasPopup, $ePositionPopup) { $sNomGlobal = uniqid($this->m_sNomPHP . '_'); $GLOBALS[$sNomGlobal] = null; $GLOBALS[$sNomGlobal]=&CreerChamp('CObjetMenuPopup'); $pclNouvelleOption =& $GLOBALS[$sNomGlobal]; $pszNom = $pclOptionMenu->Nom; global $MaPage; $MaPage->WB_AjouteChamp($pszNom,$pclOptionMenu->Alias,$pclNouvelleOption,$sNomGlobal); $pclNouvelleOption->lierVM($MaPage->Nom,$pszNom,$sNomGlobal); $pclNouvelleOption->SetMenuParent($this->m_sNomPHP); $pclNouvelleOption->m_cszPopupNom = $pszAliasPopup; $pclNouvelleOption->m_ePopupPosition = $ePositionPopup; $pclNouvelleOption->Fd060edb1(); $this->m_tabOptions[] =& $pclNouvelleOption; ++$this->Occurrence; } function F12828e6d( $eTypeVue) { return $this->F0198de68('CVueChampMenu_Web' , $eTypeVue); } function pszGetMenuPopupDeclarationHTML($bAvecStatiquesAvant=false) { $pclResultat = null; $pclResultatStats = null; $this->m_pclVue->F1f68ed08( new CPropCodeHTML(szPROP_CODEHTML . cPROP_CODEHTML_SEPARATEUR . PARTIE_CODEHTML_MENU_POPUPDECLARATION), $pclResultat, $pclResultatStats ); $return = (isset($pclResultat)) ? $pclResultat : $pclResultatStats; if ($bAvecStatiquesAvant && !empty($return)) return ',' . $return; return $return; } } class CObjetMenuPopup extends COptionMenu { var $m_cszPopupNom; var $m_ePopupPosition; function CObjetMenuPopup () { parent::COptionMenu(); $this->m_cszPopupNom=null; $this->m_ePopupPosition=F1b24b0e4($pclParentMenu); } function& GetType() { return getRef(ID_MENUPOPUP); } function F4a917fa4() { return 105; } function F63945232() { return $this->m_cszPopupNom; } } function F1b24b0e4(&$pclParentMenu) { if ( (null === $pclParentMenu) || ( (null === $pclParentMenu->Fab988b63()) && (false === $pclParentMenu->F9a76711e()))) { return 0; } else { return 1; } } class stPROP_VALEUR extends stSTRUCTURE { var $m_clValeur; var $m_pszValeurConst; var $m_bCompatibleUTF8 = true; function stPROP_VALEUR(&$valeur,&$valconst) { $this->m_clValeur =& $valeur; $this->m_pszValeurConst =& $valconst; } } class CVisiteurMenuPopup { var $m_riPropCodeHTML; var $m_clDeclaration; function CVisiteurMenuPopup (&$riPropCodeHTML) { $this->m_riPropCodeHTML =& $riPropCodeHTML; $this->m_clDeclaration = new CJSOn(); } function F39419d27($UNUSED) { XASSERT(false); return 2; } function Fb99627d9($pclChamp) { return $pclChamp->Faafabe08($this, null); } function F49cfbd8d(&$pclObjetAPCodePage, $pclParent) { switch ($pclObjetAPCodePage->GetType()) { case ID_MENUPOPUP: if (false !== $pclObjetAPCodePage->F60786b1e()) { $pszPopupAlias = $pclObjetAPCodePage->F63945232(); if (!empty($pszPopupAlias)) { if ( (0 < $this->m_clDeclaration->F2884ca00()) || (0 !== $this->m_riPropCodeHTML->m_nParametre)) { $this->m_clDeclaration->F8270781f(DERNIER_NON); } $this->m_clDeclaration->F13314aff($pclObjetAPCodePage->Alias, true); $this->m_clDeclaration->F105675ec(); $this->m_clDeclaration->Fdd3c5492('m_sPopup', DERNIER_NON, true, $pszPopupAlias, utf8_strlen($pszPopupAlias)); $cszPopupPosition = (string)$pclObjetAPCodePage->m_ePopupPosition; $this->m_clDeclaration->Fdd3c5492('m_ePosition', DERNIER_OUI, false, $cszPopupPosition, utf8_strlen($cszPopupPosition)); $this->m_clDeclaration->F1ebdc972(DERNIER_OUI); } } break; } return $pclObjetAPCodePage->Faafabe08($this, $pclParent); } function Febe046d7($eVISITE_OPTION) { return true; } function F90fb4c17(&$rstValeur) { return $this->m_clDeclaration->F90fb4c17(true, $rstValeur); } }; class CVueChampMenu_Web extends CVueChamp_Web { function CVueChampMenu_Web(&$pclModele) { parent::CVueChamp_Web($pclModele); } function F1f68ed08($clPropCodeHTML,&$rclResultat,&$rpczResultatStatique) { switch ($clPropCodeHTML->m_ePartie) { case PARTIE_CODEHTML_MENU_POPUPDECLARATION: { $clVisiteur = new CVisiteurMenuPopup($clPropCodeHTML); $clVisiteur->Fb99627d9($this->m_pclModele); $rstValeur = new stPROP_VALEUR($rclResultat,$rpczResultatStatique); return $clVisiteur->F90fb4c17($rstValeur); } default: return parent::F1f68ed08($clPropCodeHTML, $rclResultat,$rpczResultatStatique); } } } class CChampMenu extends CSousMenu { var $m_bVertical = false; function& GetType() { return getRef(ID_CHAMPMENU); } function F9a76711e() { return $this->m_bVertical; } function Faafabe08(&$riVisiteur,$pclParentForce) { $eVisiteResultat = parent::Faafabe08($riVisiteur, $pclParentForce); if (0 === $eVisiteResultat) { if (false !== $riVisiteur->Febe046d7(1)) { $n=count($this->m_tabOptions,COUNT_NORMAL); for ($nOption = 0; $nOption < $n; ++$nOption) { $eVisiteResultat = $riVisiteur->F49cfbd8d($this->m_tabOptions[$nOption], $this); if (2 === $eVisiteResultat) break; } } } return $eVisiteResultat; } } class CTiroir extends CChamp { function CTiroir() { parent::CChamp(); $this->Valeur = true; } function& GetType() { return getRef(34); } function GetValeurHTML( $TypeConvertion = 0 ) { return ($this->Valeur==false) ? '0' : '1'; } function F4a917fa4() { return 34; } function Fdc05d49f( $ValeurHTTP ) { $this->Valeur = (VersChaine($ValeurHTTP)==='1'); } function SetEnroule($bEnroule) { $this->Valeur = ! $bEnroule; if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEUR); } } function& GetEnroule() { $retour = ! $this->Valeur; return $retour; } } if (!defined('__INC__IHM/Champ/CadreLibelle.php')) { define('__INC__IHM/Champ/CadreLibelle.php',true); include_once(WB_INCLUDE_PATH.'WDca2e54604ad98e6dc625c0642acf03cf.php'); } class CStyle { var $m_clNom; var $m_clCadre; function CStyle ( $piContextePolice = null) { $this->m_clNom = ''; $this->m_clCadre = new CCadreLibelle($piContextePolice); } } class CLienSiteMapPath extends CObjetBase { var $m_tabParams = null; function CLienSiteMapPath($sLibelle,$sUrl,$sBulle,$tabParams=null) { $this->SetURL($sUrl); $this->SetLibelle( $sLibelle ); $this->m_sBulle = $sBulle; $this->m_tabParams = $tabParams; } function SetURL( $sUrl ) { if (!isset($tabParams) && $nPos=utf8_strpos($sUrl,'?')!==false) { utf8_parse_str(utf8_substr($sUrl,$nPos+1),$tabParams); } else { if ((''!==$sUrl) && (false === utf8_strpos($sUrl,':/')) && (false === F0728da76(utf8_strtolower($sUrl),'.php'))) $sUrl.='.php'; } global $gszRepLangue; if (isset($gszRepLangue) && is_file(F9486bf1a($gszRepLangue . $sUrl))) { $sUrl = $gszRepLangue . $sUrl; } parent::SetURL($sUrl); } function SetLibelle($szNewVal) { parent::SetLibelle($szNewVal); parent::SetValeur($szNewVal); } function SetValeur($szNewVal) { parent::SetValeur($szNewVal); parent::SetLibelle($szNewVal); } } class CSiteMapPath extends CChamp { var $m_bLinkToCurrent = false; var $m_clSeparator = ''; var $m_bLienDirectAutorise = false; var $m_clStyleLienFinal = ''; var $m_clStyleLien = ''; var $m_clStyleSeparateur = ''; var $m_clTabNode = null; var $m_cszValeurAffichee; function CSiteMapPath() { parent::CChamp(); } function Fb560a68a($dwFlags) { parent::Fb560a68a($dwFlags); if ($this->F4230685c() === false) { return; } $this->m_bLienDirectAutorise = ! (ExecuteTraitement($this->m_sNomPHP,trtClic,false,true)===true); $this->Valeur = 0; } function Fdc05d49f( $ValeurHTTP ) { $this->Valeur = ((int)$ValeurHTTP) + 1; } function& GetValI( $Indice ) { if ( ($Indice < 1) || ($Indice > count($this->m_clTabNode,COUNT_NORMAL)) ) return Fe81a7f9e('ERR_OUTOFBOUNDCROCHET',$this->GetNom(),$Indice,$this->GetOccurrence()); return $this->m_clTabNode[ $Indice-1 ]; } function Fc1a6d5f6($nIdPcode,$ptabParams=null ) { if ($nIdPcode == trtClic) { $pclNoeudCourant =& $this->GetValI( $this->Valeur ); if ( !empty($pclNoeudCourant->URL) ) { F6e3689dc($pclNoeudCourant->URL); } if ($this->m_bLienDirectAutorise===false) { return parent::Fc1a6d5f6(trtClic,$ptabParams); } } else { return parent::Fc1a6d5f6($nIdPcode,$ptabParams); } return null; } function CheminNavigationAjouteLien($sLibelle, $sUrl, $sBulle = '') { $this->m_clTabNode[] = new CLienSiteMapPath($sLibelle, $sUrl, $sBulle); if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEURAFFICHEE); } return true; } function CheminNavigationInsereLien($nNumero, $sLibelle, $sUrl, $sBulle = '') { if (false === array_key_exists($nNumero-1,$this->m_clTabNode)) return false; $clNouveauLien = new CLienSiteMapPath($sLibelle, $sUrl, $sBulle); $nNbElements = count($this->m_clTabNode,COUNT_NORMAL); if ($nNumero+1 === $nNbElements) { $this->m_clTabNode[] =& $clNouveauLien; } else { $tabNodes = array(); for($i=0; $i<$nNbElements; ++$i) { if ($i === $nNumero-1) { $tabNodes[] =& $clNouveauLien; } $tabNodes[] =& $this->m_clTabNode[$i]; } $this->m_clTabNode = $tabNodes; } if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEURAFFICHEE); } return true; } function CheminNavigationModifieLien ($nNumero, $sLibelle, $sUrl, $sBulle = '') { if (false === array_key_exists($nNumero-1,$this->m_clTabNode)) return false; $this->m_clTabNode[$nNumero-1] = new CLienSiteMapPath($sLibelle, $sUrl, $sBulle); if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEURAFFICHEE); } return true; } function CheminNavigationSupprimeLien ($nNumero) { if (false === array_key_exists($nNumero-1,$this->m_clTabNode)) return false; unset($this->m_clTabNode[$nNumero-1]); $this->m_clTabNode = array_values($this->m_clTabNode); if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEURAFFICHEE); } return true; } function CheminNavigationSupprimeTout () { $this->m_clTabNode = array(); if(Feef890d7()) { F4c16799e($this->m_sNomPHP, XML_CHAMP_PROP_NUM_VALEURAFFICHEE); } return true; } function& GetType() { return getRef(23); } function F4a917fa4() { return 23; } function& GetValeurAffichee() { $retour = ''; if (false === $this->Fa77644da()) { return $retour; } return $this->m_cszValeurAffichee; } function& GetOccurrence() { $return = count($this->m_clTabNode,COUNT_NORMAL); return $return; } function& GetVide() { $return = 0===count($this->m_clTabNode,COUNT_NORMAL); return $return; } function& GetValeurInitiale() { return Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_VALEURINITIALE"),F3b9ec4ca($this)); } function SetValeurInitiale($Valeur) { Erreur('ErreurProprieteInconnue','',Fc34ec142("PROP_NOM_VALEURINITIALE"),F3b9ec4ca($this)); } function& GetLibelle() { $cszLibelle = ''; $i=-1; while(isset($this->m_clTabNode[++$i])) { if ($i > 0) $cszLibelle.=$this->m_clSeparator; $cszLibelle.=$this->m_clTabNode[$i]->Libelle; } return $cszLibelle; } function SetLibelle($Valeur) { } function& Fdf5b402f(&$pclPage) { $sNomPageMinuscule = utf8_strtolower($pclPage->Nom); $nMeilleurNbParametres = -1; $pclMeilleurNoeud = null; $this->F26d33b70($this->m_clTabNode,$pclPage,$sNomPageMinuscule,$pclMeilleurNoeud,$nMeilleurNbParametres); return $pclMeilleurNoeud; } function F26d33b70(&$tabNodes,&$pclPage,$sNomPageMinuscule,&$pclMeilleurNoeud,&$nMeilleurNbParametres) { foreach( array_keys($tabNodes) as $sNomLien) { if (is_int($sNomLien)) continue; $pclNoeud =& $GLOBALS[$sNomLien]; if (utf8_strtolower($pclNoeud->URL) === $sNomPageMinuscule . '.php') { if (null === $pclMeilleurNoeud) $pclMeilleurNoeud=$tabNodes[$sNomLien]; $nNbParametres = (null !== $pclNoeud->m_tabParams) ? count($pclNoeud->m_tabParams,COUNT_NORMAL) : 0; if ($nNbParametres > $nMeilleurNbParametres) { $bVerifieParametres = true; if ($nNbParametres>0) foreach ($pclNoeud->m_tabParams as $sNomParam => $xValeur) { if (null!==$xValeur && F4e7f6fae($sNomParam,null) !== $xValeur) { $bVerifieParametres = false; break; } } if ($bVerifieParametres === true) { $pclMeilleurNoeud = $tabNodes[$sNomLien]; $nMeilleurNbParametres = $nNbParametres; } } } $this->F26d33b70($tabNodes[$sNomLien],$pclPage,$sNomPageMinuscule,$pclMeilleurNoeud,$nMeilleurNbParametres); } } function F4230685c() { global $MaPage; $pclNode =& $this->Fdf5b402f($MaPage); $tmp = array(); while($pclNode!==null) { $sNomPHPNoeud = $pclNode[1]; $tmp[] =& $GLOBALS[$sNomPHPNoeud]; $pclNode = $pclNode[0]; } $this->m_clTabNode = array_reverse($tmp); return true; } function F71c44801($nNode, &$rcszLien) { $cszTempStyle = ''; if (($nNode==count($this->m_clTabNode,COUNT_NORMAL)-1) && false===$this->m_bLinkToCurrent) { $rcszLien.= '<span class="' . $this->m_clStyleLienFinal .'">' . $this->m_clTabNode[$nNode]->Libelle. '</span>'; } else { $pszStyle = ($nNode === count($this->m_clTabNode,COUNT_NORMAL - 1)) ? $this->m_clStyleLienFinal : $this->m_clStyleLien; $this->Fafdb595b($this->m_clTabNode[$nNode], $nNode, $pszStyle, $rcszLien); } } function Fafdb595b(&$piNoeud, $nIndiceNoeud, $pszStyle, &$rcszLien) { $rcszLien='<a class="'.$pszStyle.'"'; switch ($this->Etat) { default: case ETAT_CHAMP_ACTIF: { $czURL=''; $czParametres=''; $pszNom = $piNoeud->URL; if ( empty($pszNom) || ((is_file(F9486bf1a($pszNom)) === true) && ($this->m_bLienDirectAutorise === false))) { $czParametres = 'WD_ACTION_=CLICSMP;' . $this->Alias . ';' . $nIndiceNoeud; global $MaPage; $czParametres.=$MaPage->Ff1153809('&'); $czURL = ''; } else { $czURL = $piNoeud->URL; global $gtabCheminPage; $tabNomPage = pathinfo($czURL); $NomPage = utf8_strtoupper($tabNomPage['filename']); if (isset($gtabCheminPage[$NomPage])) { $pclLangue =& FMK_Langue_Alphabet(); $nNation = $pclLangue->nNation; $czURL = $gtabCheminPage[$NomPage][$nNation]['URL'] . $gtabCheminPage[$NomPage][$nNation]['NOM'] . '.'. $tabNomPage['extension']; global $gszCheminPageInverse; if (isset($gszCheminPageInverse)) { $czURL = $gszCheminPageInverse . $czURL; } } } $czURL = str_replace('/./','/',$czURL); if (F61bc61eb($czURL,'./')) { $czURL = substr($czURL,2); } $pszSeparateur = ''; if ($czParametres!=='') $pszSeparateur = '?'; $rcszLien.=' href="' . $czURL . $pszSeparateur . $czParametres . '"'; } break; case ETAT_CHAMP_GRISE: $rcszLien.=' grayed'; case ETAT_CHAMP_INACTIF: $rcszLien.=' readonly'; break; } $cszTitre = utf8_htmlspecialchars($piNoeud->Libelle, ENT_NOQUOTES); $pszDescription = $piNoeud->m_sBulle; if (F8b98af41($pszDescription)) { $rcszLien .= ' title="' . utf8_htmlspecialchars($pszDescription, ENT_NOQUOTES) . '"'; } $rcszLien.='>'.$cszTitre.'</a>'; } function F4ef2677b(&$rcszSeparateurHTML) { { $cszSeparateurEncode = $this->m_clSeparator; $cszSeparateurEncode = utf8_htmlspecialchars($cszSeparateurEncode , ENT_NOQUOTES); $cszSeparateurEncode = utf8_str_replace(' ', '&nbsp;', $cszSeparateurEncode); $rcszSeparateurHTML= '<span class="'. $this->m_clStyleSeparateur . '">'. $cszSeparateurEncode . '</span>'; } } function Fa77644da() { $this->m_cszValeurAffichee = ''; $nNbNoeuds = count($this->m_clTabNode,COUNT_NORMAL); if ($nNbNoeuds > 0) { $tabContenu = array(); for ($i = 0; $i < $nNbNoeuds; ++$i) { $cszLien = ''; $this->F71c44801($i, $cszLien); $tabContenu[] = $cszLien; } $cszSeparateurHTML = ''; $this->F4ef2677b($cszSeparateurHTML); $this->m_cszValeurAffichee = utf8_implode($cszSeparateurHTML,$tabContenu); } return true; } } class CCellule extends CChamp { function CCellule() { parent::CChamp(); } function& GetType() { return getRef(ID_CELLULE); } function F4a917fa4() { return 39; } } class CChampCelluleMiseEnPage extends CChamp { function CChampCelluleMiseEnPage() { parent::CChamp(); } function& GetType() { return getRef(ID_CELLULEMISEENPAGE); } function F4a917fa4() { return 39; } } class CChampPopup extends CChamp { function CChampPopup() { parent::CChamp(); } function& GetType() { return getRef(ID_POPUP_DEST); } function F4a917fa4() { return 90; } } class CIFrame extends CChamp { function CIFrame() { parent::CChamp(); } function& GetType() { return getRef(27); } function F4a917fa4() { return 27; } } class CLigneHR extends CChamp { function CLigneHR() { parent::CChamp(); } function& GetType() { return getRef(13); } function F4a917fa4() { return 13; } } function F4bbdc065(&$pclThis) { if (false === $pclThis->bMultiLiaison) return $pclThis->sFichierBase; else return (is_array($pclThis->sFichierAffiche) ? $pclThis->sFichierAffiche[1] : $pclThis->sFichierAffiche); } function F0baf5c86(&$pclThis) { if (false === $pclThis->bMultiLiaison) return $pclThis->sRubriqueBase; else return (is_array($pclThis->sRubriqueAffichee) ? $pclThis->sRubriqueAffichee[1] : $pclThis->sRubriqueAffichee); } function& Fd91261c2(&$pclThis) { if(!isset($pclThis->FichierLiaison)) { $pclThis->FichierLiaison =& Fbad7a601(F4bbdc065($pclThis)); } return $pclThis->FichierLiaison; } function& F4fc992ba(&$pclThis) { if(!isset($pclThis->RubriqueLiaison)) { $Fichier = &Fd91261c2($pclThis); $pclThis->RubriqueLiaison =& $Fichier->F133178d5(F0baf5c86($pclThis)); } return $pclThis->RubriqueLiaison; } ?>